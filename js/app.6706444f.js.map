{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?6d5d","webpack:///./src/App.vue?3c94","webpack:///./src/components/sequencer-simulator.vue?c031","webpack:///src/components/sequencer-simulator.vue","webpack:///./src/components/sequencer-simulator.vue?c3c7","webpack:///./src/components/sequencer-simulator.vue?02f5","webpack:///./src/components/sequence-entry.vue?3bcb","webpack:///./src/components/action-form-switch-session.vue?a326","webpack:///src/components/action-form-switch-session.vue","webpack:///./src/components/action-form-switch-session.vue?3ca0","webpack:///./src/components/action-form-switch-session.vue","webpack:///./src/components/action-form-stop.vue?ca23","webpack:///src/components/action-form-stop.vue","webpack:///./src/components/action-form-stop.vue?053e","webpack:///./src/components/action-form-stop.vue","webpack:///./src/components/action-form-loop-sessions.vue?f9c3","webpack:///src/components/action-form-loop-sessions.vue","webpack:///./src/components/action-form-loop-sessions.vue?0b1f","webpack:///./src/components/action-form-loop-sessions.vue","webpack:///./src/components/action-form-loop-actions.vue?ab0d","webpack:///src/components/action-form-loop-actions.vue","webpack:///./src/components/action-form-loop-actions.vue?55b9","webpack:///./src/components/action-form-loop-actions.vue","webpack:///./src/components/action-form-jump.vue?4778","webpack:///src/components/action-form-jump.vue","webpack:///./src/components/action-form-jump.vue?9b23","webpack:///./src/components/action-form-jump.vue","webpack:///src/components/sequence-entry.vue","webpack:///./src/components/sequence-entry.vue?13cf","webpack:///./src/components/sequence-entry.vue","webpack:///src/App.vue","webpack:///./src/App.vue?3359","webpack:///./src/App.vue?2667","webpack:///./src/plugins/vuetify.js","webpack:///./src/assets/js/RK002lib.js","webpack:///./src/assets/js/rk002-wrapper.js","webpack:///./src/assets/js/sequencer-action.js","webpack:///./store/index.js","webpack:///./src/main.js","webpack:///./src/components/sequencer-simulator.vue?00e3"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticStyle","staticClass","_v","model","callback","$$v","activeTab","expression","_l","link","title","url","_s","scopedSlots","_u","fn","ref","on","_g","_b","commDisabled","onDownloadClick","parseAndUploadSequence","$event","stopPropagation","configDialog","sequenceEntry","index","class","action","actionTypeId","color","icon","onChipDragStart","onChipMouseEnter","onChipMouseLeave","snackbarColor","snackbar","snackbarText","statusBarText","commInProcess","midiInputs","midiInputId","midiOutputs","midiOutputId","firmwareInfo","version","_e","author","tryToConnect","overwriteDialog","onReplace","staticRenderFns","rowNumber","colNumber","currentSessionPadIndex","timer","onPlayStop","currentActionProgress","beatsTotal","beatsUntilNextAction","onNext","computed","methods","stopSequencer","audio","play","processNextSequencerAction","setInterval","onTimer","clearInterval","setActiveActionIndex","loopingSessionsRepeats","incrementActionIndex","activeActionIndex","currentAction","component","VBtn","VCol","VContainer","VIcon","VItemGroup","VProgressCircular","VRow","VSheet","colorClass","onCheckDrop","preventDefault","onChipDrop","onChipClose","actionIndex","$set","sessionRules","sessionNumber","beatsRules","beatsCount","props","type","required","watch","sessionIndex","Number","val","nextActionOnBeat","mounted","$nextTick","VCardText","VCard","VForm","VTextField","VCardSubtitle","sessionNumberFrom","sessionNumberTo","repeatsRules","repeats","startSessionIndex","endSessionIndex","actionRules","actionNumberFrom","actionNumberTo","startActionIndex","endActionIndex","items","rules","sequence","map","text","disabled","VSelect","components","ActionFormSwitchSession","ActionFormStop","ActionFormLoopSessions","ActionFormLoopActions","ActionFormJump","event","addSequenceActionAt","clearSequenceActionAt","VChip","SequenceEntry","SequencerSimulator","selectedMidiInputId","set","setSelectedMidiInputId","newValue","selectedMidiOutputId","setSelectedMidiOutputId","errorMessage","setErrorMessage","expectedFirmwareVersion","guid","expectedFirmwareGUID","connected","dataTransfer","dropEffect","effectAllowed","setData","hint","VApp","VAppBar","VCardActions","VCardTitle","VDialog","VFooter","VMain","VSnackbar","VSpacer","VTab","VTabs","VToolbarTitle","VToolbar","VTooltip","Vue","use","Vuetify","theme","dark","RK002","rk005","dbg","dbg_rxtx","dbg_rxtx_raw","dbg_rxtx_pck","read_uint8","offset","res","read_uint16","read_uint32","read_string","maxsz","str","String","fromCharCode","vstostr","vs","vs_b","vs_c","toString","crc32","crc","b","msk","cableTypeToString","cabletype","cabletypes","SysexCodec","syx_hdr","syx_hdr_legacy","pcktypes","cmd","arg","dim","legacy","encodeDat","srcdat","msbctr","desdat","srcidx","decodeDat","msb","encodePck","pck","pcktype","argtype","v","k","concat","tryDecode","dat","isok","rxlegacy","pcklegacy","legacymatch","datpos","console","log","val2hex","width","bytehex","pckToString","toUpperCase","first","constructor","Array","sysexcodec","Pck","argname","RawBuf","buf","addByte","addUint16LE","addUint32LE","addString","charCodeAt","AudioEncoder","AUDIOENC_FS","AUDIOENC_N_PULSES_SHORT","AUDIOENC_N_PULSES_LONG","AUDIOENC_N_PULSES_SYNC","AUDIOENC_LEADIN_MS","AUDIOENC_LEADOUT_MS","signal","idx","clear","advanceT","count","invertSignal","emitCarrier","t_ms","emitByte","shiftreg","getAsWavBase64Str","NUMCHN","datasize","rawwav","chn","wavb64","base64","encode","CRC8B","encodeAudioPck","OutputDrvAudio","txPck","enc","wav","snd","WaudSound","volume","onLoad","InputDrvMIDI","port","observer","disconnect","onmidimessage","nibhex","uint32hex","dat2hexstr","OutputDrvMIDI","send","DBG","dbg_t_last","t_now","Math","floor","performance","now","t_diff","txt_diff","Info","RK002INFOMAXSZ","pos","magic","date","Loader","m_retry","m_target_data","m_upload_data","m_upload_pos","m_upload_des_adr","m_upload_mode","m_upload_chunksz","m_upload_duplex","m_upload_last_queued_flash_adr","m_getparams_idx","m_getparams_n","m_params","self","SIMPLEX_CHUNK_TIMEOUT_SHORT_MS","SIMPLEX_CHUNK_TIMEOUT_LONG_MS","DUPLEX_CHUNK_TIMEOUT_MS","DUPLEX_CHUNK_MAXRETRY","GET_NMB_PARAMS_TIMEOUT_MS","GET_PARAM_TIMEOUT_MS","DUPLEX_CRC_RESP_TIMEOUT_MS","DUPLEX_JUMP_RSP_TIMEOUT_MS","INQUIRY_PING_TIMEOUT_MS","INQUIRY_MAXRETRY","INQUIRY_RESULT_TIMEOUT","INQUIRY_RESULT_DUY_INVALID","INQUIRY_RESULT_DUY_VALID","INQUIRY_RESULT_LEGACY_VALID","INQUIRY_INFO_ADR","INQUIRY_INFO_MAX_SZ","BOOT1_PING_NMB_RETRIES","MEMPAGESZ","DUY_APP_MINSIZE","DUY_APP_MAXSIZE","DUPLEX_LEGACY_UPDATEFW_RSP_TIMEOUT_MS","FLASH_SECTOR_SIZE","SYX_LEGACY_MEMCHUNKSZ","SYX_MEMCHUNKSZ","APP_FLASHADR","APP_RAMADR","LEGACY_FLASHADR","APP_RK002SIZE_ADR","APP_CRCVAL","LEGACY_MINSIZE","LEGACY_MAXSIZE","LEGACY_BOOTVECTOR_CRC","LEGACY_BOOTVECTOR_BINARYSIZE","LEGACY_BOOTVECTOR_FWINSTALLER","UPLOADMODE_BOOTX","UPLOADMODE_LEGACY","MAINSTATE_IDLE","MAINSTATE_MONITOR","MAINSTATE_UNDUINIFY","MAINSTATE_INQUIRY","MAINSTATE_DUINIFY","MAINSTATE_GETPARAMS","m_mainstate","SUBSTATE_IDLE","SUBSTATE_MONITOR","SUBSTATE_INQUIRY","SUBSTATE_UPLOAD","SUBSTATE_EXPECT_UPDATE_FINAL_CRC","SUBSTATE_EXPECT_BOOT1_RSP","SUBSTATE_EXPECT_JUMP_RSP","SUBSTATE_EXPECT_LEGACY_UPDATEFW_RSP","SUBSTATE_GET_NMB_PARAMDEFS","SUBSTATE_GET_PARAMDEFS","SUBSTATE_GET_PARAMVALS","m_substate","m_outputdrvaudio","m_inputdrv","m_outputdrv","m_observer","m_last_sts_progress","m_last_sts_mainstr","m_last_sts_substr","m_last_sts_isok","m_tmr","m_inquiry_rsp_mem","setObserver","setOutputDriver","setInputDriver","onPck","uiAddConsole","rk002_consoleTxt","queuePck","timeout_ms","syxdat","setStateTmr","uiUpdateSts","progress","mainstr","substr","notify","rk002_stsUpdate","ms","clearTimeout","setTimeout","onStateTmr","enterState","mainstate","substate","enterSubState","enterMonitorState","txt","success","subOnBoot1Ready","subStartUpload","subEndUpload","rk002_onEndUpload","was_legacy","subRK005SoftMode","queueMemChunkAndSetTimeout","Uint8Array","adr","firstMemChunk","retryMemChunk","nextMemChunk","m_upload_data_pos","desadr","duplex","subStartGetNmbParamDefs","subEndGetParams","queueFetchGetParamDefReq","nr","param_nr","queueFetchGetParamReq","subEndInquiry","rk002_onInquiryResult","boot1","duinify","subStartInquiry","queueInquiryReq","rk005_softthru_msg","app_stored_size","nxtadr","info","svnstr","crc_computed","crc_received","fwinstalleradr","rk002_onParamDefsFetched","min","max","def","flags","lbl","rk002_onParam","startInquiry","dataIsValidLegacyApp","stored_size","crc32_readback","crc32_computed","unDuinifyData","unDuinifyFile","filename","req","XMLHttpRequest","open","responseType","onloadend","status","response","unDuinifySMF","smfdata","decodeSMF","buffer","flashmem","highest_adr","track","midiFile","tracks","events","ev","metaData","dataIsValidDuyApp","fetchParams","getParamDef","setParamVal","param_val","RK002MIDIObserver","_midiAccess","_pendingPromise","_busyErr","Error","_midiInputId","_midiOutputId","_paramsCount","_paramsCountExpected","onParamDefs","onParam","onMidiStateChange","rk002","toLowerCase","includes","reject","isOk","wasLegacy","inquiryResults","resolve","params","param","e","_allInputs","find","input","id","_allOutputs","output","state","navigator","requestMIDIAccess","sysex","onstatechange","_onMidiStateChange","from","inputs","values","convertedIns","outputs","convertedOuts","inputPort","outputPort","Promise","paramValues","entries","ind","sendParameter","SequencerAction","options","byte1","byte2","isNaN","Type","SwitchSession","valid","LoopSessions","LoopActions","JumpToAction","toActionIndex","StopSequence","assign","paramValue","Vuex","midiObserver","Store","fill","midiInputsAndOutputs","localStorage","rawDeviceData","actionTypes","getters","sequenceValid","filter","hadNullSequenceEntry","sequenceAction","mutations","setMidiInputsAndOutputs","addMidiInputPort","addMidiOutputPort","setMidiInputId","setMidiOutputId","setCommInProcess","setFirmwareInfo","setRawDeviceDataEntry","entry","freeze","args","actionType","clone","setSequencerActionAt","modifySequenceActionAt","message","actions","initWebMIDI","commit","dispatch","item","fetchParameters","error","parseAndLoadSequence","err","getUserParamValue","sendParameterValues","inquiryDevice","config","productionTip","vuetify","store","render","h","App","$mount"],"mappings":"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","file":"js/app.6706444f.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/rk002-sequence-editor/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&id=32ab9150&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',{attrs:{\"id\":\"rk002-sequence-editor\"}},[_c('v-app-bar',{attrs:{\"app\":\"\",\"flat\":\"\"}},[_c('v-toolbar-title',{staticStyle:{\"min-width\":\"150px\"}},[_c('a',{staticClass:\"title-link\",attrs:{\"href\":\"/\"}},[_vm._v(\"LENSFLARE.DEV\")])]),_c('v-tabs',{staticClass:\"ml-2 mr-2\",attrs:{\"color\":\"grey darken-1\"},model:{value:(_vm.activeTab),callback:function ($$v) {_vm.activeTab=$$v},expression:\"activeTab\"}},_vm._l((_vm.links),function(link){return _c('v-tab',{key:link.title,attrs:{\"href\":link.url}},[_vm._v(\" \"+_vm._s(link.title)+\" \")])}),1),_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"mr-1\",attrs:{\"icon\":\"\",\"outlined\":\"\",\"rounded\":\"\",\"disabled\":_vm.commDisabled},on:{\"click\":_vm.onDownloadClick}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-arrow-down-bold\")])],1)]}}])},[_c('span',[_vm._v(\"Download sequence from RK002\")])]),_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"mr-1\",attrs:{\"icon\":\"\",\"outlined\":\"\",\"rounded\":\"\",\"disabled\":_vm.commDisabled},on:{\"click\":_vm.parseAndUploadSequence}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-arrow-up-bold\")])],1)]}}])},[_c('span',[_vm._v(\"Upload sequence to RK002\")])]),_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"mr-1\",attrs:{\"icon\":\"\",\"outlined\":\"\",\"rounded\":\"\"},on:{\"click\":function($event){$event.stopPropagation();_vm.configDialog = true}}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-cog\")])],1)]}}])},[_c('span',[_vm._v(\"MIDI Configuration\")])])],1),_c('v-main',[_c('v-container',[_c('v-row',[_c('v-col',{staticClass:\"d-flex justify-end align-start\",attrs:{\"cols\":\"3\",\"md\":\"4\",\"lg\":\"3\"}},[_c('SequencerSimulator')],1),_c('v-col',{staticClass:\"d-flex justify-center\",attrs:{\"cols\":\"6\",\"md\":\"6\",\"lg\":\"6\"}},[_c('v-sheet',{staticStyle:{\"width\":\"100%\"},attrs:{\"rounded\":\"lg\"}},[_c('v-container',[_c('h3',{staticClass:\"text-center\"},[_vm._v(\"Action Sequencer\")]),_c('v-row',{attrs:{\"dense\":\"\"}},[_c('v-col',_vm._l((_vm.sequence),function(sequenceEntry,index){return _c('SequenceEntry',{key:index,class:index != 0 ? 'mt-3' : '',attrs:{\"action-index\":index}})}),1)],1)],1)],1)],1),_c('v-col',{staticClass:\"d-flex justify-start align-start\",attrs:{\"cols\":\"3\",\"md\":\"2\",\"lg\":\"3\"}},[_c('v-sheet',{staticClass:\"sheets-fixed\",attrs:{\"rounded\":\"lg\",\"max-width\":\"175px\",\"min-width\":\"175px\"}},[_c('v-container',[_c('h3',{staticClass:\"text-center\"},[_vm._v(\"Actions\")]),_c('p',{staticClass:\"text--disabled text-center mb-0\"},[_vm._v(\" Drop me to the slot: \")]),_vm._l((_vm.actionTypes),function(action,index){return _c('v-row',{key:index,attrs:{\"dense\":\"\"}},[_c('v-chip',{key:index,staticClass:\"action-chips ma-2\",attrs:{\"disabled\":action.actionTypeId === 4,\"color\":action.color,\"input-value\":true,\"filter\":\"\",\"filter-icon\":action.icon,\"draggable\":\"\"},on:{\"dragstart\":function($event){return _vm.onChipDragStart($event, action)},\"mouseenter\":function($event){return _vm.onChipMouseEnter(action)},\"mouseleave\":_vm.onChipMouseLeave}},[_vm._v(\" \"+_vm._s(action.title)+\" \")])],1)})],2)],1)],1)],1)],1)],1),_c('v-snackbar',{attrs:{\"timeout\":10000,\"color\":_vm.snackbarColor},scopedSlots:_vm._u([{key:\"action\",fn:function(ref){\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._b({attrs:{\"color\":\"white\",\"text\":\"\"},on:{\"click\":function($event){_vm.snackbar = false}}},'v-btn',attrs,false),[_vm._v(\" Close \")])]}}]),model:{value:(_vm.snackbar),callback:function ($$v) {_vm.snackbar=$$v},expression:\"snackbar\"}},[_vm._v(\" \"+_vm._s(_vm.snackbarText)+\" \")]),_c('v-footer',{attrs:{\"inset\":\"\",\"app\":\"\"}},[_vm._v(_vm._s(_vm.statusBarText))]),_c('v-dialog',{attrs:{\"max-width\":\"600\"},model:{value:(_vm.configDialog),callback:function ($$v) {_vm.configDialog=$$v},expression:\"configDialog\"}},[_c('v-card',[_c('v-card-title',[_c('span',{staticClass:\"headline\"},[_vm._v(\"MIDI Configuration\")])]),_c('v-card-text',{staticClass:\"pb-0\"},[_c('v-container',[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-select',{attrs:{\"disabled\":_vm.commInProcess,\"items\":_vm.midiInputs,\"label\":\"Input (Orange connector)\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.midiInputId),callback:function ($$v) {_vm.midiInputId=$$v},expression:\"midiInputId\"}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"6\"}},[_c('v-select',{attrs:{\"disabled\":_vm.commInProcess,\"items\":_vm.midiOutputs,\"label\":\"Output (Black connector)\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.midiOutputId),callback:function ($$v) {_vm.midiOutputId=$$v},expression:\"midiOutputId\"}})],1)],1),(_vm.firmwareInfo)?_c('v-row',[_c('small',{staticClass:\"font-weight-bold\"},[_vm._v(_vm._s(_vm.firmwareInfo.name)+\" v\"+_vm._s(_vm.firmwareInfo.version))])]):_vm._e(),(_vm.firmwareInfo)?_c('v-row',[_c('small',{staticClass:\"font-weight-bold\"},[_vm._v(_vm._s(_vm.firmwareInfo.author))])]):_vm._e()],1)],1),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":_vm.commInProcess},on:{\"click\":_vm.tryToConnect}},[_vm._v(\" Connect \")]),_c('v-btn',{attrs:{\"color\":\"default\"},on:{\"click\":function($event){_vm.configDialog = false}}},[_vm._v(\" Close \")])],1)],1)],1),_c('v-dialog',{attrs:{\"max-width\":\"320\"},model:{value:(_vm.overwriteDialog),callback:function ($$v) {_vm.overwriteDialog=$$v},expression:\"overwriteDialog\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\" Replace current sequence? \")]),_c('v-card-text',[_vm._v(\" Your current sequence is not empty. \"),_c('br'),_vm._v(\"Do you want to replace current sequence with loaded from the RK002? \")]),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.onReplace}},[_vm._v(\" Replace \")]),_c('v-btn',{on:{\"click\":function($event){_vm.overwriteDialog = false}}},[_vm._v(\" Cancel \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-sheet',{staticClass:\"sheets-fixed\",attrs:{\"rounded\":\"lg\",\"min-width\":\"305\",\"max-width\":\"305\"}},[_c('v-container',[_c('h3',{staticClass:\"text-center\"},[_vm._v(\"Simulator\")]),_c('p',{staticClass:\"text--disabled text-center mb-0\"},[_vm._v(\"Circuit sessions 1 - 32\")]),_vm._l((4),function(rowNumber){return _c('v-row',{key:rowNumber,staticClass:\"ma-1\"},[_vm._l((8),function(colNumber){return _c('v-col',{key:colNumber,staticClass:\"pa-1 ma-0\"},[_c('v-sheet',{staticClass:\"text-center\",attrs:{\"rounded\":\"lg\",\"color\":_vm.currentSessionPadIndex === ((rowNumber - 1) * 8 + colNumber) - 1 ? 'blue': 'deep-purple darken-3'}},[_c('span',{staticClass:\"ma-1\"},[_vm._v(\" \"+_vm._s((rowNumber - 1) * 8 + colNumber)+\" \")])])],1)})],2)}),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-item-group',{staticClass:\"v-btn-toggle\"},[_c('v-btn',{attrs:{\"color\":_vm.timer !== null ? 'primary': ''},on:{\"click\":_vm.onPlayStop}},[_c('v-icon',[_vm._v(_vm._s(_vm.timer !== null ? 'mdi-stop-circle-outline' : 'mdi-play-circle-outline'))])],1),_c('v-btn',[_c('v-progress-circular',{staticClass:\"no-transition\",attrs:{\"value\":_vm.currentActionProgress}},[_vm._v(_vm._s((_vm.beatsTotal - _vm.beatsUntilNextAction) + 1))])],1),_c('v-btn',{on:{\"click\":_vm.onNext}},[_c('v-icon',[_vm._v(\"mdi-skip-next\")])],1)],1)],1)],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-sheet\n    rounded=\"lg\"\n    min-width=\"305\"\n    max-width=\"305\"\n    class=\"sheets-fixed\"\n  >\n    <v-container>\n      <h3 class=\"text-center\">Simulator</h3>\n      <p class=\"text--disabled text-center mb-0\">Circuit sessions 1 - 32</p>\n      <v-row v-for=\"rowNumber in 4\" :key=\"rowNumber\" class=\"ma-1\">\n        <template>\n          <v-col v-for=\"colNumber in 8\" :key=\"colNumber\" class=\"pa-1 ma-0\">\n            <v-sheet\n              rounded=\"lg\"\n              :color=\"currentSessionPadIndex === ((rowNumber - 1) * 8 + colNumber) - 1 ? 'blue': 'deep-purple darken-3'\"\n              class=\"text-center\"\n            >\n              <span class=\"ma-1\">\n                {{ (rowNumber - 1) * 8 + colNumber }}\n              </span>\n            </v-sheet>\n          </v-col>\n        </template>\n      </v-row>\n      <v-row align=\"center\" justify=\"center\">\n         <v-item-group class=\"v-btn-toggle\">      \n          <v-btn @click=\"onPlayStop\" :color=\"timer !== null ? 'primary': ''\">\n            <v-icon>{{ timer !== null ? 'mdi-stop-circle-outline' : 'mdi-play-circle-outline' }}</v-icon>\n          </v-btn>\n          <v-btn>\n            <v-progress-circular class=\"no-transition\" :value=\"currentActionProgress\">{{ (beatsTotal - beatsUntilNextAction) + 1 }}</v-progress-circular>\n          </v-btn>\n          <v-btn @click=\"onNext\">\n            <v-icon>mdi-skip-next</v-icon>\n          </v-btn>\n         </v-item-group>\n      </v-row>\n    </v-container>\n  </v-sheet>\n</template>\n\n<script>\nimport { mapState, mapGetters, mapMutations } from \"vuex\";\n\nexport default {\n  data: () => ({\n    audio: new Audio('tick.mp3'),\n    currentSessionPadIndex: null,\n    timer: null,\n    beatsUntilNextAction: 0,\n    beatsTotal: 0,\n    loopingSessionsRepeats: null,\n  }),\n\n  computed: {\n    currentActionProgress: function() {\n      if(this.beatsTotal === 0) return 0\n      return ((this.beatsTotal - this.beatsUntilNextAction) + 1) / this.beatsTotal * 100 \n    },\n    ...mapState([\n      \"sequence\", \n      \"activeActionIndex\"]),\n    ...mapGetters([\"sequenceValid\"]),\n  },\n\n  methods: {\n    onPlayStop: function () {\n      if(this.timer) {\n        this.stopSequencer()\n        return\n      }\n\n      if(!this.sequenceValid()) {\n        return\n      }\n\n      this.stopSequencer() // reset all counters\n      this.audio.play() // play tick sound\n      this.processNextSequencerAction()\n      this.timer = setInterval(this.onTimer, 500)\n    },\n    onNext: function() {\n      if(this.timer) {\n        this.stopSequencer()\n      }\n\n      if(this.sequenceValid()) {\n        if(this.loopingSessionsRepeats !== null) {\n          this.processNextSequencerAction(false)\n        } else {\n          this.processNextSequencerAction()\n        }\n      }\n    },\n    onTimer: function () {\n      this.audio.play() // play tick sound\n      \n      // If we edited step when sequencer is running\n      if(!this.sequenceValid()) {\n        this.stopSequencer()\n        return\n      }\n\n      this.beatsUntilNextAction--\n      if(this.beatsUntilNextAction === 0) {\n        if(this.loopingSessionsRepeats !== null) {\n          this.processNextSequencerAction(false)\n          return\n        }\n\n        this.processNextSequencerAction()\n      }\n    },\n    stopSequencer: function() {\n      clearInterval(this.timer)\n      this.timer = null\n      this.setActiveActionIndex(null)\n      this.currentSessionPadIndex = null\n      this.loopingSessionsRepeats = null\n      this.beatsUntilNextAction = 0\n      this.beatsTotal = 0\n    },\n    processNextSequencerAction(incrementActionIndex = true) {\n      if(this.activeActionIndex === null) {\n        this.setActiveActionIndex(0)\n      } else {\n        if(this.activeActionIndex > 29 || this.activeActionIndex < 0) {\n          this.stopSequencer()\n          return\n        }\n\n        incrementActionIndex && this.setActiveActionIndex(this.activeActionIndex + 1)\n      }\n\n      const currentAction = this.sequence[this.activeActionIndex]\n\n      if (currentAction === null) {\n        this.stopSequencer()\n        return\n      }\n\n      switch(currentAction.actionTypeId) {\n        case 1: {\n          // switch session\n          this.currentSessionPadIndex = currentAction.sessionIndex\n          this.beatsUntilNextAction = currentAction.nextActionOnBeat\n          this.beatsTotal = currentAction.nextActionOnBeat\n          break\n        }\n\n        case 2: {\n          // stop\n          this.stopSequencer()\n          break\n        }\n\n        case 3: {\n          // loop sessions, 1 session = 32 beats\n          if(this.loopingSessionsRepeats === null) {\n            this.loopingSessionsRepeats = currentAction.repeats + 1\n            this.currentSessionPadIndex = currentAction.startSessionIndex\n          } else {\n            if(this.currentSessionPadIndex === currentAction.endSessionIndex) {\n              this.loopingSessionsRepeats--\n              if(this.loopingSessionsRepeats > 0) this.currentSessionPadIndex = currentAction.startSessionIndex\n            } else if(currentAction.startSessionIndex <= currentAction.endSessionIndex) {\n              // increment or decrement\n              this.currentSessionPadIndex++\n            } else {\n              this.currentSessionPadIndex--\n            }\n\n            if(this.loopingSessionsRepeats <= 0) {\n              this.loopingSessionsRepeats = null\n              this.processNextSequencerAction()\n              return\n            }\n          }\n          \n          this.beatsUntilNextAction = 32\n          this.beatsTotal = 32\n          break\n        }\n\n        case 4: {\n          // loop actions\n          this.setErrorMessage('Loop Actions is not supported at the moment')\n          this.stopSequencer()\n          break\n        }\n\n        case 5: {\n          // jump to action\n          this.setActiveActionIndex(currentAction.toActionIndex)\n          this.processNextSequencerAction(false) // recursive call without increment of action index\n          break\n        }\n\n        default: {\n          // stop\n          this.stopSequencer()\n          break\n        }\n      }\n    },\n    ...mapMutations([\n      'setActiveActionIndex',\n      'setErrorMessage'])\n  },\n}\n</script>\n<style>\n  .no-transition .v-progress-circular__overlay { transition: none !important; }\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sequencer-simulator.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sequencer-simulator.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./sequencer-simulator.vue?vue&type=template&id=d63792a8&\"\nimport script from \"./sequencer-simulator.vue?vue&type=script&lang=js&\"\nexport * from \"./sequencer-simulator.vue?vue&type=script&lang=js&\"\nimport style0 from \"./sequencer-simulator.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VItemGroup } from 'vuetify/lib/components/VItemGroup';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSheet } from 'vuetify/lib/components/VSheet';\ninstallComponents(component, {VBtn,VCol,VContainer,VIcon,VItemGroup,VProgressCircular,VRow,VSheet})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{class:_vm.colorClass,attrs:{\"elevation\":\"2\",\"outlined\":\"\",\"shaped\":\"\"},on:{\"dragenter\":_vm.onCheckDrop,\"dragover\":_vm.onCheckDrop,\"drop\":function($event){$event.preventDefault();return _vm.onChipDrop($event)}}},[(_vm.action === null)?_c('v-chip',{staticClass:\"ml-3 mt-3 text--disabled\",attrs:{\"outlined\":\"\"}},[_vm._v(\"Empty slot\")]):_c('v-chip',{staticClass:\"ml-3 mt-3\",attrs:{\"color\":_vm.action.color,\"close\":\"\"},on:{\"click:close\":_vm.onChipClose}},[_vm._v(_vm._s(_vm.action.title))]),_c('div',{staticClass:\"float-right ma-4 text--secondary\"},[_vm._v(\"# \"+_vm._s(_vm.actionIndex + 1))]),(_vm.action === null)?_c('v-card-subtitle',[_vm._v(\"Add new action by dropping here an action type from the list\")]):_vm._e(),(_vm.action !== null && _vm.action.actionTypeId === 1)?_c('ActionFormSwitchSession',{attrs:{\"action\":_vm.action}}):_vm._e(),(_vm.action !== null && _vm.action.actionTypeId === 2)?_c('ActionFormStop',{attrs:{\"action\":_vm.action}}):_vm._e(),(_vm.action !== null && _vm.action.actionTypeId === 3)?_c('ActionFormLoopSessions',{attrs:{\"action\":_vm.action}}):_vm._e(),(_vm.action !== null && _vm.action.actionTypeId === 4)?_c('ActionFormLoopActions',{attrs:{\"action\":_vm.action}}):_vm._e(),(_vm.action !== null && _vm.action.actionTypeId === 5)?_c('ActionFormJump',{attrs:{\"action\":_vm.action,\"actionIndex\":_vm.actionIndex}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card-text',[(_vm.action)?_c('v-form',{model:{value:(_vm.action.valid),callback:function ($$v) {_vm.$set(_vm.action, \"valid\", $$v)},expression:\"action.valid\"}},[_c('v-container',{staticClass:\"pt-0 pb-0\"},[_c('v-row',[_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.sessionRules,\"label\":\"Session number\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.sessionNumber),callback:function ($$v) {_vm.sessionNumber=$$v},expression:\"sessionNumber\"}})],1),_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.beatsRules,\"label\":\"Next action on beat\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.beatsCount),callback:function ($$v) {_vm.beatsCount=$$v},expression:\"beatsCount\"}})],1)],1)],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card-text>\n    <v-form v-if=\"action\" v-model=\"action.valid\">\n      <v-container class=\"pt-0 pb-0\">\n        <v-row>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"sessionNumber\"\n              :rules=\"sessionRules\"\n              label=\"Session number\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"beatsCount\"\n              :rules=\"beatsRules\"\n              label=\"Next action on beat\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n        </v-row>\n      </v-container>\n    </v-form>\n  </v-card-text>\n</template>\n<script>\nimport { mapState } from 'vuex'\n\nexport default {\n  props: {\n    action: {\n      type: Object,\n      required: true\n    }\n  },\n\n  data: () => ({\n    sessionNumber: 1,\n    beatsCount: 4,\n    sessionRules: [\n      (v) => !!v || \"Session number is required\",\n      (v) => {\n          if (Number.isNaN(v) || !Number.isInteger(Number(v))) return \"Please enter integer value\"\n          const intVal = Number(v)\n          if (intVal <= 32 && intVal >= 1) return true\n          else return \"Session number must be between 1 and 32\"\n        }\n    ],\n    beatsRules: [\n      (v) => !!v || \"Beats counter is required\",\n      (v) => {\n          if (Number.isNaN(v) || !Number.isInteger(Number(v))) return \"Please enter integer value\"\n          const intVal = Number(v)\n          if (intVal <= 255 && intVal >= 1) return true\n          else return \"Beats must be between 1 and 255\"\n        }\n    ]\n  }),\n\n  watch: {\n    sessionNumber: function(val) {\n      if(!this.action) return\n      this.action.sessionIndex = Number(val) - 1\n    },\n    beatsCount: function(val) {\n      if(!this.action) return\n      this.action.nextActionOnBeat = Number(val)\n    }\n  },\n\n  computed: mapState(['sequence']),\n\n  mounted: function() {\n    this.$nextTick(function() {\n      this.sessionNumber = this.action.sessionIndex + 1\n      this.beatsCount = this.action.nextActionOnBeat\n    })\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-switch-session.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-switch-session.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./action-form-switch-session.vue?vue&type=template&id=bc37cc0c&\"\nimport script from \"./action-form-switch-session.vue?vue&type=script&lang=js&\"\nexport * from \"./action-form-switch-session.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCardText,VCol,VContainer,VForm,VRow,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card-subtitle',[_vm._v(\" Sequencer will stop here \")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card-subtitle>\n    Sequencer will stop here\n  </v-card-subtitle>\n</template>\n<script>\nexport default {\n  props: {\n    action: {\n      type: Object,\n      required: true\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-stop.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-stop.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./action-form-stop.vue?vue&type=template&id=b563716e&\"\nimport script from \"./action-form-stop.vue?vue&type=script&lang=js&\"\nexport * from \"./action-form-stop.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCardSubtitle } from 'vuetify/lib/components/VCard';\ninstallComponents(component, {VCardSubtitle})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card-text',[(_vm.action)?_c('v-form',{model:{value:(_vm.action.valid),callback:function ($$v) {_vm.$set(_vm.action, \"valid\", $$v)},expression:\"action.valid\"}},[_c('v-container',{staticClass:\"pt-0 pb-0\"},[_c('v-row',[_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.sessionRules,\"label\":\"From session number\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.sessionNumberFrom),callback:function ($$v) {_vm.sessionNumberFrom=$$v},expression:\"sessionNumberFrom\"}})],1),_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.sessionRules,\"label\":\"To session number\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.sessionNumberTo),callback:function ($$v) {_vm.sessionNumberTo=$$v},expression:\"sessionNumberTo\"}})],1),_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.repeatsRules,\"label\":\"How many repeats\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.repeats),callback:function ($$v) {_vm.repeats=$$v},expression:\"repeats\"}})],1)],1)],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card-text>\n    <v-form v-if=\"action\" v-model=\"action.valid\">\n      <v-container class=\"pt-0 pb-0\">\n        <v-row>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"sessionNumberFrom\"\n              :rules=\"sessionRules\"\n              label=\"From session number\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"sessionNumberTo\"\n              :rules=\"sessionRules\"\n              label=\"To session number\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"repeats\"\n              :rules=\"repeatsRules\"\n              label=\"How many repeats\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n        </v-row>\n      </v-container>\n    </v-form>\n  </v-card-text>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\n\nexport default {\n  props: {\n    action: {\n      type: Object,\n      required: true\n    }\n  },\n  \n  data: () => ({\n    model: null,\n    sessionNumberFrom: 1,\n    sessionNumberTo: 8,\n    repeats: 4,\n    sessionRules: [\n      (v) => !!v || \"Session number is required\",\n      (v) => {\n          if (Number.isNaN(v) || !Number.isInteger(Number(v))) return \"Please enter integer value\"\n          const intVal = Number(v)\n          if (intVal <= 32 && intVal >= 1) return true\n          else return \"Session number must be between 1 and 32\"\n        }\n    ],\n    repeatsRules: [\n      (v) => !!v || \"Repeat counter is required\",\n      (v) => {\n          if (Number.isNaN(v) || !Number.isInteger(Number(v))) return \"Please enter integer value\"\n          const intVal = Number(v)\n          if (intVal <= 8 && intVal >= 1) return true\n          else return \"Repeats must be between 1 and 8\"\n        }\n    ]\n  }),\n\n  watch: {\n    sessionNumberFrom: function(val) {\n      if(!this.action) return\n      this.action.startSessionIndex = Number(val) - 1 \n    },\n    sessionNumberTo: function(val) {\n      if(!this.action) return\n      this.action.endSessionIndex = Number(val) - 1 \n    },\n    repeats: function(val) {\n      if(!this.action) return\n      this.action.repeats = Number(val) - 1 // 0...7 = 8 beats = 3 bits\n    }\n  },\n\n  computed: mapState(['sequence']),\n\n  mounted: function () {\n    this.$nextTick(function () {\n      this.sessionNumberFrom = this.action.startSessionIndex + 1\n      this.sessionNumberTo = this.action.endSessionIndex + 1\n      this.repeats = this.action.repeats + 1\n    })\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-loop-sessions.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-loop-sessions.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./action-form-loop-sessions.vue?vue&type=template&id=64306baa&\"\nimport script from \"./action-form-loop-sessions.vue?vue&type=script&lang=js&\"\nexport * from \"./action-form-loop-sessions.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCardText,VCol,VContainer,VForm,VRow,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card-text',[(_vm.action)?_c('v-form',{model:{value:(_vm.action.valid),callback:function ($$v) {_vm.$set(_vm.action, \"valid\", $$v)},expression:\"action.valid\"}},[_c('v-container',{staticClass:\"pt-0 pb-0\"},[_c('v-row',[_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.actionRules,\"label\":\"From action number\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.actionNumberFrom),callback:function ($$v) {_vm.actionNumberFrom=$$v},expression:\"actionNumberFrom\"}})],1),_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.actionRules,\"label\":\"To action number\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.actionNumberTo),callback:function ($$v) {_vm.actionNumberTo=$$v},expression:\"actionNumberTo\"}})],1),_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"md\":\"4\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.repeatsRules,\"label\":\"How many repeats\",\"required\":\"\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.repeats),callback:function ($$v) {_vm.repeats=$$v},expression:\"repeats\"}})],1)],1)],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card-text>\n    <v-form v-if=\"action\" v-model=\"action.valid\">\n      <v-container class=\"pt-0 pb-0\">\n        <v-row>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"actionNumberFrom\"\n              :rules=\"actionRules\"\n              label=\"From action number\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"actionNumberTo\"\n              :rules=\"actionRules\"\n              label=\"To action number\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n          <v-col cols=\"12\" md=\"4\" class=\"pb-0\">\n            <v-text-field\n              v-model=\"repeats\"\n              :rules=\"repeatsRules\"\n              label=\"How many repeats\"\n              required\n              outlined\n              dense\n            ></v-text-field>\n          </v-col>\n        </v-row>\n      </v-container>\n    </v-form>\n  </v-card-text>\n</template>\n<script>\nimport { mapState } from 'vuex'\n\nexport default {\n  props: {\n    action: {\n      type: Object,\n      required: true\n    }\n  },\n  \n  data: () => ({\n    model: null,\n    actionNumberFrom: 1,\n    actionNumberTo: 4,\n    repeats: 4,\n    actionRules: [\n      (v) => !!v || \"Action number is required\",\n      (v) => {\n          if (Number.isNaN(v) || !Number.isInteger(Number(v))) return \"Please enter integer value\"\n          const intVal = Number(v)\n          if (intVal <= 30 && intVal >= 1) return true\n          else return \"Action number must be between 1 and 30\"\n        }\n    ],\n    repeatsRules: [\n      (v) => !!v || \"Repeat counter is required\",\n      (v) => {\n          if (Number.isNaN(v) || !Number.isInteger(Number(v))) return \"Please enter integer value\"\n          const intVal = Number(v)\n          if (intVal <= 8 && intVal >= 1) return true\n          else return \"Repeats must be between 1 and 8\"\n        }\n    ]\n  }),\n\n  watch: {\n    actionNumberFrom: function(val) {\n      if(!this.action) return\n      this.action.startActionIndex = Number(val) - 1 \n    },\n    actionNumberTo: function(val) {\n      if(!this.action) return\n      this.action.endActionIndex = Number(val) - 1 \n    },\n    repeats: function(val) {\n      if(!this.action) return\n      this.action.repeats = Number(val) - 1 // 0...7 = 8 beats = 3 bits\n    }\n  },\n\n  computed: mapState(['sequence']),\n\n  mounted: function () {\n    this.$nextTick(function () {\n      this.actionNumberFrom = this.action.startActionIndex + 1\n      this.actionNumberTo = this.action.endActionIndex + 1\n      this.repeats = this.action.repeats + 1\n    })\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-loop-actions.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-loop-actions.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./action-form-loop-actions.vue?vue&type=template&id=4c5ee504&\"\nimport script from \"./action-form-loop-actions.vue?vue&type=script&lang=js&\"\nexport * from \"./action-form-loop-actions.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCardText,VCol,VContainer,VForm,VRow,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card-text',[(_vm.action)?_c('v-form',{model:{value:(_vm.action.valid),callback:function ($$v) {_vm.$set(_vm.action, \"valid\", $$v)},expression:\"action.valid\"}},[_c('v-container',{staticClass:\"pt-0 pb-0\"},[_c('v-row',[_c('v-col',{staticClass:\"pb-0\",attrs:{\"cols\":\"12\",\"lg\":\"6\",\"xl\":\"4\"}},[_c('v-select',{attrs:{\"items\":_vm.items,\"rules\":_vm.rules,\"label\":\"Action number\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.action.toActionIndex),callback:function ($$v) {_vm.$set(_vm.action, \"toActionIndex\", $$v)},expression:\"action.toActionIndex\"}})],1)],1)],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card-text>\n    <v-form v-if=\"action\" v-model=\"action.valid\">\n      <v-container class=\"pt-0 pb-0\">\n        <v-row>\n          <v-col cols=\"12\" lg=\"6\" xl=\"4\" class=\"pb-0\">\n            <v-select\n              v-model=\"action.toActionIndex\"\n              :items=\"items\"\n              :rules=\"rules\"\n              label=\"Action number\"\n              outlined\n              dense\n            ></v-select>\n          </v-col>\n        </v-row>\n      </v-container>\n    </v-form>\n  </v-card-text>\n</template>\n<script>\nimport { mapState } from 'vuex'\n\nexport default {\n  props: {\n    action: {\n      type: Object,\n      required: true\n    },\n    actionIndex: {\n      type: Number,\n      required: true\n    }\n  },\n  \n  data: () => ({\n    selected: 0,\n    rules: [\n      (v) => !isNaN(v) || \"Action should be selected\"\n    ]\n  }),\n\n  computed: {\n    items: function() {\n      return this.sequence.map((sequenceEntry, index) => {\n        let text = ''\n        if(sequenceEntry) {\n          text = `#${index + 1} ${sequenceEntry.title}`\n        } else {\n          text = `#${index + 1}`\n        }\n\n        return {\n          text,\n          value: index,\n          disabled: index === this.actionIndex // don't allow to jump to itself\n        }\n      })\n    },\n    ...mapState(['sequence'])\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-jump.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./action-form-jump.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./action-form-jump.vue?vue&type=template&id=94257c22&\"\nimport script from \"./action-form-jump.vue?vue&type=script&lang=js&\"\nexport * from \"./action-form-jump.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\ninstallComponents(component, {VCardText,VCol,VContainer,VForm,VRow,VSelect})\n","<template>\n  <v-card elevation=\"2\" outlined shaped\n    :class=\"colorClass\"\n    @dragenter=\"onCheckDrop\"\n    @dragover=\"onCheckDrop\"\n    @drop.prevent=\"onChipDrop\">\n      <v-chip class=\"ml-3 mt-3 text--disabled\" v-if=\"action === null\" outlined>Empty slot</v-chip>\n      <v-chip class=\"ml-3 mt-3\" v-else :color=\"action.color\" close @click:close=\"onChipClose\">{{ action.title }}</v-chip>\n      <div class=\"float-right ma-4 text--secondary\"># {{ actionIndex + 1 }}</div>\n      <v-card-subtitle v-if=\"action === null\">Add new action by dropping here an action type from the list</v-card-subtitle>\n      <ActionFormSwitchSession v-if=\"action !== null && action.actionTypeId === 1\" :action=\"action\" />\n      <ActionFormStop v-if=\"action !== null && action.actionTypeId === 2\" :action=\"action\" />\n      <ActionFormLoopSessions v-if=\"action !== null && action.actionTypeId === 3\" :action=\"action\" />\n      <ActionFormLoopActions v-if=\"action !== null && action.actionTypeId === 4\" :action=\"action\" />\n      <ActionFormJump v-if=\"action !== null && action.actionTypeId === 5\" :action=\"action\" :actionIndex=\"actionIndex\" />\n  </v-card>\n</template>\n<script>\nimport { mapState, mapMutations } from 'vuex'\nimport ActionFormSwitchSession from \"./action-form-switch-session\"\nimport ActionFormStop from './action-form-stop'\nimport ActionFormLoopSessions from './action-form-loop-sessions'\nimport ActionFormLoopActions from './action-form-loop-actions'\nimport ActionFormJump from './action-form-jump'\n\nexport default {\n  components: {\n    ActionFormSwitchSession,\n    ActionFormStop,\n    ActionFormLoopSessions,\n    ActionFormLoopActions,\n    ActionFormJump\n  },\n\n  props: {\n    actionIndex: {\n      type: Number,\n      required: true\n    }\n  },\n\n  data: () => ({\n    \n  }),\n\n  computed: {\n    colorClass: function() {\n      if(this.action !== null){\n        if (this.actionIndex === this.activeActionIndex) {\n          return 'blue-grey darken-1'\n        } else {\n          return 'blue-grey darken-4'\n        }\n      } else {\n        return ''\n      }\n    },\n    action: function() {\n      if (this.sequence) {\n        return this.sequence[this.actionIndex]\n      } else {\n        return null\n      }\n    },\n    ...mapState([\n      'sequence',\n      'activeActionIndex'])\n  },\n\n  methods: {\n    onCheckDrop: function(event) {\n      if(event.dataTransfer.types.includes('action-type-id')) {\n        event.preventDefault()\n      }\n    },\n    onChipDrop: function(event) {\n      // default data type is String here in the dataTransfer Object, we need to cast it to Number\n      const actionTypeId = Number(event.dataTransfer.getData('action-type-id'))\n      // calling vuex mutation, if more than 1 arguments - should be passed as an object\n      this.addSequenceActionAt({ actionIndex: this.actionIndex, actionTypeId: actionTypeId })\n    },\n    onChipClose: function() {\n      this.clearSequenceActionAt(this.actionIndex) // calling vuex mutation\n    },\n    ...mapMutations([\n      'clearSequenceActionAt',\n      'addSequenceActionAt'])\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sequence-entry.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sequence-entry.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./sequence-entry.vue?vue&type=template&id=51d99aee&\"\nimport script from \"./sequence-entry.vue?vue&type=script&lang=js&\"\nexport * from \"./sequence-entry.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardSubtitle } from 'vuetify/lib/components/VCard';\nimport { VChip } from 'vuetify/lib/components/VChip';\ninstallComponents(component, {VCard,VCardSubtitle,VChip})\n","<template>\n  <v-app id=\"rk002-sequence-editor\">\n    <v-app-bar app flat>\n      <v-toolbar-title style=\"min-width: 150px\">\n        <a class=\"title-link\" href=\"/\">LENSFLARE.DEV</a>\n      </v-toolbar-title>\n      <v-tabs color=\"grey darken-1\" class=\"ml-2 mr-2\" v-model=\"activeTab\">\n        <v-tab v-for=\"link in links\" :key=\"link.title\" :href=\"link.url\">\n          {{ link.title }}\n        </v-tab>\n      </v-tabs>\n      <v-tooltip bottom>\n        <template v-slot:activator=\"{ on, attrs }\">\n          <v-btn icon outlined rounded class=\"mr-1\" @click=\"onDownloadClick\" v-bind=\"attrs\" v-on=\"on\" :disabled=\"commDisabled\">\n            <v-icon>mdi-arrow-down-bold</v-icon>\n          </v-btn>\n        </template>\n        <span>Download sequence from RK002</span>\n      </v-tooltip>\n      <v-tooltip bottom>\n        <template v-slot:activator=\"{ on, attrs }\">\n          <v-btn icon outlined rounded class=\"mr-1\" @click=\"parseAndUploadSequence\" v-bind=\"attrs\" v-on=\"on\" :disabled=\"commDisabled\">\n            <v-icon>mdi-arrow-up-bold</v-icon>\n          </v-btn>  \n        </template>\n        <span>Upload sequence to RK002</span>\n      </v-tooltip>    \n      <v-tooltip bottom>\n        <template v-slot:activator=\"{ on, attrs }\">\n          <v-btn icon outlined rounded class=\"mr-1\" @click.stop=\"configDialog = true\" v-bind=\"attrs\" v-on=\"on\">\n            <v-icon>mdi-cog</v-icon>\n          </v-btn>\n        </template>\n        <span>MIDI Configuration</span>\n      </v-tooltip>\n    </v-app-bar>\n\n    <v-main>\n      <v-container>\n        <v-row>\n          <v-col class=\"d-flex justify-end align-start\" cols=\"3\" md=\"4\" lg=\"3\">\n            <!-- Left column -->\n            <SequencerSimulator />\n          </v-col>\n          <v-col class=\"d-flex justify-center\" cols=\"6\" md=\"6\" lg=\"6\">\n            <v-sheet rounded=\"lg\" style=\"width: 100%;\">\n              <!-- Middle column -->\n              <v-container>\n                <h3 class=\"text-center\">Action Sequencer</h3>\n                <v-row dense>\n                  <v-col>\n                    <SequenceEntry\n                      v-for=\"(sequenceEntry, index) in sequence\"\n                      :key=\"index\"\n                      :action-index=\"index\"\n                      :class=\"index != 0 ? 'mt-3' : ''\"\n                    />\n                  </v-col>\n                </v-row>\n              </v-container>\n            </v-sheet>\n          </v-col>\n          <v-col class=\"d-flex justify-start align-start\" cols=\"3\" md=\"2\" lg=\"3\">\n            <v-sheet rounded=\"lg\" max-width=\"175px\" min-width=\"175px\" class=\"sheets-fixed\">\n              <!-- Right column -->\n              <v-container>\n                <h3 class=\"text-center\">Actions</h3>\n                <p class=\"text--disabled text-center mb-0\">\n                  Drop me to the slot:\n                </p>\n                <v-row\n                  v-for=\"(action, index) in actionTypes\"\n                  :key=\"index\"\n                  dense\n                >\n                  <v-chip\n                    class=\"action-chips ma-2\"\n                    :disabled=\"action.actionTypeId === 4\"\n                    :key=\"index\"\n                    :color=\"action.color\"\n                    :input-value=\"true\"\n                    filter\n                    :filter-icon=\"action.icon\"\n                    draggable\n                    @dragstart=\"onChipDragStart($event, action)\"\n                    @mouseenter=\"onChipMouseEnter(action)\"\n                    @mouseleave=\"onChipMouseLeave\"\n                  >\n                    {{ action.title }}\n                  </v-chip>\n                </v-row>\n              </v-container>\n            </v-sheet>\n          </v-col>\n        </v-row>\n      </v-container>\n    </v-main>\n    <v-snackbar\n      v-model=\"snackbar\"\n      :timeout=\"10000\"\n      :color=\"snackbarColor\"\n    >\n      {{ snackbarText }}\n\n      <template v-slot:action=\"{ attrs }\">\n        <v-btn\n          color=\"white\"\n          text\n          v-bind=\"attrs\"\n          @click=\"snackbar = false\"\n        >\n          Close\n        </v-btn>\n      </template>\n    </v-snackbar>\n    <v-footer inset app>{{ statusBarText }}</v-footer>\n    <v-dialog\n      v-model=\"configDialog\"\n      max-width=\"600\"\n    >\n      <v-card>\n        <v-card-title>\n          <span class=\"headline\">MIDI Configuration</span>\n        </v-card-title>\n        <v-card-text class=\"pb-0\">\n          <v-container>\n            <v-row>\n              <v-col cols=\"12\" sm=\"6\">\n                <v-select\n                  :disabled=\"commInProcess\"\n                  :items=\"midiInputs\"\n                  v-model=\"midiInputId\"\n                  label=\"Input (Orange connector)\"\n                  required\n                  outlined\n                  dense\n                ></v-select>\n              </v-col>\n              <v-col cols=\"12\" sm=\"6\">\n                <v-select\n                  :disabled=\"commInProcess\"\n                  :items=\"midiOutputs\"\n                  v-model=\"midiOutputId\"\n                  label=\"Output (Black connector)\"\n                  required\n                  outlined\n                  dense\n                ></v-select>\n              </v-col>\n            </v-row>\n            <v-row v-if=\"firmwareInfo\">\n              <small class=\"font-weight-bold\">{{ firmwareInfo.name }} v{{ firmwareInfo.version }}</small>\n            </v-row>\n            <v-row v-if=\"firmwareInfo\">\n              <small class=\"font-weight-bold\">{{ firmwareInfo.author }}</small>\n            </v-row>\n          </v-container>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"primary\" @click=\"tryToConnect\" :disabled=\"commInProcess\">\n            Connect\n          </v-btn>\n          <v-btn color=\"default\" @click=\"configDialog = false\">\n            Close\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n    <v-dialog v-model=\"overwriteDialog\" max-width=\"320\">\n      <v-card>\n        <v-card-title>\n          Replace current sequence?\n        </v-card-title>\n        <v-card-text>\n          Your current sequence is not empty. <br/>Do you want to replace current sequence with loaded from the RK002?\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn @click=\"onReplace\" color=\"primary\">\n            Replace\n          </v-btn>\n          <v-btn @click=\"overwriteDialog = false\">\n            Cancel\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </v-app>\n</template>\n\n<script>\nimport SequencerSimulator from \"./components/sequencer-simulator\"\nimport SequenceEntry from \"./components/sequence-entry\"\nimport { mapState, mapMutations, mapGetters, mapActions } from 'vuex'\n\nexport default {\n  name: \"rk002-sequence-editor\",\n\n  components: {\n    SequenceEntry,\n    SequencerSimulator\n  },\n\n  data: () => ({    \n    configDialog: false,\n    overwriteDialog: false, \n    activeTab: 1,\n    snackbar: false,\n    snackbarText: '',\n    snackbarColor: 'red',\n    statusBarText: \"Status bar\",\n    links: [\n      { title: \"RK002 Circuit Song Mode\", url: \"\" },\n      { title: \"About\", url: \"/retrokits/2020/11/24/rk002-circuit-song-mode.html\" }\n    ],\n  }),\n\n  computed: {\n    midiInputId: {\n      get: function() {\n        return this.selectedMidiInputId\n      },\n      set: function(newValue) {\n        this.setSelectedMidiInputId(newValue)\n      }\n    },\n    midiOutputId: {\n      get: function() {\n        return this.selectedMidiOutputId\n      },\n      set: function(newValue) {\n        this.setSelectedMidiOutputId(newValue)\n      }\n    },\n    ...mapState([\n      'actionTypes',\n      'errorMessage', \n      'sequence',\n      'commInProcess',\n      'selectedMidiInputId',\n      'selectedMidiOutputId',\n      'firmwareInfo',\n      'expectedFirmwareVersion',\n      'expectedFirmwareGUID']),\n    ...mapGetters([\n      'sequenceValid',\n      'connected',\n      'commDisabled',\n      'midiInputs',\n      'midiOutputs'\n      ])\n  },\n\n  watch: {\n    errorMessage: function(val) {\n      if(val.length > 0) {\n        this.snackbarText = val\n        this.setErrorMessage('')\n        this.snackbar = true\n      }\n    },\n    firmwareInfo: function(val) {\n      if(!val) return\n      // check if correct software installed on RK002 and show error if not\n      if (val.version !== this.expectedFirmwareVersion || val.guid !== this.expectedFirmwareGUID) {\n        this.setErrorMessage('You have unsupported software on the RK002')\n      }\n    },\n    connected: async function(val) {\n      if(!val) return\n      // requesting parameters after successfull connection\n      const sleep = ms => new Promise(r => setTimeout(r, ms))\n      await sleep(50) //50ms delay. When requesting too fast - device is not responding.\n      this.onDownloadClick()\n    }\n  },\n\n  methods: {\n    onChipDragStart: function (event, action) {\n      event.dataTransfer.dropEffect = \"copy\";\n      event.dataTransfer.effectAllowed = \"copy\";\n      event.dataTransfer.setData(\"action-type-id\", action.actionTypeId);\n    },\n    onChipMouseEnter: function(action) {\n      this.statusBarText = \"Hint: \" + action.hint\n    },\n    onChipMouseLeave: function() {\n      this.statusBarText = \"Status bar\"\n    },\n    onDownloadClick: async function() {\n      if(this.commInProcess) return\n      // if sequence is empty - load sequence, if not - ask user what to do\n      if(this.sequence.filter(action => action === null).length === this.sequence.length) {\n        this.onReplace()\n      } else {\n        // ask user what to do\n        this.overwriteDialog = true\n      }\n    },\n    onReplace: async function() {\n      this.overwriteDialog = false\n      try {\n        await this.fetchParameters()\n        this.parseAndLoadSequence()\n      } catch (err) {\n        this.setErrorMessage('Error loading sequence from RK002')\n        console.error('Method \"onReplace\" error:', err)\n      }\n    },\n    ...mapMutations([\n      'clearSequenceActionAt', \n      'addSequenceActionAt',\n      'setErrorMessage',\n      'setSelectedMidiInputId',\n      'setSelectedMidiOutputId']),\n    ...mapActions([\n      'initWebMIDI',\n      'tryToConnect',\n      'fetchParameters',\n      'parseAndLoadSequence',\n      'parseAndUploadSequence'])\n  },\n  mounted: async function() {\n    try {      \n      await this.initWebMIDI()\n    } catch(err) {\n      this.setErrorMessage('Error: can\\'t init Web MIDI')\n      console.error('On \"mounted\" error:', err)\n    }\n  }\n}\n</script>\n<style scoped>\n  .action-chips {\n    cursor: grab;\n  }\n  .sheets-fixed {\n    position: fixed;\n  }\n  .title-link {\n    color: white;\n    text-decoration: none;\n  }\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=32ab9150&scoped=true&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=32ab9150&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"32ab9150\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VAppBar } from 'vuetify/lib/components/VAppBar';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VChip } from 'vuetify/lib/components/VChip';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VFooter } from 'vuetify/lib/components/VFooter';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VMain } from 'vuetify/lib/components/VMain';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSheet } from 'vuetify/lib/components/VSheet';\nimport { VSnackbar } from 'vuetify/lib/components/VSnackbar';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTab } from 'vuetify/lib/components/VTabs';\nimport { VTabs } from 'vuetify/lib/components/VTabs';\nimport { VToolbarTitle } from 'vuetify/lib/components/VToolbar';\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VApp,VAppBar,VBtn,VCard,VCardActions,VCardText,VCardTitle,VChip,VCol,VContainer,VDialog,VFooter,VIcon,VMain,VRow,VSelect,VSheet,VSnackbar,VSpacer,VTab,VTabs,VToolbarTitle,VTooltip})\n","import Vue from 'vue';\nimport Vuetify from 'vuetify/lib';\n\nVue.use(Vuetify);\n\nexport default new Vuetify({\n    theme: { dark: true }\n});\n","\"use strict\";\n/* eslint-disable */\n\nvar RK002 = RK002 || {};\n\nRK002.rk005 = false; // interface is rk005\nRK002.dbg = true;\nRK002.dbg_rxtx = RK002.dbg && true;\nRK002.dbg_rxtx_raw = RK002.dbg_rxtx && true;\nRK002.dbg_rxtx_pck = RK002.dbg_rxtx && true;\n\n/**************************************************************************//**\n * data I/O.\n ******************************************************************************/\nRK002.read_uint8 = function(data,offset)\n{\n\tvar res =((offset < data.length) ? data[offset] : 0) & 0xff;\n\treturn res;\n}\n\nRK002.read_uint16 = function(data,offset)\n{\n\tvar res = RK002.read_uint8(data,offset+1);\n\tres *= 1<<8;\n\tres += RK002.read_uint8(data,offset);\n\treturn res;\n}\n\nRK002.read_uint32 = function(data,offset)\n{\n\tvar res = RK002.read_uint16(data,offset+2);\n\tres *= 1<<16;\n\tres += RK002.read_uint16(data,offset);\n\treturn res;\n}\n\nRK002.read_string = function(data,offset,maxsz)\n{\n\tvar str = \"\";\n\t\n\tfor (var i=0; (i<maxsz) && ((offset+i) < data.length); i++)\n\t{\n\t\tvar c = data[offset+i];\n\t\tif ((c==0) || (c>127))\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t\tstr += String.fromCharCode(c);\n\t}\n\t\n\treturn str;\n}\n\nRK002.vstostr = function(vs)\n{\n\tvar str;\n\t\n\tvar vs_a = (vs>>8) & 0x0f;\n\tvar vs_b = (vs>>4) & 0x0f;\n\tvar vs_c = (vs>>0) & 0x0f;\n\t\n\tstr = \"\" + vs_b.toString(16) + \".\" + vs_c.toString(16);\n\t\n\treturn str;\n}\n\nRK002.crc32 = function(crc, data, offset, n)\n{\n\tvar j,b,msk;\n\t\n\tcrc ^= 0xFFFFFFFF;\n\t\n\twhile (n--)\n\t{\n\t\tb = data[offset++];\n\t\tcrc = crc ^ b;\n\t\tfor (j=7; j>=0; j--)\n\t\t{\n\t\t\tmsk = -(crc & 1);\n\t\t\tcrc = ((crc >> 1)&0x7FFFFFFF) ^ (0xEDB88320 & msk);\n\t\t}\n\t}\n\t\n\tcrc ^= 0xFFFFFFFF;\n\t\n\t// AJH: force UINT32:\n\tcrc = crc>>>0;\n\t\n\treturn crc;\n}\n\n/**************************************************************************//**\n * RK002 cable types.\n ******************************************************************************/\nRK002.cableTypeToString = function(cabletype)\n{\n\tvar cabletypes = [\"RK002/INTERN\",\"RK002/KVS\",\"RK002/ARP\",\"RK002/VID\",\"RK002/SYNC\",\"RK002/MOD\",\"RK002/KOS\"];\n\t\n\tif ((cabletype >= 0) && (cabletype < cabletypes.length))\n\t{\n\t\treturn cabletypes[cabletype];\n\t}\n\telse\n\t{\n\t\treturn \"unknown type\";\n\t}\n}\n\n/**************************************************************************//**\n * sysex.\n ******************************************************************************/\nRK002.SysexCodec = function()\n{\n\tvar SYX_HEADER_SIZE\t\t\t\t= 6;\n\t\n\tvar syx_hdr = [0xF0,0x00,0x21,0x23,0x00,0x02];\n\t//                  \\____________/ \\_______/\n\t//                     retrokits     RK002\n\t\n\tvar syx_hdr_legacy = [0xF0,0x7D,0x7F,0x56,0x47,0x53];\n\t\n\tvar pcktypes = \n\t[\n\t {cmd:0x00,name:\"boot0_req\"},\n\t {cmd:0x40,name:\"boot0_rsp\"},\n\t {cmd:0x01,name:\"boot1_req\"},\n\t {cmd:0x41,name:\"boot1_rsp\"},\n\t {cmd:0x02,name:\"checksum_req\",arg:[{name:\"adr\",type:\"uint32\"},{name:\"n\",type:\"uint32\"}]},\n\t {cmd:0x42,name:\"checksum_rsp\",arg:[{name:\"adr\",type:\"uint32\"},{name:\"n\",type:\"uint32\"},{name:\"crc32\",type:\"uint32\"}]},\n\t {cmd:0x03,name:\"writemem_req\",arg:[{name:\"adr\",type:\"uint32\"},{name:\"data\",type:\"uint8\",dim:64}]},\n\t {cmd:0x43,name:\"writemem_rsp\",arg:[{name:\"adr\",type:\"uint32\"},{name:\"res\",type:\"uint8\"}]},\n\t {cmd:0x04,name:\"readmem_req\",arg:[{name:\"adr\",type:\"uint32\"}]},\n\t {cmd:0x44,name:\"readmem_rsp\",arg:[{name:\"adr\",type:\"uint32\"},{name:\"data\",type:\"uint8\",dim:64}]},\n\t {cmd:0x05,name:\"exec_req\",arg:[{name:\"adr\",type:\"uint32\"}]},\n\t {cmd:0x06,name:\"hardfault_ind\",arg:[{name:\"pc\",type:\"uint32\"}]},\n\t {cmd:0x07,name:\"txtstr_ind\",arg:[{name:\"str\",type:\"string\",dim:64}]},\n\t {cmd:0x08,name:\"setparam_req\",arg:[{name:\"nr\",type:\"uint16\"},{name:\"val\",type:\"uint16\"}]},\n\t {cmd:0x48,name:\"setparam_rsp\",arg:[{name:\"nr\",type:\"uint16\"},{name:\"val\",type:\"uint16\"}]},\n\t {cmd:0x09,name:\"getparam_req\",arg:[{name:\"nr\",type:\"uint16\"}]},\n\t {cmd:0x49,name:\"getparam_rsp\",arg:[{name:\"nr\",type:\"uint16\"},{name:\"val\",type:\"uint16\"}]},\n\t {cmd:0x0a,name:\"getnmbparams_req\"},\n\t {cmd:0x4a,name:\"getnmbparams_rsp\",arg:[{name:\"n\",type:\"uint16\"}]},\n\t {cmd:0x0b,name:\"getparamdef_req\",arg:[{name:\"param_nr\",type:\"uint16\"}]},\n\t {cmd:0x4b,name:\"getparamdef_rsp\",arg:[{name:\"param_nr\",type:\"uint16\"},{name:\"min\",type:\"uint16\"},{name:\"max\",type:\"uint16\"},{name:\"def\",type:\"uint16\"},{name:\"flags\",type:\"uint8\"},{name:\"lbl\",type:\"string\",dim:32}]},\n\t {cmd:0x0c,name:\"jump_req\",arg:[{name:\"adr\",type:\"uint32\"}]},\n\t {cmd:0x4c,name:\"jump_rsp\",arg:[{name:\"adr\",type:\"uint32\"},{name:\"res\",type:\"uint8\"}]},\n\t \t \n\t {cmd:0x00,name:\"legacy_inquiry_req\",legacy:true},\n\t {cmd:0x40,name:\"legacy_inquiry_rsp\",legacy:true,arg:[{name:\"cabletype\",type:\"uint8\"},{name:\"sz\",type:\"uint32\"},{name:\"cs\",type:\"uint32\"},{name:\"svnstr\",type:\"string\",dim:64}]},\n\t {cmd:0x01,name:\"legacy_writemem_req\",legacy:true,arg:[{name:\"adr\",type:\"uint32\"},{name:\"data\",type:\"uint8\",dim:64}]},\n\t {cmd:0x41,name:\"legacy_writemem_rsp\",legacy:true,arg:[{name:\"adr\",type:\"uint32\"},{name:\"res\",type:\"uint8\"}]},\n\t {cmd:0x02,name:\"legacy_updatefw_req\",legacy:true},\n\t {cmd:0x42,name:\"legacy_updatefw_rsp\",legacy:true},\n\t \n\t \n\t]; \n\t\n\tvar encodeDat = function(srcdat)\n\t{\n\t\tvar d;\n\t\tvar msbctr = 8;\n\t\tvar desdat = [];\n\t\t\n\t\tfor (var srcidx=0; srcidx<srcdat.length; srcidx++)\n\t\t{\n\t\t\tif (msbctr >= 7)\n\t\t\t{\n\t\t\t\tdesdat[desdat.length] = 0;\n\t\t\t\tmsbctr = 0;\n\t\t\t}\n\t\t\td = srcdat[srcidx];\n\t\t\tif (d & 0x80)\n\t\t\t{\n\t\t\t\tdesdat[desdat.length - msbctr - 1] |= (1<<msbctr);\n\t\t\t}\n\t\t\tdesdat[desdat.length] = d & 0x7f;\n\t\t\tmsbctr ++;\t\t\t\n\t\t}\t\n\t\t\n\t\treturn desdat;\n\t}\n\t\n\tvar decodeDat = function(srcdat, offset, n)\n\t{\n\t\tvar d;\n\t\tvar msb;\n\t\tvar desdat = [];\n\t\t\n\t\tfor (var srcidx=0; srcidx<n; srcidx++)\n\t\t{\n\t\t\td = srcdat[offset+srcidx];\n\t\t\t\n\t\t\tif ((srcidx & 7) == 0)\n\t\t\t{\n\t\t\t\tmsb = d;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (msb & 0x01)\n\t\t\t\t{\n\t\t\t\t\td |= 0x80;\n\t\t\t\t}\n\t\t\t\tmsb >>= 1;\n\t\t\t\tdesdat[desdat.length] = d;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn desdat;\n\t}\n\t\n\tthis.encodePck = function(pck)\n\t{\n\t\tvar res = [];\n\t\t\n\t\tfor (var i=0; i<pcktypes.length; i++)\n\t\t{\n\t\t\tvar pcktype = pcktypes[i];\n\t\t\t\n\t\t\tif ((pck.cmd == pcktype.cmd) || (pck.name == pcktype.name))\n\t\t\t{\n\t\t\t\tpck.cmd = pcktype.cmd;\n\t\t\t\tpck.name = pcktype.name;\n\t\t\t\t\n\t\t\t\t// parse possible args:\n\t\t\t\tif (typeof pcktype.arg !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tfor (var j=0; j<pcktype.arg.length; j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar argtype = pcktype.arg[j];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (typeof pck[argtype.name] !== 'undefined')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar v = pck[argtype.name];\n\t\t\t\t\t\t\tvar dim = (typeof argtype.dim !== 'undefined') ? argtype.dim : 0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (dim == 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tv = [v];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar k = 0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdo\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tswitch (argtype.type)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcase \"uint8\":\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>0)&255);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tcase \"uint16\":\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>0)&255);\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>8)&255);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tcase \"uint32\":\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>0)&255);\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>8)&255);\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>16)&255);\n\t\t\t\t\t\t\t\t\t\tres.push((v[k]>>24)&255);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t} while ((k<dim) && (k<v.length));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// <header><cmd><arg><f7>\n\t\t\t\tif (pcktype.legacy)\n\t\t\t\t{\n\t\t\t\t\tres = syx_hdr_legacy.concat([pck.cmd]).concat(encodeDat(res)).concat([0xf7]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tres = syx_hdr.concat([pck.cmd]).concat(encodeDat(res)).concat([0xf7]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (res.length == 0)\n\t\t{\n\t\t\tthrow \"trying to encode undefined packet type: name=\"+pck.name;\n\t\t}\n\t\t\n\t\treturn res;\n\t}\n\t\t\n\tthis.tryDecode = function(dat)\n\t{\n\t\tvar res = null;\n\t\t\n\t\tif (dat.length > syx_hdr.length)\n\t\t{\n\t\t\tvar isok = true;\n\t\t\tvar rxlegacy = false;\n\t\t\t\n\t\t\tfor (var i=0; (isok && (i<syx_hdr.length)); i++)\n\t\t\t{\n\t\t\t\tisok = (dat[i] == syx_hdr[i]);\n\t\t\t}\n\t\t\t\n\t\t\tif (!isok)\n\t\t\t{\n\t\t\t\tisok = true;\n\t\t\t\trxlegacy = true;\n\t\t\t\tfor (var i=0; (isok && (i<syx_hdr_legacy.length)); i++)\n\t\t\t\t{\n\t\t\t\t\tisok = (dat[i] == syx_hdr_legacy[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (isok)\n\t\t\t{\n\t\t\t\tres = [];\n\t\t\t\tres.cmd = dat[syx_hdr.length];\n\t\t\t\t\n\t\t\t\tvar n = dat.length - 2 - syx_hdr.length;\n\t\t\t\tif (n > 0)\n\t\t\t\t{\n\t\t\t\t\tdat = decodeDat(dat, syx_hdr.length + 1, n);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdat = [];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// now decode by cmd:\n\t\t\t\tfor (var i=0; i<pcktypes.length; i++)\n\t\t\t\t{\n\t\t\t\t\tvar pcktype = pcktypes[i];\n\t\t\t\t\tvar pcklegacy = (typeof pcktype.legacy !== 'undefined') && pcktype.legacy;\n\t\t\t\t\tvar legacymatch = (pcklegacy == rxlegacy);\n\t\t\t\t\t\n\t\t\t\t\t// is this the cmd? \n\t\t\t\t\tif ((res.cmd == pcktype.cmd) && legacymatch)\n\t\t\t\t\t{\n\t\t\t\t\t\t// fill in some fields:\n\t\t\t\t\t\tres.name = pcktype.name;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// parse possible args:\n\t\t\t\t\t\tif (typeof pcktype.arg !== 'undefined')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar datpos = 0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (var j=0; (j<pcktype.arg.length) && (datpos<dat.length); j++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar argtype = pcktype.arg[j];\n\t\t\t\t\t\t\t\tvar v = [];\n\t\t\t\t\t\t\t\tvar dim = (typeof argtype.dim !== 'undefined') ? argtype.dim : 0;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (argtype.type == \"string\")\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tv = \"\";\n\t\t\t\t\t\t\t\t\tfor (var k=0; (k<dim) && (datpos<dat.length); k++)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tvar c = dat[datpos++];\n\t\t\t\t\t\t\t\t\t\tif (c>0)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tv += String.fromCharCode(c);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar k = 0;\n\t\t\t\t\t\t\t\t\tdo\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tswitch (argtype.type)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tcase \"uint8\":\n\t\t\t\t\t\t\t\t\t\t\t\tv.push(RK002.read_uint8(dat,datpos));\n\t\t\t\t\t\t\t\t\t\t\t\tdatpos += 1;\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tcase \"uint16\":\n\t\t\t\t\t\t\t\t\t\t\t\tv.push(RK002.read_uint16(dat,datpos));\n\t\t\t\t\t\t\t\t\t\t\t\tdatpos += 2;\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tcase \"uint32\":\n\t\t\t\t\t\t\t\t\t\t\t\tv.push(RK002.read_uint32(dat,datpos));\n\t\t\t\t\t\t\t\t\t\t\t\tdatpos += 4;\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"unknown argtype '\"+argtype.type+\"'\");\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t\t\t} while (k<dim);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (dim == 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tv = v[0];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tres[argtype.name] = v;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t// we've found our packet: break the loop\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn res;\n\t}\n\t\n\tvar val2hex = function(val, width)\n\t{\n\t\tvar str = \"0x\";\n\t\t\n\t\tdo\n\t\t{\n\t\t\twidth -= 8;\n\t\t\tstr += RK002.bytehex((val>>width)&0xff);\n\t\t} while (width > 0);\n\t\t\n\t\treturn str;\n\t}\n\t\n\tthis.pckToString = function(pck)\n\t{\n\t\tvar str = pck.name.toUpperCase();\n\t\tvar first = true;\n\t\t\n\t\t// now decode by cmd:\n\t\tfor (var i=0; i<pcktypes.length; i++)\n\t\t{\n\t\t\tvar pcktype = pcktypes[i];\n\t\t\t\n\t\t\tif (pcktype.cmd == pck.cmd)\n\t\t\t{\n\t\t\t\t// parse possible args:\n\t\t\t\tif (typeof pcktype.arg !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tfor (var j=0; (j<pcktype.arg.length); j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar argtype = pcktype.arg[j];\n\t\t\t\t\t\tif (typeof pck[argtype.name] !== 'undefined')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (first)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstr += \" {\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstr += \", \";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstr += \"\"+argtype.name+\"=\";\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar val = pck[argtype.name];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (val.constructor === Array)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstr += \"[]\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tswitch (argtype.type)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcase \"uint8\":\n\t\t\t\t\t\t\t\t\t\tstr += val2hex(val,8);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tcase \"uint16\":\n\t\t\t\t\t\t\t\t\t\tstr += val2hex(val,16);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tcase \"uint32\":\n\t\t\t\t\t\t\t\t\t\tstr += val2hex(val,32);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\t\t\t\t\tstr += \"\\\"\" + val + \"\\\"\";\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tstr += val;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tfirst = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!first)\n\t\t\t\t\t{\n\t\t\t\t\t\tstr += \"}\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn str;\n\t}\n}\n\nRK002.sysexcodec = new RK002.SysexCodec();\n\nRK002.Pck = function(name,arg)\n{\n\tthis.name = name;\n\tif (typeof arg !== \"undefined\")\n\t{\n\t\tif (arg.constructor === Array)\n\t\t{\n\t\t\tfor (var i=0; i<arg.length; i++)\n\t\t\t{\n\t\t\t\tfor (var argname in arg[i])\n\t\t\t\t{\n\t\t\t\t\tthis[argname] = arg[i][argname];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\tif (arg.constructor === Object)\n\t\t{\n\t\t\tfor (var argname in arg)\n\t\t\t{\n\t\t\t\tthis[argname] = arg[argname];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (var argname in arg)\n\t\t\t{\n\t\t\t\tthis[argname] = arg[argname];\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**************************************************************************//**\n * raw buffer.\n ******************************************************************************/\nRK002.RawBuf = function()\n{\n\tthis.buf = [];\n\tthis.length = 0;\n\t\n\tthis.addByte = function(b)\n\t{\n\t\tthis.buf[this.length++] = b & 255;\n\t}\n\tthis.addUint16LE = function(v)\n\t{\n\t\tthis.addByte(v);\n\t\tthis.addByte(v>>8);\n\t}\n\t\n\tthis.addUint32LE = function(v)\n\t{\n\t\tthis.addUint16LE(v);\n\t\tthis.addUint16LE(v>>16);\n\t}\n\t\n\tthis.addString = function(str)\n\t{\n\t\tfor (var i=0; i<str.length; i++)\n\t\t{\n\t\t\tthis.addByte(str.charCodeAt(i));\n\t\t}\n\t}\n}\n\n/**************************************************************************//**\n * AUDIO encoder.\n ******************************************************************************/\nRK002.AudioEncoder = function()\n{\n\tvar AUDIOENC_FS \t\t\t\t\t\t= 44100;\n\tvar AUDIOENC_N_PULSES_SHORT\t\t\t\t= 8;\n\tvar AUDIOENC_N_PULSES_LONG\t\t\t\t= 16;\n\tvar AUDIOENC_N_PULSES_SYNC\t\t\t\t= ((AUDIOENC_N_PULSES_SHORT + AUDIOENC_N_PULSES_LONG) * 2);\n\tvar AUDIOENC_LEADIN_MS\t\t\t\t\t= 100;\n\tvar AUDIOENC_LEADOUT_MS\t\t\t\t\t= 100;\n\n\tvar signal = false;\n\tvar idx = 0;\n\tvar buf = [0];\n\t\n\tthis.clear = function()\n\t{\n\t\tidx = 0;\n\t\tsignal = false;\n\t}\n\t\n\tthis.advanceT = function(count)\n\t{\n\t\twhile (count--)\n\t\t{\n\t\t\tbuf[idx++] = signal;\n\t\t}\n\t}\n\t\n\tthis.invertSignal = function()\n\t{\n\t\tsignal = !signal;\n\t}\n\t\t\n\tthis.emitCarrier = function(t_ms)\n\t{\n\t\tvar t = 0;\n\n\t\twhile ((t * 1000 / AUDIOENC_FS) < t_ms)\n\t\t{\n\t\t\tthis.invertSignal();\n\t\t\tthis.advanceT(AUDIOENC_N_PULSES_SYNC);\n\t\t\tt += AUDIOENC_N_PULSES_SYNC;\n\t\t}\t\t\n\t}\n\t\n\tthis.emitByte = function(b)\n\t{\n\t\tvar i;\n\t\tvar shiftreg = b;\n\t\t\n\t\tfor (var i=0; i<8; i++)\n\t\t{\n\t\t\tthis.invertSignal();\n\n\t\t\tthis.advanceT((shiftreg & 0x01) ? AUDIOENC_N_PULSES_LONG : AUDIOENC_N_PULSES_SHORT);\n\n\t\t\tshiftreg>>=1;\n\t\t}\n\t}\n\t\n\tthis.getAsWavBase64Str = function()\n\t{\n\t\tvar NUMCHN = 2;\t\t\t\t\t\t\t\t\t\t// we generate a stereo sample; hopefully this is 'more compatible' :-)\n\t\tvar datasize = NUMCHN * idx * 2;\t\t\t\t\t// 16 bit samples -> 2 bytes per sample\n\t\tvar rawwav = new RK002.RawBuf();\n\t\t\n\t\trawwav.addString(\"RIFF\");\t\t\t\t\t\t\t// ChunkID\n\t\trawwav.addUint32LE(36 + datasize);\t\t\t\t\t// ChunkSize\n\t\trawwav.addString(\"WAVE\");\t\t\t\t\t\t\t// Format\n\t\trawwav.addString(\"fmt \");\t\t\t\t\t\t\t// Subchunk1 ID\n\t\trawwav.addUint32LE(16);\t\t\t\t\t\t\t\t// Subchunk1 Size\n\t\trawwav.addUint16LE(1);\t\t\t\t\t\t\t\t// AudioFormat\n\t\trawwav.addUint16LE(NUMCHN);\t\t\t\t\t\t\t// Num channels\n\t\trawwav.addUint32LE(AUDIOENC_FS);\t\t\t\t\t// SampleRate\n\t\trawwav.addUint32LE(AUDIOENC_FS * 4);\t\t\t\t// ByteRate\n\t\trawwav.addUint16LE(NUMCHN * 2);\t\t\t\t\t\t// BlockAlign\n\t\trawwav.addUint16LE(16);\t\t\t\t\t\t\t\t// BitsPerSample\n\t\trawwav.addString(\"data\");\t\t\t\t\t\t\t// Subchunk2 ID\n\t\trawwav.addUint32LE(datasize);\t\t\t\t\t\t// Subchunk2 Size\n\t\t\n\t\tfor (var i=0; i<idx; i++)\n\t\t{\n\t\t\tfor (var chn=0; chn<NUMCHN; chn++)\n\t\t\t{\n\t\t\t\trawwav.addUint16LE(buf[i] ? 0x7fff : 0x8000);\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar wavb64 = \"data:audio/wav;base64,\" + base64.encode(rawwav.buf);\n\t\t\n\t\treturn wavb64;\n\t}\n\t\n\tthis.CRC8B = function(crc,dat)\n\t{\n\t\t/*\n\t\t * CRC_POLYNOM = 0x9c;\n\t\t * CRC_PRESET = 0xFF;\n\t\t */\n\n\t\tvar i;\n\n\t\tcrc ^= dat;\n\t\tfor (i = 0; i < 8; i++)\n\t\t{\n\t\t  if (crc & 0x01)\n\t\t  {\n\t\t      crc = (crc >> 1) ^ 0x9C;\n\t\t  }\n\t\t  else\n\t\t      crc = (crc >> 1);\n\t\t}\n\n\t\treturn crc & 0xff;\n\t}\n\t\n\tthis.encodeAudioPck = function(pck)\n\t{\n\t\tvar i,d,crc,n = pck.length;\n\t\t\n\t\tthis.clear();\n\t\tthis.emitCarrier(AUDIOENC_LEADIN_MS);\n\t\tthis.emitByte(0xAA);\n\t\tthis.emitByte((n-1));\n\t\tcrc = 0xff;\n\n\t\tfor (i=0; i<n; i++)\n\t\t{\n\t\t\t// read from packet\n\t\t\td = pck[i];\n\t\t\tcrc = this.CRC8B(crc,d);\n\t\t\t\n\t\t\tthis.emitByte(d);\n\t\t\t\n\t\t\t//console.log(\"emitting byte[\"+i+\"] = \"+d+\"(0x\"+d.toString(16)+\")\");\n\t\t}\n\t\t\n\t\tthis.emitByte(crc);\n\t\t\n\t\tthis.emitCarrier(AUDIOENC_LEADOUT_MS);\n\t\t\n\t\treturn this.getAsWavBase64Str();\n\t}\n\t\n}\n\n/**************************************************************************//**\n * I/O drivers.\n ******************************************************************************/\nRK002.OutputDrvAudio = function()\n{\n\tthis.txPck = function(pck)\n\t{\n\t\tvar enc = new RK002.AudioEncoder();\n\t\t\n\t\tvar wav = enc.encodeAudioPck(pck);\n\t\t\n\t\tvar snd = new WaudSound(wav,{volume:1.0});\n\t\t\n\t\tsnd.onLoad(function()\n\t\t\t\t{\n\t\t\t\t\tsnd.play();\n\t\t\t\t});\n\t}\n}\n\nRK002.InputDrvMIDI = function(port, observer)\n{\n\tthis.observer = observer;\n\t\n\tthis.port = port;\n\t\n\tthis.disconnect = function()\n\t{\n\t\tthis.port.onmidimessage = null;\n\t}\n\t\n\tthis.port.onmidimessage = function(event)\n\t{\n\t\t//console.log(\"InputDrvMIDI.MIDI message received\");\n\t\t\n\t\tif (observer && observer.onmidimessage)\n\t\t{\n\t\t\tobserver.onmidimessage(event.data);\n\t\t}\n\t\t\n/*\n\t\t\n\t\tvar pck = RK002.sysexcodec.tryDecode(event.data, {\n\t\t\t\n\t\t\tonInquiryRSP : function(hwvs,swvs)\n\t\t\t{\n\t\t\t\tvar hwvsstr = vstostr(hwvs);\n\t\t\t\tvar swvsstr = vstostr(swvs);\n\t\t\t\t\n\t\t\t\tconsole.log(\"hndInquiryRSP(): hwvs=\"+hwvsstr+\", swvs=\"+swvsstr);\n\t\t\t\tif (observer && observer.onInquiryRSP)\n\t\t\t\t{\n\t\t\t\t\tobserver.onInquiryRSP(hwvsstr,swvsstr);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n*/\t\t\n\t}\n}\n\n\n/**************************************************************************//**\n * some HEX tools.\n ******************************************************************************/\nRK002.nibhex = function(v)\n{\n\tv &= 0x0f;\n\t\n\tif (v<10)\n\t{\n\t\treturn String.fromCharCode(48+v);\n\t}\n\telse\n\t{\n\t\treturn String.fromCharCode(65+v-10);\n\t}\n}\n\nRK002.bytehex = function(v)\n{\n\treturn RK002.nibhex(v>>4) + RK002.nibhex(v);\n}\n\nRK002.uint32hex = function(v)\n{\n\treturn RK002.bytehex(v>>24) + RK002.bytehex(v>>16) + RK002.bytehex(v>>8) + RK002.bytehex(v);\n}\n\nRK002.dat2hexstr = function(v)\n{\n\tvar str = \"\";\n\t\n\tfor (var i=0; i<v.length; i++)\n\t{\n\t\tif (i>32)\n\t\t{\n\t\t\tstr += \".. \";\n\t\t\tbreak;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstr += RK002.bytehex(v[i]);\n\t\t\tstr += \" \";\n\t\t}\n\t}\n\t\n\treturn str;\n}\n\nRK002.OutputDrvMIDI = function(port)\n{\n\tthis.port = port;\n\t\n\tthis.txPck = function(pck)\n\t{\n\t\tport.send(pck);\n\n\t\tif (RK002.dbg_rxtx_raw)\n\t\t{\n\t\t\tRK002.DBG(\"TX:(\"+pck.length+\") \"+RK002.dat2hexstr(pck));\n\t\t}\n\t}\n}\n\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nRK002.dbg_t_last = null;\n\nRK002.DBG = function(s)\n{\n\tvar t_now = Math.floor(performance.now());\n\t\n\tif (RK002.dbg_t_last == null)\n\t{\n\t\tRK002.dbg_t_last = t_now;\n\t}\n\t\n\tvar t_diff = t_now - RK002.dbg_t_last;\n\t\n\tRK002.dbg_t_last = t_now;\n\t\n\tif (t_diff > 9999)\n\t{\n\t\tt_diff = 9999;\n\t}\n\t\n\tvar txt_diff = \"    \"+t_diff;\n\t\n\tconsole.log(txt_diff.slice(-4) + \" \" + s);\n}\n\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nRK002.Info = function(data)\n{\n\tvar RK002INFOMAXSZ = 248;\n\t\n\tvar pos = 0;\n\t\n\tthis.magic = 0;\n\tthis.date = \"\";\n\tthis.name = \"\";\n\tthis.author = \"\";\n\tthis.version = \"\";\n\tthis.guid = \"\";\n\t\n\tthis.magic = RK002.read_uint32(data,pos);\n\tpos += 4;\n\t\n\tthis.guid = RK002.read_string(data,pos,RK002INFOMAXSZ);\n\tpos += this.guid.length + 1;\n\tif (pos < RK002INFOMAXSZ)\n\t{\n\t\tthis.date = RK002.read_string(data,pos,RK002INFOMAXSZ);\t\n\t\tpos += this.date.length + 1;\n\t\tif (pos < RK002INFOMAXSZ)\n\t\t{\n\t\t\tthis.name = RK002.read_string(data,pos,RK002INFOMAXSZ);\n\t\t\tpos += this.name.length + 1;\n\t\t\tif (pos < RK002INFOMAXSZ)\n\t\t\t{\n\t\t\t\tthis.author = RK002.read_string(data,pos,RK002INFOMAXSZ);\n\t\t\t\tpos += this.author.length + 1;\n\t\t\t\tif (pos < RK002INFOMAXSZ)\n\t\t\t\t{\n\t\t\t\t\tthis.version = RK002.read_string(data,pos,RK002INFOMAXSZ);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//\n// RK002 loader.\n//\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nRK002.Loader = function()\n{\n\tvar self = this;\n\t\n\tvar SIMPLEX_INITIAL_DELAY_MS\t\t\t\t\t= 500;\n\tvar SIMPLEX_CHUNK_TIMEOUT_SHORT_MS\t\t\t\t= 100;\n\tvar SIMPLEX_CHUNK_TIMEOUT_LONG_MS\t\t\t\t= 400;\n\t\t\n\tvar DUPLEX_DETECT_MAXRETRY\t\t\t\t\t\t= 10;\n\tvar DUPLEX_CHUNK_TIMEOUT_MS\t\t\t\t\t\t= 400;\n\tvar DUPLEX_CHUNK_MAXRETRY\t\t\t\t\t\t= 4;\n\t\n\tvar GET_NMB_PARAMS_TIMEOUT_MS\t\t\t\t\t= 100;\n\tvar GET_PARAM_TIMEOUT_MS\t\t\t\t\t\t= 500;\n\t\n\tvar DUPLEX_DETECT_MAXRETRY_VERY_FIRST_UPLOAD \t= 100;\n\tvar DUPLEX_CRC_RESP_TIMEOUT_MS\t\t\t\t\t= 100;\n\tvar DUPLEX_JUMP_RSP_TIMEOUT_MS\t\t\t\t\t= 100;\n\t\n\tvar INQUIRY_PING_TIMEOUT_MS\t\t\t\t\t\t= 100;\n\tvar INQUIRY_MAXRETRY\t\t\t\t\t\t\t= 5;\n\tvar INQUIRY_RESULT_TIMEOUT\t\t\t\t\t\t= -1;\n\tvar INQUIRY_RESULT_LEGACY_INVALID\t\t\t\t= 1;\n\tvar INQUIRY_RESULT_DUY_INVALID\t\t\t\t\t= 2;\n\tvar INQUIRY_RESULT_DUY_VALID\t\t\t\t\t= 3;\n\tvar INQUIRY_RESULT_LEGACY_VALID\t\t\t\t\t= 4;\n\tvar INQUIRY_INFO_ADR\t\t\t\t\t\t\t= 0x8c0;\n\tvar INQUIRY_INFO_MAX_SZ\t\t\t\t\t\t\t= 512;\n\t\n\tvar BOOT1_PING_NMB_RETRIES\t\t\t\t\t\t= 5;\n\t\n\tvar MEMPAGESZ\t\t\t\t\t\t\t\t\t= 64;\n\n\tvar DUY_APP_MINSIZE\t\t\t\t\t\t\t\t= 64*4;\n\tvar DUY_APP_MAXSIZE\t\t\t\t\t\t\t\t= 14*1024;\n\t\n\tvar DUPLEX_LEGACY_UPDATEFW_RSP_TIMEOUT_MS\t\t= 1000;\n\t\n\tvar FLASH_SECTOR_SIZE\t\t\t\t\t\t\t= 1024;\n\t\n\tvar SYX_LEGACY_MEMCHUNKSZ\t\t\t\t\t\t= 64;\n\tvar SYX_MEMCHUNKSZ\t\t\t\t\t\t\t\t= 64;\n\t\n\tvar APP_FLASHADR\t\t\t\t\t\t\t\t= 0x0800;\n\tvar APP_RAMADR\t\t\t\t\t\t\t\t\t= 0x10000000;\n\tvar LEGACY_FLASHADR\t\t\t\t\t\t\t\t= 8*1024;\n\tvar APP_RK002SIZE_ADR\t\t\t\t\t\t\t= (APP_FLASHADR + (6*4));\n\tvar APP_CRCVAL\t\t\t\t\t\t\t\t\t= 0x524B4832;\t\t// 'RK02'\n\t\n\tvar LEGACY_MINSIZE\t\t\t\t\t\t\t\t= 64*4;\n\tvar LEGACY_MAXSIZE\t\t\t\t\t\t\t\t= 7*1024;\n\tvar LEGACY_BOOTVECTOR_CRC\t\t\t\t\t\t= 61;\n\tvar LEGACY_BOOTVECTOR_BINARYSIZE\t\t\t\t= 62;\n\tvar LEGACY_BOOTVECTOR_FWINSTALLER\t\t\t\t= 63;\n\t\n\tvar UPLOADMODE_BOOTX\t\t\t\t\t\t\t= 0;\n\tvar UPLOADMODE_LEGACY\t\t\t\t\t\t\t= 1;\n\t\n\tvar MAINSTATE_IDLE\t\t\t\t\t\t\t\t= 0;\n\tvar MAINSTATE_MONITOR\t\t\t\t\t\t\t= 1;\n\tvar MAINSTATE_UNDUINIFY\t\t\t\t\t\t\t= 2;\n\tvar MAINSTATE_INQUIRY\t\t\t\t\t\t\t= 3;\n\tvar MAINSTATE_DUINIFY\t\t\t\t\t\t\t= 4;\n\tvar MAINSTATE_GETPARAMS\t\t\t\t\t\t\t= 5;\n\tvar m_mainstate = MAINSTATE_IDLE;\n\t\n\tvar SUBSTATE_IDLE\t\t\t\t\t\t\t\t= 0;\n\tvar SUBSTATE_MONITOR\t\t\t\t\t\t\t= 1;\n\tvar SUBSTATE_INQUIRY\t\t\t\t\t\t\t= 2;\n\tvar SUBSTATE_UPLOAD\t\t\t\t\t\t\t\t= 3;\n\tvar SUBSTATE_EXPECT_UPDATE_FINAL_CRC\t\t\t= 4;\n\tvar SUBSTATE_EXPECT_BOOT1_RSP\t\t\t\t\t= 5;\n\tvar SUBSTATE_EXPECT_JUMP_RSP\t\t\t\t\t= 6;\n\tvar SUBSTATE_EXPECT_LEGACY_UPDATEFW_RSP\t\t\t= 7;\n\tvar SUBSTATE_GET_NMB_PARAMDEFS\t\t\t\t\t= 8;\n\tvar SUBSTATE_GET_PARAMDEFS\t\t\t\t\t\t= 9;\n\tvar SUBSTATE_GET_PARAMVALS\t\t\t\t\t\t\t= 10;\n\t\n\tvar m_substate = SUBSTATE_IDLE;\n\t\t\n\tvar m_outputdrvaudio = new RK002.OutputDrvAudio(this);\n\t\n\tvar m_inputdrv = null;\n\tvar m_outputdrv = null;\n\tvar m_observer = null;\n\t\t\n\tvar m_last_sts_progress = -1;\n\tvar m_last_sts_mainstr = null;\n\tvar m_last_sts_substr = null;\n\tvar m_last_sts_isok = false;\n\t\n\tvar m_tmr = null;\n\tvar m_retry;\n\t\n\tvar m_t_last = null;\n\t\n\tvar m_inquiry_rsp_mem = new Array(INQUIRY_INFO_MAX_SZ);\n\t\n\tvar m_target_data;\n\t\n\tvar m_upload_data;\n\tvar m_upload_pos;\n\tvar m_upload_des_adr;\n\tvar m_upload_mode;\n\tvar m_upload_chunksz;\n\tvar m_upload_duplex;\n\tvar m_upload_last_queued_flash_adr;\n\t\n\tvar m_getparams_idx;\n\tvar m_getparams_n;\n\tvar m_params;\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.setObserver = function(o)\n\t{\n\t\tm_observer = o;\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.setOutputDriver = function(port)\n\t{\n\t\tif ((port == null) || (port.name == \"disabled\"))\n\t\t{\n\t\t\tm_outputdrv = null;\n\t\t}\n\t\telse\n\t\tif (port.name == \"audio\")\n\t\t{\n\t\t\tm_outputdrv = m_outputdrvaudio;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tm_outputdrv = new RK002.OutputDrvMIDI(port);\n\t\t\tif(port.name==\"RK005\") RK002.rk005 = true; \n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.setInputDriver = function(port)\n\t{\n\t\tif (m_inputdrv != null)\n\t\t{\n\t\t\tm_inputdrv.disconnect();\n\t\t}\n\t\t\n\t\tif ((port == null) || (port.name == \"disabled\"))\n\t\t{\n\t\t\tm_inputdrv = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tm_inputdrv = new RK002.InputDrvMIDI(port, self);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.onmidimessage = function(data)\n\t{\n\t\tif (RK002.dbg_rxtx_raw)\n\t\t{\n\t\t\tif (data[0] != 0xf8)\n\t\t\t{\n\t\t\t\tRK002.DBG(\"RX:(\"+data.length+\") \"+RK002.dat2hexstr(data));\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (data[0] == 0xf0)\n\t\t{\n\t\t\tvar pck = RK002.sysexcodec.tryDecode(data);\n\t\t\t\n\t\t\tif (pck != null)\n\t\t\t{\n\t\t\t\tonPck(pck);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tRK002.DBG(\"RECEIVED UNKNOWN PACKET\");\n\t\t\t}\n\t\t}\n\t\t\n\t\t//console.log(\"received pck\",pck);\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar uiAddConsole = function(str)\n\t{\n\t\tRK002.DBG(\"uiaddconsole: \"+str);\n\t\tif (m_observer && m_observer.rk002_consoleTxt)\n\t\t{\n\t\t\tm_observer.rk002_consoleTxt(str);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar queuePck = function(pck, timeout_ms=0)\n\t{\n\t\tvar syxdat = RK002.sysexcodec.encodePck(pck);\n\t\tRK002.DBG(\"TX: \"+RK002.sysexcodec.pckToString(pck));\n\t\tm_outputdrv.txPck(syxdat);\n\t\tsetStateTmr(timeout_ms);\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar uiUpdateSts = function(progress,mainstr,substr,isok)\n\t{\n\t\tvar notify = false;\n\t\t\n\t\tif (progress != m_last_sts_progress)\n\t\t{\n\t\t\tm_last_sts_progress = progress;\n\t\t\tnotify = true;\n\t\t}\n\t\t\n\t\tif (mainstr != m_last_sts_mainstr)\n\t\t{\n\t\t\tm_last_sts_mainstr = mainstr;\n\t\t\tnotify = true;\n\t\t}\n\t\t\n\t\tif (substr != m_last_sts_substr)\n\t\t{\n\t\t\tm_last_sts_substr = substr;\n\t\t\tnotify = true;\n\t\t}\n\t\t\n\t\tif (isok != m_last_sts_isok)\n\t\t{\n\t\t\tm_last_sts_isok = isok;\n\t\t\tnotify = true;\n\t\t}\n\t\t\n\t\tif (notify && (m_observer != null) && (m_observer.rk002_stsUpdate))\n\t\t{\n\t\t\tvar str = mainstr;\n\t\t\tif ((substr != null) && (substr != \"\"))\n\t\t\t{\n\t\t\t\tstr += \" : \";\n\t\t\t\tstr += substr;\n\t\t\t}\n\t\t\t\n\t\t\tm_observer.rk002_stsUpdate(progress, str, isok);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar setStateTmr = function(ms)\n\t{\n\t\tif (m_tmr != null)\n\t\t{\n\t\t\tclearTimeout(m_tmr);\n\t\t\tm_tmr = null;\n\t\t}\n\t\t\n\t\tif (ms != 0)\n\t\t{\n\t\t\tm_tmr = setTimeout(onStateTmr, ms);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar enterState = function(mainstate, substate, timeout_ms = 0)\n\t{\n\t\tm_mainstate = mainstate;\n\t\tm_substate = substate;\n\t\tsetStateTmr(timeout_ms);\n\t}\n\t\n\tvar enterSubState = function(substate, timeout_ms = 0)\n\t{\n\t\tenterState(m_mainstate,substate,timeout_ms);\n\t}\n\t\n\tvar enterMonitorState = function(txt,success)\n\t{\n\t\tuiUpdateSts(100, txt, null, success);\n\t\tenterState(MAINSTATE_MONITOR,SUBSTATE_MONITOR);\n\t}\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar subOnBoot1Ready = function()\n\t{\n\t\t// OK BOOT1 is up & running now... what to do with it?\n\t\tswitch (m_mainstate)\n\t\t{\n\t\t\tcase MAINSTATE_UNDUINIFY:\n\t\t\t\t// start uploading the requested binary:\n\t\t\t\tsubStartUpload(\"uploading target binary\",m_target_data,LEGACY_FLASHADR,UPLOADMODE_BOOTX,true);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\tenterMonitorState(\"upload done\",true);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tvar subEndUpload = function(txt, success)\n\t{\n\t\tenterMonitorState(txt,success);\n\t\t\n\t\t// notify the observer:\n\t\tif ( (typeof m_observer !== 'undefined')  && (typeof m_observer.rk002_onEndUpload !== 'undefined') ) \n\t\t{\n\t\t\tvar was_legacy = m_upload_des_adr == LEGACY_FLASHADR;\n\t\t\tm_observer.rk002_onEndUpload(txt,success,was_legacy);\n\t\t}\n\t\tsubRK005SoftMode(1);\n\t}\n\n\tvar queueMemChunkAndSetTimeout = function(ms)\n\t{\n\t\tvar buf = new Uint8Array(m_upload_chunksz);\n\t\tfor (var i=0; i<m_upload_chunksz; i++)\n\t\t{\n\t\t\tbuf[i] = ((m_upload_pos + i) < m_upload_data.length) ? m_upload_data[m_upload_pos+i] : 0;\n\t\t}\n\t\t\n\t\tm_upload_last_queued_flash_adr = m_upload_des_adr + m_upload_pos;\n\t\t\n\t\tvar pck = new RK002.Pck((m_upload_mode == UPLOADMODE_LEGACY) ? \"legacy_writemem_req\" : \"writemem_req\",\n\t\t\t\t{adr:m_upload_last_queued_flash_adr, data:buf});\n\t\t\n\t\tvar progress = Math.floor((m_upload_pos * 99 / m_upload_data.length));\n\t\tuiUpdateSts(progress,m_last_sts_mainstr,\"\"+progress+\"\\%\",true);\n\t\t\n\t\tqueuePck(pck);\n\t\tsetStateTmr(ms);\n\t}\n\t\n\tvar queueExecReq = function()\n\t{\n\t\tRK002.DBG(\"queueing EXEC packet\");\n\t\tqueuePck(new RK002.Pck(\"exec_req\",{adr:m_upload_des_adr}));\n\t}\n\t\n\tvar firstMemChunk = function()\n\t{\n\t\tm_retry = 0;\n\t\tenterSubState(SUBSTATE_UPLOAD);\n\t\tqueueMemChunkAndSetTimeout(m_upload_duplex ? DUPLEX_CHUNK_TIMEOUT_MS : SIMPLEX_CHUNK_TIMEOUT_LONG_MS);\n\t}\n\t\n\tvar retryMemChunk = function()\n\t{\n\t\tm_retry ++;\n\t\tif (m_retry < DUPLEX_CHUNK_MAXRETRY)\n\t\t{\n\t\t\tRK002.DBG(\"chunk retry #\"+m_retry);\n\t\t\tqueueMemChunkAndSetTimeout(DUPLEX_CHUNK_TIMEOUT_MS);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tRK002.DBG(\"out of retries\");\n\t\t\tsubEndUpload(\"failed to write memory chunk\",false);\n\t\t}\n\t}\n\t\n\tvar nextMemChunk = function()\n\t{\n\t\tm_retry = 0;\n\t\tm_upload_pos += m_upload_chunksz;\n\t\t\n\t\tif (m_upload_pos < m_upload_data.length)\n\t\t{\n\t\t\tif (m_upload_duplex)\n\t\t\t{\n\t\t\t\tqueueMemChunkAndSetTimeout(DUPLEX_CHUNK_TIMEOUT_MS);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tqueueMemChunkAndSetTimeout( ((m_upload_data_pos & (FLASH_SECTOR_SIZE-1)) == 0) ? SIMPLEX_CHUNK_TIMEOUT_LONG_MS : SIMPLEX_CHUNK_TIMEOUT_SHORT_MS);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//\n\t\t\t// done uploading data\n\t\t\t//\n\t\t\tif (m_upload_duplex)\n\t\t\t{\n\t\t\t\tif (m_upload_mode == UPLOADMODE_LEGACY)\n\t\t\t\t{\n\t\t\t\t\t// execute FWUPD_REQUEST, and expect ACK\n\t\t\t\t\tRK002.DBG(\"queueing UPDATEFW_REQ\");\n\t\t\t\t\tenterSubState(SUBSTATE_EXPECT_LEGACY_UPDATEFW_RSP);\t\t\t\n\t\t\t\t\tqueuePck(new RK002.Pck(\"legacy_updatefw_req\"),DUPLEX_LEGACY_UPDATEFW_RSP_TIMEOUT_MS);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// ask for final checksum:\n\t\t\t\t\tenterSubState(SUBSTATE_EXPECT_UPDATE_FINAL_CRC);\n\t\t\t\t\tqueuePck(new RK002.Pck(\"checksum_req\",{adr:m_upload_des_adr,n:m_upload_data.length}),DUPLEX_CRC_RESP_TIMEOUT_MS);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsubEndUpload(\"upload OK\",true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar subStartUpload = function(txt,data, desadr, mode, duplex)\n\t{\n\t\tuiUpdateSts(0,txt,null,true);\n\t\tm_upload_data = data;\n\t\tm_upload_des_adr = desadr;\n\t\tm_upload_pos = 0;\n\t\tm_upload_mode = mode;\n\t\tm_upload_duplex = duplex;\n\t\tm_upload_chunksz = (m_upload_mode == UPLOADMODE_LEGACY) ? SYX_LEGACY_MEMCHUNKSZ : SYX_MEMCHUNKSZ;\n\t\tfirstMemChunk();\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar subStartGetNmbParamDefs = function()\n\t{\n\t\tm_getparams_idx = 0;\n\t\tm_params = [];\n\t\tenterSubState(SUBSTATE_GET_NMB_PARAMDEFS);\n\t\tqueuePck(new RK002.Pck(\"getnmbparams_req\"),GET_NMB_PARAMS_TIMEOUT_MS);\n\t}\n\t\n\tvar subEndGetParams = function(txt,success)\n\t{\n\t\tRK002.DBG(txt);\n\t\tenterMonitorState(txt,success);\n\t\t/*\n\t\tif (success)\n\t\t{\n\t\t\tRK002.DBG(\"fetched # params = \" + m_params.length);\n\t\t\tfor (var i=0; i<m_params.length; i++)\n\t\t\t{\n\t\t\t\tvar p = m_params[i];\n\t\t\t\t\n\t\t\t\tRK002.DBG(\"param[\"+i+\"] : min=\"+p.min+\", max=\"+p.max+\", def=\"+p.def+\", flags=\"+p.flags+\", lbl=\"+p.lbl);\n\t\t\t}\n\t\t}\n\t\t*/\n\t}\n\t\n\tvar queueFetchGetParamDefReq = function(nr)\n\t{\n\t\tqueuePck(new RK002.Pck(\"getparamdef_req\",{param_nr:nr}), GET_PARAM_TIMEOUT_MS);\n\t}\n\t\n\tvar queueFetchGetParamReq = function(param_nr)\n\t{\n\t\tqueuePck(new RK002.Pck(\"getparam_req\",{nr:param_nr}), GET_PARAM_TIMEOUT_MS);\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar subEndInquiry = function(result,props)\n\t{\n\t\tvar success = (result>0);\n\t\tRK002.DBG(\"subEndInquiry() inquiry_result=\"+result);\n\t\t\n\t\tswitch (m_mainstate)\n\t\t{\n\t\t\tcase MAINSTATE_INQUIRY:\n\t\t\t\tif (m_observer && m_observer.rk002_onInquiryResult)\n\t\t\t\t{\n\t\t\t\t\tm_observer.rk002_onInquiryResult(success,props);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// kick-start the binary again:\n\t\t\t\tqueuePck(new RK002.Pck(\"exec_req\",{adr:APP_FLASHADR}),0);\n\n\t\t\t\tenterMonitorState(success?\"INQUIRY ready\":\"INQUIRY failed\",success);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase MAINSTATE_UNDUINIFY:\n\t\t\t\tswitch (result)\n\t\t\t\t{\n\t\t\t\t\tcase INQUIRY_RESULT_DUY_VALID:\n\t\t\t\t\tcase INQUIRY_RESULT_DUY_INVALID:\n\t\t\t\t\t\tsubStartUpload(\"uploading bootloader\",RK002.boot1,APP_RAMADR,UPLOADMODE_BOOTX,true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\tcase INQUIRY_RESULT_LEGACY_VALID:\n\t\t\t\t\t\tsubStartUpload(\"uploading requested binary\",m_target_data,LEGACY_FLASHADR,UPLOADMODE_LEGACY,true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tenterMonitorState(\"failure inquiring cable\",false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase MAINSTATE_DUINIFY:\n\t\t\t\tswitch (result)\n\t\t\t\t{\n\t\t\t\t\tcase INQUIRY_RESULT_DUY_VALID:\n\t\t\t\t\tcase INQUIRY_RESULT_DUY_INVALID:\n\t\t\t\t\t\tsubStartUpload(\"uploading application\",m_target_data,APP_FLASHADR,UPLOADMODE_BOOTX,true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\tcase INQUIRY_RESULT_LEGACY_VALID:\n\t\t\t\t\t\tsubStartUpload(\"uploading duinifier\",RK002.duinify,LEGACY_FLASHADR,UPLOADMODE_LEGACY,true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tenterMonitorState(\"failure inquiring cable\",false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\tthrow \"ending inquiry in unknown mainstate\";\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar subStartInquiry = function()\n\t{\n\t\tm_retry = 0;\n\t\tenterSubState(SUBSTATE_INQUIRY, INQUIRY_PING_TIMEOUT_MS);\n\t\tqueueInquiryReq();\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar subRK005SoftMode = function(mode)\n\t{\n\t\tif(RK002.rk005){\n\t\t\t// mode= 1 soft on  / 0 = soft off\n\t\t\tvar rk005_softthru_msg = [0xF0, 0x00, 0x21, 0x23, 0x00, 0x05, 0x03, 0x00, 0x01, mode, 0xF7];\n\t\t\t//                                                               |     |     |     |\n\t\t\t//                                                               |     |     |     +-- paramval = 0\n\t\t\t//                                                               |     |     +-------- paramidx = 1 (=DIN_SOFTTHRU)\n\t\t\t//                                                               |     +-------------- MSBs\n\t\t\t//                                                               +-------------------- cmd = SETPARAM\n\t\t\tm_outputdrv.txPck(rk005_softthru_msg);\n\t\t}\n\t}\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar queueInquiryReq = function()\n\t{\n\t\tsubRK005SoftMode(0); //soft thru off\t\n\t\tqueuePck(new RK002.Pck(\"boot0_req\"));\n\t\tqueuePck(new RK002.Pck(\"legacy_inquiry_req\"));\n\t\tqueuePck(new RK002.Pck(\"readmem_req\",{adr:APP_RK002SIZE_ADR}));\n\t\tsetStateTmr(INQUIRY_PING_TIMEOUT_MS);\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar onPck = function(pck)\n\t{\n\t\tif (RK002.dbg_rxtx_pck)\n\t\t{\n\t\t\tRK002.DBG(\"RX: \"+RK002.sysexcodec.pckToString(pck));\n\t\t}\n\t\t\n\t\tswitch (m_substate)\n\t\t{\n\t\t\tcase SUBSTATE_INQUIRY:\n\t\t\t\tif (pck.name == \"checksum_rsp\")\n\t\t\t\t{\n\t\t\t\t\tif (pck.crc32 == APP_CRCVAL)\n\t\t\t\t\t{\n\t\t\t\t\t\t// checksum is OK: continue with fetching INFO data:\n\t\t\t\t\t\tqueuePck(new RK002.Pck(\"readmem_req\",{adr:INQUIRY_INFO_ADR}),INQUIRY_PING_TIMEOUT_MS);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t// checksum failed: maybe due to a aborted flash upload?\n\t\t\t\t\t\t// but we *have* received a CRC answer! -> so BOOT0 is active\n\t\t\t\t\t\tsubEndInquiry(INQUIRY_RESULT_DUY_INVALID,{txt:\"corrupted DUY application loaded on cable (bad crc)\"});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\tif (pck.name == \"readmem_rsp\")\n\t\t\t\t{\n\t\t\t\t\tif (pck.adr == APP_RK002SIZE_ADR)\n\t\t\t\t\t{\n\t\t\t\t\t\t// OK: we received the stored length of the app\n\t\t\t\t\t\tvar app_stored_size = RK002.read_uint32(pck.data,0);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ((app_stored_size > 0) && (app_stored_size < DUY_APP_MAXSIZE))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// now let the bootloader compute the checksum (which should be 0)\n\t\t\t\t\t\t\tqueuePck(new RK002.Pck(\"checksum_req\",{adr:APP_FLASHADR,n:app_stored_size}),INQUIRY_PING_TIMEOUT_MS);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// illegal size\n\t\t\t\t\t\t\tsubEndInquiry(INQUIRY_RESULT_DUY_INVALID,{txt:\"corrupted DUY application loaded on cable (bad size)\"});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\tif ((pck.adr >= INQUIRY_INFO_ADR) && (pck.adr < (INQUIRY_INFO_ADR+INQUIRY_INFO_MAX_SZ)))\n\t\t\t\t\t{\n\t\t\t\t\t\t// OK: we received part of the inquiry info: store it \n\t\t\t\t\t\tfor (var i=0; i<MEMPAGESZ; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tm_inquiry_rsp_mem[i + pck.adr - INQUIRY_INFO_ADR] = pck.data[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// request more info?\n\t\t\t\t\t\tvar nxtadr = pck.adr + MEMPAGESZ;\n\t\t\t\t\t\tif (nxtadr < (INQUIRY_INFO_ADR+INQUIRY_INFO_MAX_SZ))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tqueuePck(new RK002.Pck(\"readmem_req\",{adr:nxtadr}),INQUIRY_PING_TIMEOUT_MS);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar info = new RK002.Info(m_inquiry_rsp_mem);\n\t\t\t\t\t\t\tif (info.magic == 0xCAFEBABE)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tRK002.DBG(\"name    = \"+info.name);\n\t\t\t\t\t\t\t\tRK002.DBG(\"author  = \"+info.author);\n\t\t\t\t\t\t\t\tRK002.DBG(\"date    = \"+info.date);\n\t\t\t\t\t\t\t\tRK002.DBG(\"version = \"+info.version);\n\t\t\t\t\t\t\t\tRK002.DBG(\"guid    = \"+info.guid);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar props = {};\n\t\t\t\t\t\t\t\tprops.is_legacy = false;\n\t\t\t\t\t\t\t\tprops.name = info.name;\n\t\t\t\t\t\t\t\tprops.author = info.author;\n\t\t\t\t\t\t\t\tprops.date = info.date;\n\t\t\t\t\t\t\t\tprops.version = info.version;\n\t\t\t\t\t\t\t\tprops.guid = info.guid;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tsubEndInquiry(INQUIRY_RESULT_DUY_VALID,props);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsubEndInquiry(INQUIRY_RESULT_DUY_INVALID,{txt:\"corrupted DUY application loaded on cable (bad_info)\"});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\tif (pck.name == \"legacy_inquiry_rsp\")\n\t\t\t\t{\n\t\t\t\t\tvar props = {};\n\t\t\t\t\tprops.is_legacy = true;\n\t\t\t\t\tprops.cabletype = pck.cabletype + \" (\" + RK002.cableTypeToString(pck.cabletype)+\")\";\n\t\t\t\t\tprops.version = pck.svnstr;\n\t\t\t\t\tsubEndInquiry(INQUIRY_RESULT_LEGACY_VALID,props);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_UPLOAD:\n\t\t\t\tif ((pck.name == \"legacy_writemem_rsp\") || (pck.name == \"writemem_rsp\"))\n\t\t\t\t{\n\t\t\t\t\tif ((pck.res == 0) && (pck.adr == m_upload_last_queued_flash_adr))\n\t\t\t\t\t{\n\t\t\t\t\t\t// received OK: continue with next chunk\n\t\t\t\t\t\tnextMemChunk();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tRK002.DBG( \"received bad response: res=\" + pck.res + \", adr=0x\" + RK002.uint32hex(pck.adr)\n\t\t\t\t\t\t\t\t+\" (expected:\" + RK002.uint32hex(m_upload_last_queued_flash_adr) + \")\" );\n\t\t\t\t\t\tretryMemChunk();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_UPDATE_FINAL_CRC:\n\t\t\t\tif (pck.name == \"checksum_rsp\")\n\t\t\t\t{\n\t\t\t\t\tvar crc_computed = RK002.crc32(0,m_upload_data,0,m_upload_data.length);\n\t\t\t\t\tvar crc_received = pck.crc32;\n\t\t\t\t\tif (crc_computed == crc_received)\n\t\t\t\t\t{\n\t\t\t\t\t\tRK002.DBG(\"final CRC check is OK\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (m_upload_data == RK002.boot1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// we just uploaded BOOT1 binary:\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// expect boot1 response:\n\t\t\t\t\t\t\tenterSubState(SUBSTATE_EXPECT_BOOT1_RSP);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// start BOOT1:\n\t\t\t\t\t\t\tqueuePck(new RK002.Pck(\"exec_req\",{adr:APP_RAMADR}),0);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// queue BOOT1 ping:\n\t\t\t\t\t\t\tm_retry = 0;\n\t\t\t\t\t\t\t//queuePck(new RK002.Pck(\"boot1_req\"), INQUIRY_PING_TIMEOUT_MS);\n\t\t\t\t\t\t\tsetStateTmr(INQUIRY_PING_TIMEOUT_MS);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (m_upload_des_adr == LEGACY_FLASHADR)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// just uploaded a legacy image through BOOTx protocol:\n\t\t\t\t\t\t\t\tenterSubState(SUBSTATE_EXPECT_JUMP_RSP);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// execute direct JUMP to UPDATEFW routine inside legacy upload:\n\t\t\t\t\t\t\t\tvar fwinstalleradr = RK002.read_uint32(m_upload_data,4*LEGACY_BOOTVECTOR_FWINSTALLER);\n\t\t\t\t\t\t\t\tfwinstalleradr += LEGACY_FLASHADR;\n\t\t\t\t\t\t\t\tRK002.DBG(\"executing jump to FWINSTALLER on legacy image at address 0x\"+RK002.uint32hex(fwinstalleradr));\n\t\t\t\t\t\t\t\tenterSubState(SUBSTATE_EXPECT_JUMP_RSP);\n\t\t\t\t\t\t\t\tqueuePck(new RK002.Pck(\"jump_req\",{adr:fwinstalleradr}),DUPLEX_JUMP_RSP_TIMEOUT_MS);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// execute fresh binary:\n\t\t\t\t\t\t\t\tqueuePck(new RK002.Pck(\"exec_req\",{adr:m_upload_des_adr}),0);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// and we're done\n\t\t\t\t\t\t\t\tsubEndUpload(\"upload OK\",true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tRK002.DBG(\"final CRC check fail (computed=\"+RK002.uint32hex(crc_computed)+\",received=\"+RK002.uint32hex(crc_received)+\")\");\n\t\t\t\t\t\tsubEndUpload(\"final CRC fail\",false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_BOOT1_RSP:\n\t\t\t\tif (pck.name == \"boot1_rsp\")\n\t\t\t\t{\n\t\t\t\t\t// OK: BOOT1 is active now\n\t\t\t\t\tRK002.DBG(\"boot1 is running now\");\n\t\t\t\t\tsubOnBoot1Ready();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_JUMP_RSP:\n\t\t\t\tif (pck.name == \"jump_rsp\")\n\t\t\t\t{\n\t\t\t\t\tif (pck.res == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsubEndUpload(\"upload OK\",true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tRK002.DBG(\"failure: received JUMP1_rsp with result code :\"+pck.res);\n\t\t\t\t\t\tsubEndUpload(\"failed to receive correct response\",false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_LEGACY_UPDATEFW_RSP:\n\t\t\t\tif (pck.name == \"legacy_updatefw_rsp\")\n\t\t\t\t{\n\t\t\t\t\tif (m_mainstate == MAINSTATE_DUINIFY)\n\t\t\t\t\t{\n\t\t\t\t\t\t// start inquiry again:\n\t\t\t\t\t\tsubStartInquiry();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsubEndUpload(\"upload OK\",true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_GET_NMB_PARAMDEFS:\n\t\t\t\tif (pck.name == \"getnmbparams_rsp\")\n\t\t\t\t{\n\t\t\t\t\tm_getparams_n = pck.n;\n\t\t\t\t\tif (m_getparams_n == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t// OK.. we're ready with fetching all param definitions\n\t\t\t\t\t\t// notify the observer:\n\t\t\t\t\t\tif ( (typeof m_observer !== 'undefined')  && (typeof m_observer.rk002_onParamDefsFetched !== 'undefined') ) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tm_observer.rk002_onParamDefsFetched(m_params);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tsubEndGetParams(\"params retreived OK\", true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t// now we're going to fetch the paramdefs\n\t\t\t\t\t\tenterSubState(SUBSTATE_GET_PARAMDEFS);\n\n\t\t\t\t\t\t// queue fetch param:\n\t\t\t\t\t\tqueueFetchGetParamDefReq(m_getparams_idx);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\tcase SUBSTATE_GET_PARAMDEFS:\n\t\t\t\tif (pck.name == \"getparamdef_rsp\")\n\t\t\t\t{\n\t\t\t\t\tif (pck.param_nr == m_getparams_idx)\n\t\t\t\t\t{\n\t\t\t\t\t\t\n\t\t\t\t\t\t// remember param definition:\n\t\t\t\t\t\tif (pck.min & 0x8000)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpck.min -= 65536;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tm_params[m_getparams_idx] = \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnr : m_getparams_idx,\n\t\t\t\t\t\t\t\tmin : pck.min,\n\t\t\t\t\t\t\t\tmax : pck.max,\n\t\t\t\t\t\t\t\tdef : pck.def,\n\t\t\t\t\t\t\t\tflags : pck.flags,\n\t\t\t\t\t\t\t\tlbl : pck.lbl,\n\t\t\t\t\t\t\t\tval : 0,\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tm_getparams_idx++;\n\t\t\t\t\t\tif (m_getparams_idx >= m_getparams_n)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// OK.. we're ready with fetching all param definitions\n\t\t\t\t\t\t\t// notify the observer:\n\t\t\t\t\t\t\tif ( (typeof m_observer !== 'undefined')  && (typeof m_observer.rk002_onParamDefsFetched !== 'undefined') ) \n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tm_observer.rk002_onParamDefsFetched(m_params);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// now we're going to fetch the param values\n\t\t\t\t\t\t\tenterSubState(SUBSTATE_GET_PARAMVALS);\n\t\t\t\t\t\t\tm_getparams_idx = 0;\n\t\t\t\t\t\t\tqueueFetchGetParamReq(m_getparams_idx);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// queue fetch param:\n\t\t\t\t\t\t\tqueueFetchGetParamDefReq(m_getparams_idx);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_GET_PARAMVALS:\n\t\t\t\tif (pck.name == \"getparam_rsp\")\n\t\t\t\t{\n\t\t\t\t\tif (pck.nr == m_getparams_idx)\n\t\t\t\t\t{\n\t\t\t\t\t\tm_params[m_getparams_idx].val = pck.val;\n\t\t\t\t\t\t\n\t\t\t\t\t\tm_getparams_idx++;\n\t\t\t\t\t\tif (m_getparams_idx >= m_getparams_n)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsubEndGetParams(\"params retreived OK\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tqueueFetchGetParamReq(m_getparams_idx);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tif ((pck.name == \"getparam_rsp\") || (pck.name == \"setparam_rsp\"))\n\t\t{\n\t\t\tif ((typeof m_params !== 'undefined') && (pck.nr < m_params.length))\n\t\t\t{\n\t\t\t\tvar val = pck.val;\n\t\t\t\tif (m_params[pck.nr].min < 0)\n\t\t\t\t{\n\t\t\t\t\tif (val & 0x8000)\n\t\t\t\t\t{\n\t\t\t\t\t\tval -= 65536;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// store paramval:\n\t\t\t\tm_params[pck.nr].val = val;\n\t\t\t\t\n\t\t\t\tif ((typeof m_observer !== 'undefined')  && (typeof m_observer.rk002_onParam !== 'undefined'))\n\t\t\t\t{\n\t\t\t\t\tm_observer.rk002_onParam(m_params[pck.nr]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar onStateTmr = function()\n\t{\n\t\tRK002.DBG(\"onStateTmr()\");\n\t\tswitch (m_substate)\n\t\t{\n\t\t\tcase SUBSTATE_MONITOR:\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase SUBSTATE_UPLOAD:\n\t\t\t\tif (m_upload_duplex)\n\t\t\t\t{\n\t\t\t\t\tRK002.DBG(\"timeout expecting duplex ack\");\n\t\t\t\t\tretryMemChunk();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnextMemChunk();\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_JUMP_RSP:\n\t\t\t\tRK002.DBG(\"time-out receiving FWUPDATE response for legacy firmware\");\n\t\t\t\tsubEndUpload(\"timeout waiting for updatefw response\",false);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_UPDATE_FINAL_CRC:\n\t\t\t\tRK002.DBG(\"time-out receiving final CRC check\");\n\t\t\t\tsubEndUpload(\"timeout waiting for final CRC\",false);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_BOOT1_RSP:\n\t\t\t\tm_retry++;\n\t\t\t\tif (m_retry < BOOT1_PING_NMB_RETRIES)\n\t\t\t\t{\n\t\t\t\t\tqueuePck(new RK002.Pck(\"boot1_req\"), INQUIRY_PING_TIMEOUT_MS);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tRK002.DBG(\"time-out receiving BOOT1 rsp\");\n\t\t\t\t\tsubEndUpload(\"timeout waiting for BOOT1 rsp\",false);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase SUBSTATE_INQUIRY:\n\t\t\t\tm_retry++;\n\t\t\t\tif (m_retry < INQUIRY_MAXRETRY)\n\t\t\t\t{\n\t\t\t\t\tqueueInquiryReq();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsubEndInquiry(INQUIRY_RESULT_TIMEOUT,{txt:\"inquiry operation time-out\"});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_EXPECT_LEGACY_UPDATEFW_RSP:\n\t\t\t\tRK002.DBG(\"time-out waiting for legacy updatefw_rsp\");\n\t\t\t\tsubEndUpload(\"timeout waiting for response\",false);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase SUBSTATE_GET_NMB_PARAMDEFS:\n\t\t\tcase SUBSTATE_GET_PARAMDEFS:\n\t\t\tcase SUBSTATE_GET_PARAMVALS:\n\t\t\t\tsubEndGetParams(\"time-out retreiving params\",false);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.startInquiry = function()\n\t{\n\t\tif (m_mainstate > MAINSTATE_MONITOR)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: operation in progress already\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (!m_inputdrv)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: no input driver selected\");\n\t\t\treturn;\n\t\t}\n\t\tuiUpdateSts(0,\"inquiring\",null,true);\n\t\t\n\t\tm_mainstate = MAINSTATE_INQUIRY;\n\t\tsubStartInquiry();\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar dataIsValidLegacyApp = function(data)\n\t{\n\t\tif (data.length < LEGACY_MINSIZE)\n\t\t{\n\t\t\tRK002.DBG(\"dataIsValidLegacyApp(): data.length too small\");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif (data.length > LEGACY_MAXSIZE)\n\t\t{\n\t\t\tRK002.DBG(\"dataIsValidLegacyApp(): data.length too big\");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar stored_size = RK002.read_uint32(data,LEGACY_BOOTVECTOR_BINARYSIZE*4);\n\t\tif (stored_size > data.length)\n\t\t{\n\t\t\tRK002.DBG(\"dataIsValidLegacyApp(): data.length mismatches with vector 62 (stored_size=\"+stored_size+\", data.length=\"+data.length);\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar crc32_readback = RK002.read_uint32(data,LEGACY_BOOTVECTOR_CRC*4);\n\t\tvar crc32_computed = RK002.crc32(0,data,0,stored_size);\n\t\treturn crc32_readback == crc32_computed;\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.unDuinifyData = function(data)\n\t{\n\t\tif (m_mainstate > MAINSTATE_MONITOR)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: operation in progress already\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (!m_inputdrv)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: no input driver selected\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tuiUpdateSts(0,\"unduinifying\",null,true);\n\t\t\n\t\t// is it a legacy image?\n\t\tif (dataIsValidLegacyApp(data))\n\t\t{\n\t\t\t// remember data\n\t\t\tm_target_data = data;\n\t\t\t\n\t\t\t// now start inquirying:\n\t\t\tm_mainstate = MAINSTATE_UNDUINIFY;\n\t\t\tuiUpdateSts(0,\"unduinifying\",null,true);\n\t\t\tsubStartInquiry();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: file is not a valid RK002 binary\");\n\t\t\tuiUpdateSts(100,\"unduinify failed\",null,false);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.unDuinifyFile = function(filename)\n\t{\n\t\tvar req = new XMLHttpRequest();\n\t\treq.open(\"GET\", filename, true);\n\t\treq.responseType = \"arraybuffer\";\n\t\treq.onloadend = function()\n\t\t{\n\t\t\tRK002.DBG(\"req.status=\"+req.status);\n\t\t\t\n\t\t\tif (req.status == 200)\n\t\t\t{\n\t\t\t\t// load OK:\n\t\t\t\tvar data = new Uint8Array(this.response);\n\t\t\t\tRK002.DBG(\"load OK: size=\"+data.length);\n\t\t\t\tself.unDuinifyData(data);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tuiAddConsole(\"ERROR: failed to fetch binary data\");\n\t\t\t\tuiUpdateSts(100,\"unduinify failed\",null,false);\n\t\t\t}\n\t\t}\n\t\treq.send();\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.unDuinifySMF = function(smfdata)\n\t{\n\t\t// data is Uint8Array\n\t\tRK002.DBG(\"decoding MIDI file ! (\"+smfdata.length+\" bytes)\");\n\t\t\n\t\tdecodeSMF(smfdata.buffer);\n\t\t\n\t\tvar flashmem = new Uint8Array(LEGACY_MAXSIZE);\n\t\tvar highest_adr = 0;\n\t\t\n\t\tvar track = midiFile.tracks[0];\n\t\tfor (var j=0;j<track.events.length;j++) \n\t\t{\n\t\t\tvar ev = track.events[j];\n\t\t\t\n\t\t\tconsole.log(\"ev.type=\"+ev.type);\n\n\t\t\tif (ev.type == \"sysex\") \n\t\t\t{\n\t\t\t\tvar d = ev.metaData;\n\t\t\t\t\n\t\t\t\tRK002.DBG(\"SMF: RX:(\"+d.length+\") \"+RK002.dat2hexstr(d));\n\t\t\t\t\n\t\t\t\tvar syxdat = new Uint8Array(d.length);\n\t\t\t\tsyxdat[0] = 0xf0;\n\t\t\t\tfor (var i=0; i<d.length-2; i++)\n\t\t\t\t{\n\t\t\t\t\tsyxdat[1+i] = d[2+i];\n\t\t\t\t}\n\n\t\t\t\tvar pck = RK002.sysexcodec.tryDecode(syxdat);\n\t\t\t\t\n\t\t\t\tif (pck != null)\n\t\t\t\t{\n\t\t\t\t\tRK002.DBG(\"SMF: pck=\"+RK002.sysexcodec.pckToString(pck));\n\t\t\t\t\tif (pck.name == \"legacy_writemem_req\")\n\t\t\t\t\t{\n\t\t\t\t\t\tif ((pck.adr >= LEGACY_FLASHADR) && (pck.adr < (LEGACY_FLASHADR+LEGACY_MAXSIZE)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar adr = pck.adr - LEGACY_FLASHADR;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (var i=0; i<64; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tflashmem[adr++] = pck.data[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (adr > highest_adr)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thighest_adr = adr;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (highest_adr > 0)\n\t\t{\n\t\t\tflashmem = flashmem.slice(0,highest_adr);\n\t\t\tself.unDuinifyData(flashmem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: midifile doesn't contain RK002 firmware\");\n\t\t\tuiUpdateSts(100,\"upload failed\",null,false);\n\t\t}\n\t\t\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tvar dataIsValidDuyApp = function(data)\n\t{\n\t\tif (data.length < DUY_APP_MINSIZE)\n\t\t{\n\t\t\tRK002.DBG(\"dataIsValidDuyApp(): data.length too small\");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif (data.length > DUY_APP_MAXSIZE)\n\t\t{\n\t\t\tRK002.DBG(\"dataIsValidDuyApp(): data.length too big\");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar crc32_computed = RK002.crc32(0,data,0,data.length);\n\t\t\n\t\treturn crc32_computed == APP_CRCVAL;\n\t}\n\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.duinify = function(data)\n\t{\n\t\t// data should be a Uint8Array\n\t\t\n\t\tif (m_mainstate > MAINSTATE_MONITOR)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: operation in progress already\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (!m_inputdrv)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: no input driver selected\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (dataIsValidDuyApp(data))\n\t\t{\n\t\t\t// remember data\n\t\t\tm_target_data = data;\n\t\t\t\n\t\t\t// now start inquirying:\n\t\t\tm_mainstate = MAINSTATE_DUINIFY;\n\t\t\tuiUpdateSts(0,\"duinifying\",null,true);\n\t\t\tsubStartInquiry();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: file is not a valid RK002 binary\");\n\t\t\tuiUpdateSts(100,\"duinify failed\",null,false);\n\t\t}\n\t}\n\t\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.fetchParams = function()\n\t{\n\t\tif (m_mainstate > MAINSTATE_MONITOR)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: operation in progress already\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (!m_inputdrv)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: no input driver selected\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tm_mainstate = MAINSTATE_GETPARAMS;\n\t\tuiUpdateSts(0,\"retreiving prameters\",null,true);\n\t\tsubStartGetNmbParamDefs()\n\t}\n\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.getParamDef = function(param_nr)\n\t{\n\t\tif ((typeof m_params !== 'undefined') && (param_nr < m_params.length))\n\t\t{\n\t\t\treturn m_params[param_nr];\n\t\t}\n\t\t\n\t\treturn null;\n\t}\n\t\t\n\t///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\tthis.setParamVal = function(param_nr, param_val)\n\t{\n\t\tif (m_mainstate > MAINSTATE_MONITOR)\n\t\t{\n\t\t\tuiAddConsole(\"ERROR: operation in progress already\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tqueuePck(new RK002.Pck(\"setparam_req\",{nr:param_nr, val:(param_val&0xffff)}));\n\t}\n}\n\n/* eslint-enable */\n\n// js module\nexport default RK002\n","'use strict'\n\nimport RK002 from '@/assets/js/RK002lib'\n\n// RK002lib Wrapper\nclass RK002MIDIObserver {\n  constructor() {\n    this._midiAccess = null\n    this._pendingPromise = null\n    this._busyErr = new Error(\"Device is busy\")\n    this._midiInputId = null\n    this._midiOutputId = null\n    this._paramsCount = 0\n    this._paramsCountExpected = 1\n\n    this.onParamDefs = null\n    this.onParam = null\n    this.onMidiStateChange = null\n\n    this.rk002 = new RK002.Loader()\n    this.rk002.setObserver(this)\n  }\n\n  // RK002 lib specific part\n\n  rk002_consoleTxt(txt) {\n    console.log(\"rk002_consoleTxt:\", txt)\n    // really bad hack here... because in JS we need to use Promises since ES6\n    if((txt + \"\").toLowerCase().includes('error') && this._pendingPromise !== null) {\n      this._pendingPromise.reject(txt)\n      this._pendingPromise = null\n    }\n  }\n\n  // progress or status bar updates 0 - 100 for long operations\n  rk002_stsUpdate(progress, status, isOk) {\n    console.log(\"rk002_stsUpdate:\", progress, status, isOk)\n  }\n\n  rk002_onEndUpload(txt, isOk, wasLegacy) {\n    console.log(\"rk002_onEndUpload:\", txt, isOk, wasLegacy)\n  }\n\n  rk002_onInquiryResult(isOk, inquiryResults) {\n    if (!this._pendingPromise) return\n\n    if (isOk) {\n      this._pendingPromise.resolve(inquiryResults)\n    } else {\n      this._pendingPromise.reject(\"Error getting inquiry response\")\n    }\n\n    this._pendingPromise = null\n  }\n\n  // called when all parameter definitions are fetched\n  rk002_onParamDefsFetched(params) {\n    this.onParamDefs && this.onParamDefs(params)\n  }\n\n  // called when a parameter-value has changed (or initially fetched)\n  rk002_onParam(param) {\n    this.onParam && this.onParam(param)\n    this._paramsCount++\n    if(this._paramsCount === this._paramsCountExpected && this._pendingPromise) {\n      this._pendingPromise.resolve()\n      this._pendingPromise = null\n    }\n  }\n\n  // RK002 lib specific part END\n\n  _onMidiStateChange(e) {\n    if(e.port.type === \"input\" && !this._allInputs.find(input => input.id === e.port.id)) {\n      // adding new input to cache\n      this._allInputs.push(e.port)\n      if(this._midiInputId === e.port.id) {\n        this.rk002.setInputDriver(e.port)\n      }\n    }\n\n    if(e.port.type === \"output\" && !this._allOutputs.find(output => output.id === e.port.id)) {\n      // adding new input to cache\n      this._allOutputs.push(e.port)\n      if(this._midiOutputId === e.port.id) {\n        this.rk002.setOutputDriver(e.port)\n      }\n    }\n\n    if(this.onMidiStateChange) {\n      const port = { \n        name: e.port.name, \n        id: e.port.id,\n        state: e.port.state,\n        type: e.port.type\n      }\n\n      this.onMidiStateChange(port)\n    }\n  }\n\n  // Async/Await wrappers around RK002 lib\n\n  async initWebMIDI() {\n    this._midiAccess = await navigator.requestMIDIAccess({ sysex: true })\n    this._midiAccess.onstatechange = this._onMidiStateChange.bind(this)\n\n    this._allInputs = Array.from(this._midiAccess.inputs.values())\n    const convertedIns = this._allInputs.map(input => { \n      return { \n        name: input.name, \n        id: input.id,\n        state: input.state\n      } \n    })\n\n    this._allOutputs = Array.from(this._midiAccess.outputs.values())    \n    const convertedOuts = this._allOutputs.map(output => { \n      return { \n        name: output.name, \n        id: output.id,\n        state: output.state\n      } \n    })\n\n    return {\n      inputs: convertedIns,\n      outputs: convertedOuts\n    }\n  }\n\n  setMidiInputId(id) {\n    this._midiInputId = id\n    const inputPort = this._allInputs.find(input => input.id === id)\n\n    if(inputPort) { \n      this.rk002.setInputDriver(inputPort)\n      console.log('Input set:', inputPort)\n      return true\n    } else {\n      console.log('======== INPUT ID NOT FOUND ========')\n      return false\n    }\n  }\n\n  setMidiOutputId(id) {\n    this._midiOutputId = id\n    const outputPort = this._allOutputs.find(output => output.id === id)\n\n    if(outputPort) { \n      this.rk002.setOutputDriver(outputPort)\n      console.log('Output set:', outputPort)\n      return true\n    } else {\n      console.log('======== OUTPUT ID NOT FOUND ========')\n      return false\n    }\n  }\n\n  inquiryDevice() {\n    return new Promise((resolve, reject) => {\n      if (this._pendingPromise) return reject(this._busyErr)\n\n      this._pendingPromise = { resolve, reject }\n      this.rk002.startInquiry()\n    })\n  }\n\n  fetchParameters() {\n    return new Promise((resolve, reject) => {\n      if (this._pendingPromise) return reject(this._busyErr)\n      this._pendingPromise = { resolve, reject }\n      this._paramsCount = 0 \n      this._paramsCountExpected = 32     \n      this.rk002.fetchParams()\n    })\n  }\n\n  async sendParameterValues(paramValues) {\n    if (this._pendingPromise) throw this._busyErr\n\n    for (let [ind, val] of paramValues.entries()) {\n      if (val > 65535 || val < 0) throw new Error('Parameter value should be from 0 to 65535')\n      await this.sendParameter(ind, val)\n    }\n  }\n\n  sendParameter(index, value) {\n    return new Promise((resolve, reject) => {\n      if (this._pendingPromise) return reject(this._busyErr)\n      this._pendingPromise = { resolve, reject }\n      this._paramsCount = 0 \n      this._paramsCountExpected = 1  \n      this.rk002.setParamVal(index, value)\n    })\n  }\n}\n\nexport default RK002MIDIObserver","export default class SequencerAction {\n  constructor(options) {\n    let actionTypeId = -1\n    let byte1, byte2 = 0\n\n    if(typeof options === 'object') {\n      actionTypeId = options.actionTypeId\n    } else if(!isNaN(options)) {\n      // Split 16bit value in two 8 bit values\n      byte1 = options & 0xFF\n      byte2 = options >> 8\n      // Action, 3 MSBs of the 2nd byte\n      actionTypeId = (byte2 & 0b11100000) >> 5\n    } else {\n      throw new Error(`Wrong constructor arguments for SequencerAction class ${ options }`)\n    }\n\n    // type defaults\n    this.actionTypeId = actionTypeId\n    switch (actionTypeId) {\n      case SequencerAction.Type.SwitchSession: {\n        this.valid = false\n        this.title = \"Switch Session\"\n        this.hint = \"Switch session to session number\"\n        this.color = \"primary\"\n        this.icon = \"mdi-skip-next-circle-outline\"\n        this.sessionIndex = 0\n        this.nextActionOnBeat = 4\n        break\n      }\n\n      case SequencerAction.Type.LoopSessions: {\n        this.valid = false\n        this.title = \"Loop Sessions\"\n        this.hint = \"Loop sessions from session number to session number\"\n        this.color = \"indigo\"\n        this.icon = \"mdi-restore\"\n        this.startSessionIndex = 0\n        this.endSessionIndex = 7\n        this.repeats = 4\n        break\n      }\n\n      case SequencerAction.Type.LoopActions: {\n        this.valid = false\n        this.title = \"Loop Actions\"\n        this.hint = \"Loop actions from action number to action number\",\n        this.color = \"cyan\",\n        this.icon = \"mdi-restore\",\n        this.startActionIndex = 0,\n        this.endActionIndex = 3,\n        this.repeats = 4\n        break\n      }\n\n      case SequencerAction.Type.JumpToAction: {\n        this.valid = false\n        this.title = \"Jump to Action\",\n        this.hint = \"Jump to action number\",\n        this.color = \"orange\",\n        this.icon = \"mdi-debug-step-over\",\n        this.toActionIndex = 0\n        break\n      }\n\n      case SequencerAction.Type.StopSequence: {\n        this.valid = true, // nothing to check here\n        this.title = \"Stop Sequence\",\n        this.hint = 'Stop sequencer. Circuit will play last loaded session.',\n        this.color = \"pink\",\n        this.icon = \"mdi-stop-circle-outline\"\n        break\n      }\n\n      default: {\n        throw new Error('Empty sequencer slot or undefined action type')\n      }\n    }\n\n    if(typeof options === 'object') {\n      // overriding defaults here\n      Object.assign(this, options)\n      return\n    }\n\n    // parsing the rest here, except stop action - it has only action type, that was already parsed above\n    switch (actionTypeId) {\n      case SequencerAction.Type.SwitchSession: {\n        // Session index 0 - 31, 5 LSBs of the 2nd byte\n        this.sessionIndex = byte2 & 0b00011111\n        this.nextActionOnBeat = byte1\n        break\n      }\n\n      case SequencerAction.Type.LoopSessions: {\n        this.startSessionIndex = byte2 & 0b00011111\n        this.endSessionIndex = byte1 & 0b00011111\n        this.repeats = (byte1 & 0b11100000) >> 5\n        break\n      }\n\n      case SequencerAction.Type.LoopActions: {\n        // TODO: not implemented\n        this.startActionIndex = 0,\n        this.endActionIndex = 3,\n        this.repeats = 4\n        break\n      }\n\n      case SequencerAction.Type.JumpToAction: {\n        this.toActionIndex = byte2 & 0b00011111\n        break\n      }\n    }\n  }\n\n  static Type = {\n    SwitchSession: 1,\n    LoopSessions: 3,\n    LoopActions: 4,\n    JumpToAction: 5,\n    StopSequence: 2\n    // 6 - reserved,\n    // 7 - reserved\n  }\n\n  getUserParamValue() {\n    let paramValue = 0 // 16 bit word\n\n    switch (this.actionTypeId) {\n      case SequencerAction.Type.SwitchSession: {\n        // Session index 0 - 31, 5 LSBs of the 2nd byte\n        paramValue = this.actionTypeId << 5\n        paramValue = (paramValue | this.sessionIndex) << 8\n        paramValue = paramValue | this.nextActionOnBeat\n        break\n      }\n\n      case SequencerAction.Type.LoopSessions: {\n        paramValue = this.actionTypeId << 5\n        paramValue = (paramValue | this.startSessionIndex) << 8\n        paramValue = paramValue | (this.repeats << 5)\n        paramValue = paramValue | this.endSessionIndex\n        break\n      }\n\n      case SequencerAction.Type.LoopActions: {\n        // TODO: not implemented\n        // this.startActionIndex = 0,\n        // this.endActionIndex = 3,\n        // this.repeats = 4\n        break\n      }\n\n      case SequencerAction.Type.JumpToAction: {\n        paramValue = this.actionTypeId << 5\n        // 0 - 29, 2 last parameters reserved for config\n        paramValue = (paramValue | this.toActionIndex) << 8\n        break\n      }\n\n      case SequencerAction.Type.StopSequence: {\n        paramValue = this.actionTypeId << 13 // 8 + 5\n        break\n      }\n    }\n\n    return paramValue\n  }\n\n  clone() {\n    return new SequencerAction(Object.assign({} , this))\n  }\n}","import Vue from 'vue'\nimport Vuex from 'vuex'\n// @ - is an alias for src folder here\nimport RK002MIDIObserver from '@/assets/js/rk002-wrapper'\nimport SequencerAction from '@/assets/js/sequencer-action'\n\nVue.use(Vuex)\nconst midiObserver = new RK002MIDIObserver()\n\nexport default new Vuex.Store({\n  state: {\n    errorMessage: '',\n    activeActionIndex: null,\n    sequence: new Array(30).fill(null),\n    expectedFirmwareGUID: \"c1825f6a-45fd-4ccc-b470-e3064ee4f94f\",\n    expectedFirmwareVersion: \"1.0\",\n    commInProcess: false,\n    firmwareInfo: null,\n    midiInputsAndOutputs: null,\n    selectedMidiInputId: localStorage.selectedMidiInputId || -1,\n    selectedMidiOutputId: localStorage.selectedMidiOutputId || -1,\n    rawDeviceData: new Array(32).fill(null),\n    actionTypes: [\n      new SequencerAction({\n        actionTypeId: SequencerAction.Type.SwitchSession,\n        sessionIndex: 0,\n        nextActionOnBeat: 4,\n        valid: true\n      }),\n      new SequencerAction({\n        actionTypeId: SequencerAction.Type.LoopSessions,\n        startSessionIndex: 0,\n        endSessionIndex: 7,\n        repeats: 3,\n        valid: true\n      }),\n      new SequencerAction({\n        actionTypeId: SequencerAction.Type.LoopActions,\n        startActionIndex: 0,\n        endActionIndex: 3,\n        repeats: 3,\n        valid: true\n      }),\n      new SequencerAction({\n        actionTypeId: SequencerAction.Type.JumpToAction,\n        toActionIndex: 0\n      }),\n      new SequencerAction({\n        actionTypeId: SequencerAction.Type.StopSequence,\n      })\n    ],\n  },\n  getters: {\n    connected: function(state) {\n      if(!state.midiInputsAndOutputs) return false\n\n      const input = state.midiInputsAndOutputs.inputs.find(input => input.id === state.selectedMidiInputId)\n      const output = state.midiInputsAndOutputs.outputs.find(output => output.id === state.selectedMidiOutputId)\n\n      return state.firmwareInfo &&\n        input &&\n        output &&\n        input.state === \"connected\" &&\n        output.state === \"connected\"\n    },\n    commDisabled: function(state, getters) {\n      return !getters.connected ||\n        state.commInProcess ||\n        !state.firmwareInfo || \n        state.firmwareInfo.version !== state.expectedFirmwareVersion || \n        state.firmwareInfo.guid !== state.expectedFirmwareGUID\n    },\n    midiInputs: function(state) {\n      if(state.midiInputsAndOutputs === null) return []\n      return state.midiInputsAndOutputs.inputs.map(input => { \n        return { \n          text: input.name, \n          value: input.id,\n          disabled: input.state === \"disconnected\"\n        } \n      })\n    },\n    midiOutputs: function(state) {\n      if(state.midiInputsAndOutputs === null) return []\n      return state.midiInputsAndOutputs.outputs.map(output => { \n        return { \n          text: output.name, \n          value: output.id,\n          disabled: output.state === \"disconnected\"\n        } \n      })\n    }, \n    sequenceValid: state => () => { \n      // returning function here to avoid caching https://forum.vuejs.org/t/vuex-getter-not-re-evaluating-return-cached-data/55697/4    \n      // Is sequence empty\n      if(state.sequence.filter(action => action === null).length === state.sequence.length) {\n        state.errorMessage = 'Sequence is empty'\n        return false\n      }\n\n      // Is first slot present\n      if(state.sequence[0] === null) { \n        state.errorMessage = 'First sequencer slot can\\'t be empty'\n        return false\n      }\n\n      // Is every action valid\n      if(state.sequence.filter(action => action && action.valid === false).length !== 0) {\n        state.errorMessage = 'Some of the sequencer actions are not valid'\n        return false\n      }\n\n      // Checking sequence logic (some of the logic for now)\n      let hadNullSequenceEntry = false\n      for (let index = 0; index < state.sequence.length; index++) {\n        const sequenceAction = state.sequence[index]\n        if(sequenceAction === null) hadNullSequenceEntry = true\n        if(sequenceAction !== null && hadNullSequenceEntry) {\n          state.errorMessage = 'Sequence have empty slots between actions'\n          return false\n        }\n        \n        if(sequenceAction !== null) {\n          switch(sequenceAction.actionTypeId) {\n            case 3: {\n              // loop sessions\n              if(sequenceAction.startSessionIndex === sequenceAction.endSessionIndex) {\n                state.errorMessage = `Loop Sessions action #${index+1} can't have equal From - To sessions`\n                return false\n              }\n            }\n          }\n        }\n      }\n\n      return true\n    }\n  },\n  mutations: {\n    setMidiInputsAndOutputs(state, value) {\n      state.midiInputsAndOutputs = value\n    },\n    addMidiInputPort(state, value) {\n      state.midiInputsAndOutputs.inputs.push(value)\n    },\n    addMidiOutputPort(state, value) {\n      state.midiInputsAndOutputs.outputs.push(value)\n    },\n    setSelectedMidiInputId(state, value) {\n      localStorage.selectedMidiInputId = value\n      state.selectedMidiInputId = value\n      midiObserver.setMidiInputId(value)\n    },\n    setSelectedMidiOutputId(state, value) {\n      localStorage.selectedMidiOutputId = value\n      state.selectedMidiOutputId = value\n      midiObserver.setMidiOutputId(value)\n    },\n    setActiveActionIndex(state, value) {\n      state.activeActionIndex = value\n    },\n    setCommInProcess(state, value) {\n      state.commInProcess = value\n    },\n    setFirmwareInfo(state, value) {\n      state.firmwareInfo = value\n    },\n    setRawDeviceDataEntry(state, value) {\n      // Object.freeze prevents Vue of adding 'reactivity'\n      let entry = Object.assign({}, value)\n      state.rawDeviceData[value.nr] = Object.freeze(entry)\n    },\n    clearSequenceActionAt(state, actionIndex) {\n      Vue.set(state.sequence, actionIndex, null)\n    },\n    addSequenceActionAt(state, args) {\n      // adding new action from the list\n      const actionType = state.actionTypes.find(entry => entry.actionTypeId === args.actionTypeId)\n      Vue.set(state.sequence, args.actionIndex, actionType.clone())\n    },\n    setSequencerActionAt(state, args) {\n      // adding new action from loaded from the device\n      Vue.set(state.sequence, args.actionIndex, args.newValue)\n    },\n    modifySequenceActionAt(state, args) {\n      const sequenceEntry = state.sequence[args.actionIndex]\n      const newValue = args.newValue\n\n      for (const [key, value] of Object.entries(newValue)) {\n        if(sequenceEntry[key] != value) {\n          sequenceEntry[key] = value\n        }\n      }\n    },\n    setErrorMessage(state, message) {\n      state.errorMessage = message\n    }\n  },\n  actions: {\n    initWebMIDI: async function({ commit, dispatch }) {\n      if(!midiObserver.onMidiStateChange)\n        midiObserver.onMidiStateChange = port => dispatch('onMidiStateChange', port)\n      \n      const midiInputsAndOutputs = await midiObserver.initWebMIDI()\n      commit('setMidiInputsAndOutputs', midiInputsAndOutputs)\n\n      // Restoring settings from the browser's storage\n      if(localStorage.selectedMidiInputId) {\n        midiObserver.setMidiInputId(localStorage.selectedMidiInputId)\n        commit('setSelectedMidiInputId', localStorage.selectedMidiInputId)    \n      }\n\n      if(localStorage.selectedMidiOutputId) {\n        midiObserver.setMidiOutputId(localStorage.selectedMidiOutputId)\n        commit('setSelectedMidiOutputId', localStorage.selectedMidiOutputId)   \n      }\n    },\n    onMidiStateChange: function ({ state, commit, dispatch }, port) {\n      if (port.type === \"input\") {\n        const item = state.midiInputsAndOutputs.inputs.find(item => item.id === port.id)\n        if (item) {\n          // existing input port\n          item.state = port.state\n          if (item.id === state.selectedMidiInputId) {\n            if (item.state === \"disconnected\") state.firmwareInfo = null\n            else dispatch('tryToConnect')\n          }\n        } else {\n          // new input port\n          commit('addMidiInputPort', port)\n          dispatch('tryToConnect')\n        }\n      } else if (port.type === \"output\") {\n        const item = state.midiInputsAndOutputs.outputs.find(item => item.id === port.id)\n        if (item) {\n          // existing output port\n          item.state = port.state\n          if (item.id === state.selectedMidiOutputId) {\n            if (item.state === \"disconnected\") state.firmwareInfo = null\n            else dispatch('tryToConnect')\n          }\n        } else {\n          // new output port\n          commit('addMidiOutputPort', port)\n          dispatch('tryToConnect')\n        }\n      }\n    },\n    fetchParameters: async function({ commit }) {\n      if(!midiObserver.onParam)\n        midiObserver.onParam = param => commit('setRawDeviceDataEntry', param)\n\n      commit('setCommInProcess', true)\n      let error = null\n\n      try {\n        await midiObserver.fetchParameters() // we are getting callback with results from onParamChanged\n      } catch(err) {\n        error = err\n      }\n\n      commit('setCommInProcess', false)\n      if(error) throw error\n    },\n    parseAndLoadSequence: function({ state, commit }) {\n      if(!state.rawDeviceData || state.rawDeviceData.filter(entry => entry === null).length !== 0)\n        throw new Error('Raw data is not loaded from the RK002 yet')\n\n      for (let param of state.rawDeviceData) {\n        let action = null\n        if(param.nr <= 29) {\n          try {\n            action = new SequencerAction(param.val)\n            action.valid = true\n          } catch(err) {\n            // this isn't really an error here, \n            // constructor will throw an error in case if action type is undefined or sequencer slot is empty\n            console.log(param, err) \n          }\n\n          commit('setSequencerActionAt', { \n            actionIndex: param.nr,\n            newValue: action\n          })\n        } else {\n          // TODO: process config params here, if needed\n        }\n      }\n    },\n    parseAndUploadSequence: async function({ state, getters, commit }) {\n      if(!state.commInProcess && getters.sequenceValid()) {\n        commit('setCommInProcess', true)\n\n        const paramValues = state.sequence.map(entry => entry ? entry.getUserParamValue() : 0)\n        paramValues.push(0, 0) // TODO: push two 16 bit config params here\n\n        try {\n          await midiObserver.sendParameterValues(paramValues)\n        } catch(err) {\n          console.error(err)\n          commit('setErrorMessage', 'Error sending sequence to the RK002')\n        }\n\n        commit('setCommInProcess', false)\n      }\n    },\n    tryToConnect: async function({ state, commit, getters }) {\n      // probably good idea to add debounce timeout here, \n      // because we have a bunch of events for new added devices in case when we connecting RK006\n      if(state.selectedMidiInputId !== -1 && \n        state.selectedMidiOutputId !== -1 && \n        !getters.commInProcess) {\n\n        commit('setCommInProcess', true)\n        commit('setFirmwareInfo', null)\n        try {\n          const firmwareInfo = await midiObserver.inquiryDevice()\n          commit('setFirmwareInfo', firmwareInfo)\n        } catch (err) {\n          console.error(\"tryToConnect error:\", err)\n        }\n\n        commit('setCommInProcess', false)\n      }\n    },\n  }  \n})","import Vue from 'vue'\nimport App from './App.vue'\nimport vuetify from './plugins/vuetify'\nimport store from '../store'\n\nVue.config.productionTip = false\n\nnew Vue({\n  vuetify,\n  store,\n  render: h => h(App)\n}).$mount('#app')\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sequencer-simulator.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}