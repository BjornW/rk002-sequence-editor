(function(e){function t(t){for(var i,s,o=t[0],c=t[1],u=t[2],l=0,p=[];l<o.length;l++)s=o[l],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&p.push(r[s][0]),r[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},r={app:0},a=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/rk002-sequence-editor/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"3b75":function(e,t,n){"use strict";n("c5f9")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"rk002-sequence-editor"}},[n("v-app-bar",{attrs:{app:"",flat:""}},[n("v-toolbar-title",{staticStyle:{"min-width":"150px"}},[n("a",{staticClass:"title-link",attrs:{href:"/"}},[e._v("LENSFLARE.DEV")])]),n("v-tabs",{staticClass:"ml-2 mr-2",attrs:{color:"grey darken-1"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.links,(function(t){return n("v-tab",{key:t.title,attrs:{href:t.url}},[e._v(" "+e._s(t.title)+" ")])})),1),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mr-1",attrs:{icon:"",outlined:"",rounded:"",disabled:e.commDisabled},on:{click:e.onDownloadClick}},"v-btn",r,!1),i),[n("v-icon",[e._v("mdi-arrow-down-bold")])],1)]}}])},[n("span",[e._v("Download sequence from RK002")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mr-1",attrs:{icon:"",outlined:"",rounded:"",disabled:e.commDisabled},on:{click:e.parseAndUploadSequence}},"v-btn",r,!1),i),[n("v-icon",[e._v("mdi-arrow-up-bold")])],1)]}}])},[n("span",[e._v("Upload sequence to RK002")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mr-1",attrs:{icon:"",outlined:"",rounded:""},on:{click:function(t){t.stopPropagation(),e.configDialog=!0}}},"v-btn",r,!1),i),[n("v-icon",[e._v("mdi-cog")])],1)]}}])},[n("span",[e._v("MIDI Configuration")])])],1),n("v-main",[n("v-container",[n("v-row",[n("v-col",{staticClass:"d-flex justify-end align-start",attrs:{cols:"3",md:"4",lg:"3"}},[n("SequencerSimulator")],1),n("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"6",md:"6",lg:"6"}},[n("v-sheet",{staticStyle:{width:"100%"},attrs:{rounded:"lg"}},[n("v-container",[n("h3",{staticClass:"text-center"},[e._v("Action Sequencer")]),n("v-row",{attrs:{dense:""}},[n("v-col",e._l(e.sequence,(function(e,t){return n("SequenceEntry",{key:t,class:0!=t?"mt-3":"",attrs:{"action-index":t}})})),1)],1)],1)],1)],1),n("v-col",{staticClass:"d-flex justify-start align-start",attrs:{cols:"3",md:"2",lg:"3"}},[n("v-sheet",{staticClass:"sheets-fixed",attrs:{rounded:"lg","max-width":"175px","min-width":"175px"}},[n("v-container",[n("h3",{staticClass:"text-center"},[e._v("Actions")]),n("p",{staticClass:"text--disabled text-center mb-0"},[e._v(" Drop me to the slot: ")]),e._l(e.actionTypes,(function(t,i){return n("v-row",{key:i,attrs:{dense:""}},[n("v-chip",{key:i,staticClass:"action-chips ma-2",attrs:{disabled:4===t.actionTypeId,color:t.color,"input-value":!0,filter:"","filter-icon":t.icon,draggable:""},on:{dragstart:function(n){return e.onChipDragStart(n,t)},mouseenter:function(n){return e.onChipMouseEnter(t)},mouseleave:e.onChipMouseLeave}},[e._v(" "+e._s(t.title)+" ")])],1)}))],2)],1)],1)],1)],1)],1),n("v-snackbar",{attrs:{timeout:1e4,color:e.snackbarColor},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.attrs;return[n("v-btn",e._b({attrs:{color:"white",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",i,!1),[e._v(" Close ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")]),n("v-footer",{attrs:{inset:"",app:""}},[e._v(e._s(e.statusBarText))]),n("v-dialog",{attrs:{"max-width":"600"},model:{value:e.configDialog,callback:function(t){e.configDialog=t},expression:"configDialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v("MIDI Configuration")])]),n("v-card-text",{staticClass:"pb-0"},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-select",{attrs:{disabled:e.commInProcess,items:e.midiInputs,label:"Input (Orange connector)",required:"",outlined:"",dense:""},model:{value:e.midiInputId,callback:function(t){e.midiInputId=t},expression:"midiInputId"}})],1),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-select",{attrs:{disabled:e.commInProcess,items:e.midiOutputs,label:"Output (Black connector)",required:"",outlined:"",dense:""},model:{value:e.midiOutputId,callback:function(t){e.midiOutputId=t},expression:"midiOutputId"}})],1)],1),e.firmwareInfo?n("v-row",[n("small",{staticClass:"font-weight-bold"},[e._v(e._s(e.firmwareInfo.name)+" v"+e._s(e.firmwareInfo.version))])]):e._e(),e.firmwareInfo?n("v-row",[n("small",{staticClass:"font-weight-bold"},[e._v(e._s(e.firmwareInfo.author))])]):e._e()],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",disabled:e.commInProcess},on:{click:e.tryToConnect}},[e._v(" Connect ")]),n("v-btn",{attrs:{color:"default"},on:{click:function(t){e.configDialog=!1}}},[e._v(" Close ")])],1)],1)],1),n("v-dialog",{attrs:{"max-width":"320"},model:{value:e.overwriteDialog,callback:function(t){e.overwriteDialog=t},expression:"overwriteDialog"}},[n("v-card",[n("v-card-title",[e._v(" Replace current sequence? ")]),n("v-card-text",[e._v(" Your current sequence is not empty. "),n("br"),e._v("Do you want to replace current sequence with loaded from the RK002? ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary"},on:{click:e.onReplace}},[e._v(" Replace ")]),n("v-btn",{on:{click:function(t){e.overwriteDialog=!1}}},[e._v(" Cancel ")])],1)],1)],1)],1)},a=[],s=(n("4de4"),n("d3b7"),n("96cf"),n("1da1")),o=n("5530"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-sheet",{staticClass:"sheets-fixed",attrs:{rounded:"lg","min-width":"305","max-width":"305"}},[n("v-container",[n("h3",{staticClass:"text-center"},[e._v("Simulator")]),n("p",{staticClass:"text--disabled text-center mb-0"},[e._v("Circuit sessions 1 - 32")]),e._l(4,(function(t){return n("v-row",{key:t,staticClass:"ma-1"},[e._l(8,(function(i){return n("v-col",{key:i,staticClass:"pa-1 ma-0"},[n("v-sheet",{staticClass:"text-center",attrs:{rounded:"lg",color:e.currentSessionPadIndex===8*(t-1)+i-1?"blue":"deep-purple darken-3"}},[n("span",{staticClass:"ma-1"},[e._v(" "+e._s(8*(t-1)+i)+" ")])])],1)}))],2)})),n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-item-group",{staticClass:"v-btn-toggle"},[n("v-btn",{attrs:{color:null!==e.timer?"primary":""},on:{click:e.onPlayStop}},[n("v-icon",[e._v(e._s(null!==e.timer?"mdi-stop-circle-outline":"mdi-play-circle-outline"))])],1),n("v-btn",[n("v-progress-circular",{staticClass:"no-transition",attrs:{value:e.currentActionProgress}},[e._v(e._s(e.beatsTotal-e.beatsUntilNextAction+1))])],1),n("v-btn",{on:{click:e.onNext}},[n("v-icon",[e._v("mdi-skip-next")])],1)],1)],1)],2)],1)},u=[],d=n("2f62"),l={data:function(){return{audio:new Audio("tick.mp3"),currentSessionPadIndex:null,timer:null,beatsUntilNextAction:0,beatsTotal:0,loopingSessionsRepeats:null}},computed:Object(o["a"])(Object(o["a"])({currentActionProgress:function(){return 0===this.beatsTotal?0:(this.beatsTotal-this.beatsUntilNextAction+1)/this.beatsTotal*100}},Object(d["e"])(["sequence","activeActionIndex"])),Object(d["c"])(["sequenceValid"])),methods:Object(o["a"])({onPlayStop:function(){this.timer?this.stopSequencer():this.sequenceValid()&&(this.stopSequencer(),this.audio.play(),this.processNextSequencerAction(),this.timer=setInterval(this.onTimer,500))},onNext:function(){this.timer&&this.stopSequencer(),this.sequenceValid()&&(null!==this.loopingSessionsRepeats?this.processNextSequencerAction(!1):this.processNextSequencerAction())},onTimer:function(){if(this.audio.play(),this.sequenceValid()){if(this.beatsUntilNextAction--,0===this.beatsUntilNextAction){if(null!==this.loopingSessionsRepeats)return void this.processNextSequencerAction(!1);this.processNextSequencerAction()}}else this.stopSequencer()},stopSequencer:function(){clearInterval(this.timer),this.timer=null,this.setActiveActionIndex(null),this.currentSessionPadIndex=null,this.loopingSessionsRepeats=null,this.beatsUntilNextAction=0,this.beatsTotal=0},processNextSequencerAction:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===this.activeActionIndex)this.setActiveActionIndex(0);else{if(this.activeActionIndex>29||this.activeActionIndex<0)return void this.stopSequencer();e&&this.setActiveActionIndex(this.activeActionIndex+1)}var t=this.sequence[this.activeActionIndex];if(null!==t)switch(t.actionTypeId){case 1:this.currentSessionPadIndex=t.sessionIndex,this.beatsUntilNextAction=t.nextActionOnBeat,this.beatsTotal=t.nextActionOnBeat;break;case 2:this.stopSequencer();break;case 3:if(null===this.loopingSessionsRepeats)this.loopingSessionsRepeats=t.repeats+1,this.currentSessionPadIndex=t.startSessionIndex;else if(this.currentSessionPadIndex===t.endSessionIndex?(this.loopingSessionsRepeats--,this.loopingSessionsRepeats>0&&(this.currentSessionPadIndex=t.startSessionIndex)):t.startSessionIndex<=t.endSessionIndex?this.currentSessionPadIndex++:this.currentSessionPadIndex--,this.loopingSessionsRepeats<=0)return this.loopingSessionsRepeats=null,void this.processNextSequencerAction();this.beatsUntilNextAction=32,this.beatsTotal=32;break;case 4:this.setErrorMessage("Loop Actions is not supported at the moment"),this.stopSequencer();break;case 5:this.setActiveActionIndex(t.toActionIndex),this.processNextSequencerAction(!1);break;default:this.stopSequencer();break}else this.stopSequencer()}},Object(d["d"])(["setActiveActionIndex","setErrorMessage"]))},p=l,m=(n("e869"),n("2877")),f=n("6544"),h=n.n(f),v=n("8336"),b=n("62ad"),g=n("a523"),y=n("132d"),x=n("604c"),I=n("490a"),_=n("0fd9"),k=n("8dd9"),w=Object(m["a"])(p,c,u,!1,null,null,null),S=w.exports;h()(w,{VBtn:v["a"],VCol:b["a"],VContainer:g["a"],VIcon:y["a"],VItemGroup:x["b"],VProgressCircular:I["a"],VRow:_["a"],VSheet:k["a"]});var A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{class:e.colorClass,attrs:{elevation:"2",outlined:"",shaped:""},on:{dragenter:e.onCheckDrop,dragover:e.onCheckDrop,drop:function(t){return t.preventDefault(),e.onChipDrop(t)}}},[null===e.action?n("v-chip",{staticClass:"ml-3 mt-3 text--disabled",attrs:{outlined:""}},[e._v("Empty slot")]):n("v-chip",{staticClass:"ml-3 mt-3",attrs:{color:e.action.color,close:""},on:{"click:close":e.onChipClose}},[e._v(e._s(e.action.title))]),n("div",{staticClass:"float-right ma-4 text--secondary"},[e._v("# "+e._s(e.actionIndex+1))]),null===e.action?n("v-card-subtitle",[e._v("Add new action by dropping here an action type from the list")]):e._e(),null!==e.action&&1===e.action.actionTypeId?n("ActionFormSwitchSession",{attrs:{action:e.action}}):e._e(),null!==e.action&&2===e.action.actionTypeId?n("ActionFormStop",{attrs:{action:e.action}}):e._e(),null!==e.action&&3===e.action.actionTypeId?n("ActionFormLoopSessions",{attrs:{action:e.action}}):e._e(),null!==e.action&&4===e.action.actionTypeId?n("ActionFormLoopActions",{attrs:{action:e.action}}):e._e(),null!==e.action&&5===e.action.actionTypeId?n("ActionFormJump",{attrs:{action:e.action,actionIndex:e.actionIndex}}):e._e()],1)},O=[],q=(n("caad"),n("a9e3"),n("2532"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[e.action?n("v-form",{model:{value:e.action.valid,callback:function(t){e.$set(e.action,"valid",t)},expression:"action.valid"}},[n("v-container",{staticClass:"pt-0 pb-0"},[n("v-row",[n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.sessionRules,label:"Session number",required:"",outlined:"",dense:""},model:{value:e.sessionNumber,callback:function(t){e.sessionNumber=t},expression:"sessionNumber"}})],1),n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.beatsRules,label:"Next action on beat",required:"",outlined:"",dense:""},model:{value:e.beatsCount,callback:function(t){e.beatsCount=t},expression:"beatsCount"}})],1)],1)],1)],1):e._e()],1)}),C=[],D=(n("8ba4"),n("9129"),{props:{action:{type:Object,required:!0}},data:function(){return{sessionNumber:1,beatsCount:4,sessionRules:[function(e){return!!e||"Session number is required"},function(e){if(Number.isNaN(e)||!Number.isInteger(Number(e)))return"Please enter integer value";var t=Number(e);return t<=32&&t>=1||"Session number must be between 1 and 32"}],beatsRules:[function(e){return!!e||"Beats counter is required"},function(e){if(Number.isNaN(e)||!Number.isInteger(Number(e)))return"Please enter integer value";var t=Number(e);return t<=255&&t>=1||"Beats must be between 1 and 255"}]}},watch:{sessionNumber:function(e){this.action&&(this.action.sessionIndex=Number(e)-1)},beatsCount:function(e){this.action&&(this.action.nextActionOnBeat=Number(e))}},computed:Object(d["e"])(["sequence"]),mounted:function(){this.$nextTick((function(){this.sessionNumber=this.action.sessionIndex+1,this.beatsCount=this.action.nextActionOnBeat}))}}),T=D,R=n("99d9"),P=n("4bd4"),N=n("8654"),M=Object(m["a"])(T,q,C,!1,null,null,null),E=M.exports;h()(M,{VCardText:R["c"],VCol:b["a"],VContainer:g["a"],VForm:P["a"],VRow:_["a"],VTextField:N["a"]});var V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-subtitle",[e._v(" Sequencer will stop here ")])},j=[],B={props:{action:{type:Object,required:!0}}},F=B,U=Object(m["a"])(F,V,j,!1,null,null,null),L=U.exports;h()(U,{VCardSubtitle:R["b"]});var G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[e.action?n("v-form",{model:{value:e.action.valid,callback:function(t){e.$set(e.action,"valid",t)},expression:"action.valid"}},[n("v-container",{staticClass:"pt-0 pb-0"},[n("v-row",[n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.sessionRules,label:"From session number",required:"",outlined:"",dense:""},model:{value:e.sessionNumberFrom,callback:function(t){e.sessionNumberFrom=t},expression:"sessionNumberFrom"}})],1),n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.sessionRules,label:"To session number",required:"",outlined:"",dense:""},model:{value:e.sessionNumberTo,callback:function(t){e.sessionNumberTo=t},expression:"sessionNumberTo"}})],1),n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.repeatsRules,label:"How many repeats",required:"",outlined:"",dense:""},model:{value:e.repeats,callback:function(t){e.repeats=t},expression:"repeats"}})],1)],1)],1)],1):e._e()],1)},K=[],$={props:{action:{type:Object,required:!0}},data:function(){return{model:null,sessionNumberFrom:1,sessionNumberTo:8,repeats:4,sessionRules:[function(e){return!!e||"Session number is required"},function(e){if(Number.isNaN(e)||!Number.isInteger(Number(e)))return"Please enter integer value";var t=Number(e);return t<=32&&t>=1||"Session number must be between 1 and 32"}],repeatsRules:[function(e){return!!e||"Repeat counter is required"},function(e){if(Number.isNaN(e)||!Number.isInteger(Number(e)))return"Please enter integer value";var t=Number(e);return t<=8&&t>=1||"Repeats must be between 1 and 8"}]}},watch:{sessionNumberFrom:function(e){this.action&&(this.action.startSessionIndex=Number(e)-1)},sessionNumberTo:function(e){this.action&&(this.action.endSessionIndex=Number(e)-1)},repeats:function(e){this.action&&(this.action.repeats=Number(e)-1)}},computed:Object(d["e"])(["sequence"]),mounted:function(){this.$nextTick((function(){this.sessionNumberFrom=this.action.startSessionIndex+1,this.sessionNumberTo=this.action.endSessionIndex+1,this.repeats=this.action.repeats+1}))}},W=$,J=Object(m["a"])(W,G,K,!1,null,null,null),Y=J.exports;h()(J,{VCardText:R["c"],VCol:b["a"],VContainer:g["a"],VForm:P["a"],VRow:_["a"],VTextField:N["a"]});var X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[e.action?n("v-form",{model:{value:e.action.valid,callback:function(t){e.$set(e.action,"valid",t)},expression:"action.valid"}},[n("v-container",{staticClass:"pt-0 pb-0"},[n("v-row",[n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.actionRules,label:"From action number",required:"",outlined:"",dense:""},model:{value:e.actionNumberFrom,callback:function(t){e.actionNumberFrom=t},expression:"actionNumberFrom"}})],1),n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.actionRules,label:"To action number",required:"",outlined:"",dense:""},model:{value:e.actionNumberTo,callback:function(t){e.actionNumberTo=t},expression:"actionNumberTo"}})],1),n("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[n("v-text-field",{attrs:{rules:e.repeatsRules,label:"How many repeats",required:"",outlined:"",dense:""},model:{value:e.repeats,callback:function(t){e.repeats=t},expression:"repeats"}})],1)],1)],1)],1):e._e()],1)},z=[],H={props:{action:{type:Object,required:!0}},data:function(){return{model:null,actionNumberFrom:1,actionNumberTo:4,repeats:4,actionRules:[function(e){return!!e||"Action number is required"},function(e){if(Number.isNaN(e)||!Number.isInteger(Number(e)))return"Please enter integer value";var t=Number(e);return t<=30&&t>=1||"Action number must be between 1 and 30"}],repeatsRules:[function(e){return!!e||"Repeat counter is required"},function(e){if(Number.isNaN(e)||!Number.isInteger(Number(e)))return"Please enter integer value";var t=Number(e);return t<=8&&t>=1||"Repeats must be between 1 and 8"}]}},watch:{actionNumberFrom:function(e){this.action&&(this.action.startActionIndex=Number(e)-1)},actionNumberTo:function(e){this.action&&(this.action.endActionIndex=Number(e)-1)},repeats:function(e){this.action&&(this.action.repeats=Number(e)-1)}},computed:Object(d["e"])(["sequence"]),mounted:function(){this.$nextTick((function(){this.actionNumberFrom=this.action.startActionIndex+1,this.actionNumberTo=this.action.endActionIndex+1,this.repeats=this.action.repeats+1}))}},Q=H,Z=Object(m["a"])(Q,X,z,!1,null,null,null),ee=Z.exports;h()(Z,{VCardText:R["c"],VCol:b["a"],VContainer:g["a"],VForm:P["a"],VRow:_["a"],VTextField:N["a"]});var te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[e.action?n("v-form",{model:{value:e.action.valid,callback:function(t){e.$set(e.action,"valid",t)},expression:"action.valid"}},[n("v-container",{staticClass:"pt-0 pb-0"},[n("v-row",[n("v-col",{staticClass:"pb-0",attrs:{cols:"12",lg:"6",xl:"4"}},[n("v-select",{attrs:{items:e.items,rules:e.rules,label:"Action number",outlined:"",dense:""},model:{value:e.action.toActionIndex,callback:function(t){e.$set(e.action,"toActionIndex",t)},expression:"action.toActionIndex"}})],1)],1)],1)],1):e._e()],1)},ne=[],ie=(n("99af"),n("d81d"),{props:{action:{type:Object,required:!0},actionIndex:{type:Number,required:!0}},data:function(){return{selected:0,rules:[function(e){return!isNaN(e)||"Action should be selected"}]}},computed:Object(o["a"])({items:function(){var e=this;return this.sequence.map((function(t,n){var i="";return i=t?"#".concat(n+1," ").concat(t.title):"#".concat(n+1),{text:i,value:n,disabled:n===e.actionIndex}}))}},Object(d["e"])(["sequence"]))}),re=ie,ae=n("b974"),se=Object(m["a"])(re,te,ne,!1,null,null,null),oe=se.exports;h()(se,{VCardText:R["c"],VCol:b["a"],VContainer:g["a"],VForm:P["a"],VRow:_["a"],VSelect:ae["a"]});var ce={components:{ActionFormSwitchSession:E,ActionFormStop:L,ActionFormLoopSessions:Y,ActionFormLoopActions:ee,ActionFormJump:oe},props:{actionIndex:{type:Number,required:!0}},data:function(){return{}},computed:Object(o["a"])({colorClass:function(){return null!==this.action?this.actionIndex===this.activeActionIndex?"blue-grey darken-1":"blue-grey darken-4":""},action:function(){return this.sequence?this.sequence[this.actionIndex]:null}},Object(d["e"])(["sequence","activeActionIndex"])),methods:Object(o["a"])({onCheckDrop:function(e){e.dataTransfer.types.includes("action-type-id")&&e.preventDefault()},onChipDrop:function(e){var t=Number(e.dataTransfer.getData("action-type-id"));this.addSequenceActionAt({actionIndex:this.actionIndex,actionTypeId:t})},onChipClose:function(){this.clearSequenceActionAt(this.actionIndex)}},Object(d["d"])(["clearSequenceActionAt","addSequenceActionAt"]))},ue=ce,de=n("b0af"),le=n("cc20"),pe=Object(m["a"])(ue,A,O,!1,null,null,null),me=pe.exports;h()(pe,{VCard:de["a"],VCardSubtitle:R["b"],VChip:le["a"]});var fe={name:"rk002-sequence-editor",components:{SequenceEntry:me,SequencerSimulator:S},data:function(){return{configDialog:!1,overwriteDialog:!1,activeTab:1,snackbar:!1,snackbarText:"",snackbarColor:"red",statusBarText:"Status bar",links:[{title:"RK002 Circuit Song Mode",url:""},{title:"About",url:"/retrokits/2020/11/24/rk002-circuit-song-mode.html"}]}},computed:Object(o["a"])(Object(o["a"])({midiInputId:{get:function(){return this.selectedMidiInputId},set:function(e){this.setSelectedMidiInputId(e)}},midiOutputId:{get:function(){return this.selectedMidiOutputId},set:function(e){this.setSelectedMidiOutputId(e)}}},Object(d["e"])(["actionTypes","errorMessage","sequence","commInProcess","selectedMidiInputId","selectedMidiOutputId","firmwareInfo","expectedFirmwareVersion","expectedFirmwareGUID"])),Object(d["c"])(["sequenceValid","connected","commDisabled","midiInputs","midiOutputs"])),watch:{errorMessage:function(e){e.length>0&&(this.snackbarText=e,this.setErrorMessage(""),this.snackbar=!0)},firmwareInfo:function(e){e&&(e.version===this.expectedFirmwareVersion&&e.guid===this.expectedFirmwareGUID||this.setErrorMessage("You have unsupported software on the RK002"))},connected:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=function(e){return new Promise((function(t){return setTimeout(t,e)}))},e.next=5,n(50);case 5:this.onDownloadClick();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},methods:Object(o["a"])(Object(o["a"])({onChipDragStart:function(e,t){e.dataTransfer.dropEffect="copy",e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("action-type-id",t.actionTypeId)},onChipMouseEnter:function(e){this.statusBarText="Hint: "+e.hint},onChipMouseLeave:function(){this.statusBarText="Status bar"},onDownloadClick:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.commInProcess){e.next=2;break}return e.abrupt("return");case 2:this.sequence.filter((function(e){return null===e})).length===this.sequence.length?this.onReplace():this.overwriteDialog=!0;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onReplace:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.overwriteDialog=!1,e.prev=1,e.next=4,this.fetchParameters();case 4:this.parseAndLoadSequence(),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](1),this.setErrorMessage("Error loading sequence from RK002"),console.error('Method "onReplace" error:',e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}()},Object(d["d"])(["clearSequenceActionAt","addSequenceActionAt","setErrorMessage","setSelectedMidiInputId","setSelectedMidiOutputId"])),Object(d["b"])(["initWebMIDI","tryToConnect","fetchParameters","parseAndLoadSequence","parseAndUploadSequence"])),mounted:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.initWebMIDI();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e["catch"](0),this.setErrorMessage("Error: can't init Web MIDI"),console.error('On "mounted" error:',e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(){return e.apply(this,arguments)}return t}()},he=fe,ve=(n("3b75"),n("7496")),be=n("40dc"),ge=n("169a"),ye=n("553a"),xe=n("f6c4"),Ie=n("2db4"),_e=n("2fa4"),ke=n("71a3"),we=n("fe57"),Se=n("2a7f"),Ae=n("3a2f"),Oe=Object(m["a"])(he,r,a,!1,null,"32ab9150",null),qe=Oe.exports;h()(Oe,{VApp:ve["a"],VAppBar:be["a"],VBtn:v["a"],VCard:de["a"],VCardActions:R["a"],VCardText:R["c"],VCardTitle:R["d"],VChip:le["a"],VCol:b["a"],VContainer:g["a"],VDialog:ge["a"],VFooter:ye["a"],VIcon:y["a"],VMain:xe["a"],VRow:_["a"],VSelect:ae["a"],VSheet:k["a"],VSnackbar:Ie["a"],VSpacer:_e["a"],VTab:ke["a"],VTabs:we["a"],VToolbarTitle:Se["a"],VTooltip:Ae["a"]});var Ce=n("f309");i["a"].use(Ce["a"]);var De=new Ce["a"]({theme:{dark:!0}}),Te=(n("cb29"),n("7db0"),n("b0c0"),n("4fad"),n("dca8"),n("b85c")),Re=n("3835"),Pe=(n("a630"),n("3ca3"),n("ddb0"),n("d4ec")),Ne=n("bee2"),Me=(n("fb6a"),n("5377"),n("25f0"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),Me||{});Me.rk005=!1,Me.dbg=!0,Me.dbg_rxtx=Me.dbg&&!0,Me.dbg_rxtx_raw=Me.dbg_rxtx&&!0,Me.dbg_rxtx_pck=Me.dbg_rxtx&&!0,Me.read_uint8=function(e,t){var n=255&(t<e.length?e[t]:0);return n},Me.read_uint16=function(e,t){var n=Me.read_uint8(e,t+1);return n*=256,n+=Me.read_uint8(e,t),n},Me.read_uint32=function(e,t){var n=Me.read_uint16(e,t+2);return n*=65536,n+=Me.read_uint16(e,t),n},Me.read_string=function(e,t,n){for(var i="",r=0;r<n&&t+r<e.length;r++){var a=e[t+r];if(0==a||a>127)break;i+=String.fromCharCode(a)}return i},Me.vstostr=function(e){var t,n=e>>4&15,i=e>>0&15;return t=n.toString(16)+"."+i.toString(16),t},Me.crc32=function(e,t,n,i){var r,a,s;e^=4294967295;while(i--)for(a=t[n++],e^=a,r=7;r>=0;r--)s=-(1&e),e=e>>1&2147483647^3988292384&s;return e^=4294967295,e>>>=0,e},Me.cableTypeToString=function(e){var t=["RK002/INTERN","RK002/KVS","RK002/ARP","RK002/VID","RK002/SYNC","RK002/MOD","RK002/KOS"];return e>=0&&e<t.length?t[e]:"unknown type"},Me.SysexCodec=function(){var e=[240,0,33,35,0,2],t=[240,125,127,86,71,83],n=[{cmd:0,name:"boot0_req"},{cmd:64,name:"boot0_rsp"},{cmd:1,name:"boot1_req"},{cmd:65,name:"boot1_rsp"},{cmd:2,name:"checksum_req",arg:[{name:"adr",type:"uint32"},{name:"n",type:"uint32"}]},{cmd:66,name:"checksum_rsp",arg:[{name:"adr",type:"uint32"},{name:"n",type:"uint32"},{name:"crc32",type:"uint32"}]},{cmd:3,name:"writemem_req",arg:[{name:"adr",type:"uint32"},{name:"data",type:"uint8",dim:64}]},{cmd:67,name:"writemem_rsp",arg:[{name:"adr",type:"uint32"},{name:"res",type:"uint8"}]},{cmd:4,name:"readmem_req",arg:[{name:"adr",type:"uint32"}]},{cmd:68,name:"readmem_rsp",arg:[{name:"adr",type:"uint32"},{name:"data",type:"uint8",dim:64}]},{cmd:5,name:"exec_req",arg:[{name:"adr",type:"uint32"}]},{cmd:6,name:"hardfault_ind",arg:[{name:"pc",type:"uint32"}]},{cmd:7,name:"txtstr_ind",arg:[{name:"str",type:"string",dim:64}]},{cmd:8,name:"setparam_req",arg:[{name:"nr",type:"uint16"},{name:"val",type:"uint16"}]},{cmd:72,name:"setparam_rsp",arg:[{name:"nr",type:"uint16"},{name:"val",type:"uint16"}]},{cmd:9,name:"getparam_req",arg:[{name:"nr",type:"uint16"}]},{cmd:73,name:"getparam_rsp",arg:[{name:"nr",type:"uint16"},{name:"val",type:"uint16"}]},{cmd:10,name:"getnmbparams_req"},{cmd:74,name:"getnmbparams_rsp",arg:[{name:"n",type:"uint16"}]},{cmd:11,name:"getparamdef_req",arg:[{name:"param_nr",type:"uint16"}]},{cmd:75,name:"getparamdef_rsp",arg:[{name:"param_nr",type:"uint16"},{name:"min",type:"uint16"},{name:"max",type:"uint16"},{name:"def",type:"uint16"},{name:"flags",type:"uint8"},{name:"lbl",type:"string",dim:32}]},{cmd:12,name:"jump_req",arg:[{name:"adr",type:"uint32"}]},{cmd:76,name:"jump_rsp",arg:[{name:"adr",type:"uint32"},{name:"res",type:"uint8"}]},{cmd:0,name:"legacy_inquiry_req",legacy:!0},{cmd:64,name:"legacy_inquiry_rsp",legacy:!0,arg:[{name:"cabletype",type:"uint8"},{name:"sz",type:"uint32"},{name:"cs",type:"uint32"},{name:"svnstr",type:"string",dim:64}]},{cmd:1,name:"legacy_writemem_req",legacy:!0,arg:[{name:"adr",type:"uint32"},{name:"data",type:"uint8",dim:64}]},{cmd:65,name:"legacy_writemem_rsp",legacy:!0,arg:[{name:"adr",type:"uint32"},{name:"res",type:"uint8"}]},{cmd:2,name:"legacy_updatefw_req",legacy:!0},{cmd:66,name:"legacy_updatefw_rsp",legacy:!0}],i=function(e){for(var t,n=8,i=[],r=0;r<e.length;r++)n>=7&&(i[i.length]=0,n=0),t=e[r],128&t&&(i[i.length-n-1]|=1<<n),i[i.length]=127&t,n++;return i},r=function(e,t,n){for(var i,r,a=[],s=0;s<n;s++)i=e[t+s],0==(7&s)?r=i:(1&r&&(i|=128),r>>=1,a[a.length]=i);return a};this.encodePck=function(r){for(var a=[],s=0;s<n.length;s++){var o=n[s];if(r.cmd==o.cmd||r.name==o.name){if(r.cmd=o.cmd,r.name=o.name,"undefined"!==typeof o.arg)for(var c=0;c<o.arg.length;c++){var u=o.arg[c];if("undefined"===typeof r[u.name])break;var d=r[u.name],l="undefined"!==typeof u.dim?u.dim:0;0==l&&(d=[d]);var p=0;do{switch(u.type){case"uint8":a.push(d[p]>>0&255);break;case"uint16":a.push(d[p]>>0&255),a.push(d[p]>>8&255);break;case"uint32":a.push(d[p]>>0&255),a.push(d[p]>>8&255),a.push(d[p]>>16&255),a.push(d[p]>>24&255);break}p++}while(p<l&&p<d.length)}a=o.legacy?t.concat([r.cmd]).concat(i(a)).concat([247]):e.concat([r.cmd]).concat(i(a)).concat([247]);break}}if(0==a.length)throw"trying to encode undefined packet type: name="+r.name;return a},this.tryDecode=function(i){var a=null;if(i.length>e.length){for(var s=!0,o=!1,c=0;s&&c<e.length;c++)s=i[c]==e[c];if(!s){s=!0,o=!0;for(c=0;s&&c<t.length;c++)s=i[c]==t[c]}if(s){a=[],a.cmd=i[e.length];var u=i.length-2-e.length;i=u>0?r(i,e.length+1,u):[];for(c=0;c<n.length;c++){var d=n[c],l="undefined"!==typeof d.legacy&&d.legacy,p=l==o;if(a.cmd==d.cmd&&p){if(a.name=d.name,"undefined"!==typeof d.arg)for(var m=0,f=0;f<d.arg.length&&m<i.length;f++){var h=d.arg[f],v=[],b="undefined"!==typeof h.dim?h.dim:0;if("string"==h.type){v="";for(var g=0;g<b&&m<i.length;g++){var y=i[m++];y>0&&(v+=String.fromCharCode(y))}}else{g=0;do{switch(h.type){case"uint8":v.push(Me.read_uint8(i,m)),m+=1;break;case"uint16":v.push(Me.read_uint16(i,m)),m+=2;break;case"uint32":v.push(Me.read_uint32(i,m)),m+=4;break;case"string":break;default:console.log("unknown argtype '"+h.type+"'");break}g++}while(g<b);0==b&&(v=v[0])}a[h.name]=v}break}}}}return a};var a=function(e,t){var n="0x";do{t-=8,n+=Me.bytehex(e>>t&255)}while(t>0);return n};this.pckToString=function(e){for(var t=e.name.toUpperCase(),i=!0,r=0;r<n.length;r++){var s=n[r];if(s.cmd==e.cmd&&"undefined"!==typeof s.arg){for(var o=0;o<s.arg.length;o++){var c=s.arg[o];if("undefined"!==typeof e[c.name]){t+=i?" {":", ",t+=c.name+"=";var u=e[c.name];if(u.constructor===Array)t+="[]";else switch(c.type){case"uint8":t+=a(u,8);break;case"uint16":t+=a(u,16);break;case"uint32":t+=a(u,32);break;case"string":t+='"'+u+'"';break;default:t+=u;break}i=!1}}i||(t+="}")}}return t}},Me.sysexcodec=new Me.SysexCodec,Me.Pck=function(e,t){if(this.name=e,"undefined"!==typeof t)if(t.constructor===Array)for(var n=0;n<t.length;n++)for(var i in t[n])this[i]=t[n][i];else if(t.constructor===Object)for(var i in t)this[i]=t[i];else for(var i in t)this[i]=t[i]},Me.RawBuf=function(){this.buf=[],this.length=0,this.addByte=function(e){this.buf[this.length++]=255&e},this.addUint16LE=function(e){this.addByte(e),this.addByte(e>>8)},this.addUint32LE=function(e){this.addUint16LE(e),this.addUint16LE(e>>16)},this.addString=function(e){for(var t=0;t<e.length;t++)this.addByte(e.charCodeAt(t))}},Me.AudioEncoder=function(){var e=44100,t=8,n=16,i=2*(t+n),r=100,a=100,s=!1,o=0,c=[0];this.clear=function(){o=0,s=!1},this.advanceT=function(e){while(e--)c[o++]=s},this.invertSignal=function(){s=!s},this.emitCarrier=function(t){var n=0;while(1e3*n/e<t)this.invertSignal(),this.advanceT(i),n+=i},this.emitByte=function(e){for(var i=e,r=0;r<8;r++)this.invertSignal(),this.advanceT(1&i?n:t),i>>=1},this.getAsWavBase64Str=function(){var t=2,n=t*o*2,i=new Me.RawBuf;i.addString("RIFF"),i.addUint32LE(36+n),i.addString("WAVE"),i.addString("fmt "),i.addUint32LE(16),i.addUint16LE(1),i.addUint16LE(t),i.addUint32LE(e),i.addUint32LE(4*e),i.addUint16LE(2*t),i.addUint16LE(16),i.addString("data"),i.addUint32LE(n);for(var r=0;r<o;r++)for(var a=0;a<t;a++)i.addUint16LE(c[r]?32767:32768);var s="data:audio/wav;base64,"+base64.encode(i.buf);return s},this.CRC8B=function(e,t){var n;for(e^=t,n=0;n<8;n++)1&e?e=e>>1^156:e>>=1;return 255&e},this.encodeAudioPck=function(e){var t,n,i,s=e.length;for(this.clear(),this.emitCarrier(r),this.emitByte(170),this.emitByte(s-1),i=255,t=0;t<s;t++)n=e[t],i=this.CRC8B(i,n),this.emitByte(n);return this.emitByte(i),this.emitCarrier(a),this.getAsWavBase64Str()}},Me.OutputDrvAudio=function(){this.txPck=function(e){var t=new Me.AudioEncoder,n=t.encodeAudioPck(e),i=new WaudSound(n,{volume:1});i.onLoad((function(){i.play()}))}},Me.InputDrvMIDI=function(e,t){this.observer=t,this.port=e,this.disconnect=function(){this.port.onmidimessage=null},this.port.onmidimessage=function(e){t&&t.onmidimessage&&t.onmidimessage(e.data)}},Me.nibhex=function(e){return e&=15,e<10?String.fromCharCode(48+e):String.fromCharCode(65+e-10)},Me.bytehex=function(e){return Me.nibhex(e>>4)+Me.nibhex(e)},Me.uint32hex=function(e){return Me.bytehex(e>>24)+Me.bytehex(e>>16)+Me.bytehex(e>>8)+Me.bytehex(e)},Me.dat2hexstr=function(e){for(var t="",n=0;n<e.length;n++){if(n>32){t+=".. ";break}t+=Me.bytehex(e[n]),t+=" "}return t},Me.OutputDrvMIDI=function(e){this.port=e,this.txPck=function(t){e.send(t),Me.dbg_rxtx_raw&&Me.DBG("TX:("+t.length+") "+Me.dat2hexstr(t))}},Me.dbg_t_last=null,Me.DBG=function(e){var t=Math.floor(performance.now());null==Me.dbg_t_last&&(Me.dbg_t_last=t);var n=t-Me.dbg_t_last;Me.dbg_t_last=t,n>9999&&(n=9999);var i="    "+n;console.log(i.slice(-4)+" "+e)},Me.Info=function(e){var t=248,n=0;this.magic=0,this.date="",this.name="",this.author="",this.version="",this.guid="",this.magic=Me.read_uint32(e,n),n+=4,this.guid=Me.read_string(e,n,t),n+=this.guid.length+1,n<t&&(this.date=Me.read_string(e,n,t),n+=this.date.length+1,n<t&&(this.name=Me.read_string(e,n,t),n+=this.name.length+1,n<t&&(this.author=Me.read_string(e,n,t),n+=this.author.length+1,n<t&&(this.version=Me.read_string(e,n,t)))))},Me.Loader=function(){var e,t,n,i,r,a,s,o,c,u,d,l,p=this,m=100,f=400,h=400,v=4,b=100,g=500,y=100,x=100,I=100,_=5,k=-1,w=2,S=3,A=4,O=2240,q=512,C=5,D=64,T=256,R=14336,P=1e3,N=1024,M=64,E=64,V=2048,j=268435456,B=8192,F=V+24,U=1380665394,L=256,G=7168,K=61,$=62,W=63,J=0,Y=1,X=0,z=1,H=2,Q=3,Z=4,ee=5,te=X,ne=0,ie=1,re=2,ae=3,se=4,oe=5,ce=6,ue=7,de=8,le=9,pe=10,me=ne,fe=new Me.OutputDrvAudio(this),he=null,ve=null,be=null,ge=-1,ye=null,xe=null,Ie=!1,_e=null,ke=new Array(q);this.setObserver=function(e){be=e},this.setOutputDriver=function(e){null==e||"disabled"==e.name?ve=null:"audio"==e.name?ve=fe:(ve=new Me.OutputDrvMIDI(e),"RK005"==e.name&&(Me.rk005=!0))},this.setInputDriver=function(e){null!=he&&he.disconnect(),he=null==e||"disabled"==e.name?null:new Me.InputDrvMIDI(e,p)},this.onmidimessage=function(e){if(Me.dbg_rxtx_raw&&248!=e[0]&&Me.DBG("RX:("+e.length+") "+Me.dat2hexstr(e)),240==e[0]){var t=Me.sysexcodec.tryDecode(e);null!=t?Je(t):Me.DBG("RECEIVED UNKNOWN PACKET")}};var we=function(e){Me.DBG("uiaddconsole: "+e),be&&be.rk002_consoleTxt&&be.rk002_consoleTxt(e)},Se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Me.sysexcodec.encodePck(e);Me.DBG("TX: "+Me.sysexcodec.pckToString(e)),ve.txPck(n),Oe(t)},Ae=function(e,t,n,i){var r=!1;if(e!=ge&&(ge=e,r=!0),t!=ye&&(ye=t,r=!0),n!=xe&&(xe=n,r=!0),i!=Ie&&(Ie=i,r=!0),r&&null!=be&&be.rk002_stsUpdate){var a=t;null!=n&&""!=n&&(a+=" : ",a+=n),be.rk002_stsUpdate(e,a,i)}},Oe=function(e){null!=_e&&(clearTimeout(_e),_e=null),0!=e&&(_e=setTimeout(Ye,e))},qe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;te=e,me=t,Oe(n)},Ce=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;qe(te,e,t)},De=function(e,t){Ae(100,e,null,t),qe(z,ie)},Te=function(){switch(te){case H:je("uploading target binary",t,B,J,!0);break;default:De("upload done",!0);break}},Re=function(e,t){if(De(e,t),"undefined"!==typeof be&&"undefined"!==typeof be.rk002_onEndUpload){var n=r==B;be.rk002_onEndUpload(e,t,n)}$e(1)},Pe=function(e){for(var t=new Uint8Array(s),o=0;o<s;o++)t[o]=i+o<n.length?n[i+o]:0;c=r+i;var u=new Me.Pck(a==Y?"legacy_writemem_req":"writemem_req",{adr:c,data:t}),d=Math.floor(99*i/n.length);Ae(d,ye,d+"%",!0),Se(u),Oe(e)},Ne=function(){e=0,Ce(ae),Pe(o?h:f)},Ee=function(){e++,e<v?(Me.DBG("chunk retry #"+e),Pe(h)):(Me.DBG("out of retries"),Re("failed to write memory chunk",!1))},Ve=function(){e=0,i+=s,i<n.length?Pe(o?h:0==(m_upload_data_pos&N-1)?f:m):o?a==Y?(Me.DBG("queueing UPDATEFW_REQ"),Ce(ue),Se(new Me.Pck("legacy_updatefw_req"),P)):(Ce(se),Se(new Me.Pck("checksum_req",{adr:r,n:n.length}),y)):Re("upload OK",!0)},je=function(e,t,c,u,d){Ae(0,e,null,!0),n=t,r=c,i=0,a=u,o=d,s=a==Y?M:E,Ne()},Be=function(){u=0,l=[],Ce(de),Se(new Me.Pck("getnmbparams_req"),b)},Fe=function(e,t){Me.DBG(e),De(e,t)},Ue=function(e){Se(new Me.Pck("getparamdef_req",{param_nr:e}),g)},Le=function(e){Se(new Me.Pck("getparam_req",{nr:e}),g)},Ge=function(e,n){var i=e>0;switch(Me.DBG("subEndInquiry() inquiry_result="+e),te){case Q:be&&be.rk002_onInquiryResult&&be.rk002_onInquiryResult(i,n),Se(new Me.Pck("exec_req",{adr:V}),0),De(i?"INQUIRY ready":"INQUIRY failed",i);break;case H:switch(e){case S:case w:je("uploading bootloader",Me.boot1,j,J,!0);break;case A:je("uploading requested binary",t,B,Y,!0);break;default:De("failure inquiring cable",!1);break}break;case Z:switch(e){case S:case w:je("uploading application",t,V,J,!0);break;case A:je("uploading duinifier",Me.duinify,B,Y,!0);break;default:De("failure inquiring cable",!1);break}break;default:throw"ending inquiry in unknown mainstate"}},Ke=function(){e=0,Ce(re,I),We()},$e=function(e){if(Me.rk005){var t=[240,0,33,35,0,5,3,0,1,e,247];ve.txPck(t)}},We=function(){$e(0),Se(new Me.Pck("boot0_req")),Se(new Me.Pck("legacy_inquiry_req")),Se(new Me.Pck("readmem_req",{adr:F})),Oe(I)},Je=function(t){switch(Me.dbg_rxtx_pck&&Me.DBG("RX: "+Me.sysexcodec.pckToString(t)),me){case re:if("checksum_rsp"==t.name)t.crc32==U?Se(new Me.Pck("readmem_req",{adr:O}),I):Ge(w,{txt:"corrupted DUY application loaded on cable (bad crc)"});else if("readmem_rsp"==t.name){if(t.adr==F){var i=Me.read_uint32(t.data,0);i>0&&i<R?Se(new Me.Pck("checksum_req",{adr:V,n:i}),I):Ge(w,{txt:"corrupted DUY application loaded on cable (bad size)"})}else if(t.adr>=O&&t.adr<O+q){for(var a=0;a<D;a++)ke[a+t.adr-O]=t.data[a];var s=t.adr+D;if(s<O+q)Se(new Me.Pck("readmem_req",{adr:s}),I);else{var o=new Me.Info(ke);if(3405691582==o.magic){Me.DBG("name    = "+o.name),Me.DBG("author  = "+o.author),Me.DBG("date    = "+o.date),Me.DBG("version = "+o.version),Me.DBG("guid    = "+o.guid);var p={is_legacy:!1};p.name=o.name,p.author=o.author,p.date=o.date,p.version=o.version,p.guid=o.guid,Ge(S,p)}else Ge(w,{txt:"corrupted DUY application loaded on cable (bad_info)"})}}}else if("legacy_inquiry_rsp"==t.name){p={is_legacy:!0};p.cabletype=t.cabletype+" ("+Me.cableTypeToString(t.cabletype)+")",p.version=t.svnstr,Ge(A,p)}break;case ae:"legacy_writemem_rsp"!=t.name&&"writemem_rsp"!=t.name||(0==t.res&&t.adr==c?Ve():(Me.DBG("received bad response: res="+t.res+", adr=0x"+Me.uint32hex(t.adr)+" (expected:"+Me.uint32hex(c)+")"),Ee()));break;case se:if("checksum_rsp"==t.name){var m=Me.crc32(0,n,0,n.length),f=t.crc32;if(m==f)if(Me.DBG("final CRC check is OK"),n==Me.boot1)Ce(oe),Se(new Me.Pck("exec_req",{adr:j}),0),e=0,Oe(I);else if(r==B){Ce(ce);var h=Me.read_uint32(n,4*W);h+=B,Me.DBG("executing jump to FWINSTALLER on legacy image at address 0x"+Me.uint32hex(h)),Ce(ce),Se(new Me.Pck("jump_req",{adr:h}),x)}else Se(new Me.Pck("exec_req",{adr:r}),0),Re("upload OK",!0);else Me.DBG("final CRC check fail (computed="+Me.uint32hex(m)+",received="+Me.uint32hex(f)+")"),Re("final CRC fail",!1)}break;case oe:"boot1_rsp"==t.name&&(Me.DBG("boot1 is running now"),Te());break;case ce:"jump_rsp"==t.name&&(0==t.res?Re("upload OK",!0):(Me.DBG("failure: received JUMP1_rsp with result code :"+t.res),Re("failed to receive correct response",!1)));break;case ue:"legacy_updatefw_rsp"==t.name&&(te==Z?Ke():Re("upload OK",!0));break;case de:"getnmbparams_rsp"==t.name&&(d=t.n,0==d?("undefined"!==typeof be&&"undefined"!==typeof be.rk002_onParamDefsFetched&&be.rk002_onParamDefsFetched(l),Fe("params retreived OK",!0)):(Ce(le),Ue(u)));break;case le:"getparamdef_rsp"==t.name&&t.param_nr==u&&(32768&t.min&&(t.min-=65536),l[u]={nr:u,min:t.min,max:t.max,def:t.def,flags:t.flags,lbl:t.lbl,val:0},u++,u>=d?("undefined"!==typeof be&&"undefined"!==typeof be.rk002_onParamDefsFetched&&be.rk002_onParamDefsFetched(l),Ce(pe),u=0,Le(u)):Ue(u));break;case pe:"getparam_rsp"==t.name&&t.nr==u&&(l[u].val=t.val,u++,u>=d?Fe("params retreived OK",!0):Le(u));break;default:break}if(("getparam_rsp"==t.name||"setparam_rsp"==t.name)&&"undefined"!==typeof l&&t.nr<l.length){var v=t.val;l[t.nr].min<0&&32768&v&&(v-=65536),l[t.nr].val=v,"undefined"!==typeof be&&"undefined"!==typeof be.rk002_onParam&&be.rk002_onParam(l[t.nr])}},Ye=function(){switch(Me.DBG("onStateTmr()"),me){case ie:default:break;case ae:o?(Me.DBG("timeout expecting duplex ack"),Ee()):Ve();break;case ce:Me.DBG("time-out receiving FWUPDATE response for legacy firmware"),Re("timeout waiting for updatefw response",!1);break;case se:Me.DBG("time-out receiving final CRC check"),Re("timeout waiting for final CRC",!1);break;case oe:e++,e<C?Se(new Me.Pck("boot1_req"),I):(Me.DBG("time-out receiving BOOT1 rsp"),Re("timeout waiting for BOOT1 rsp",!1));break;case re:e++,e<_?We():Ge(k,{txt:"inquiry operation time-out"});break;case ue:Me.DBG("time-out waiting for legacy updatefw_rsp"),Re("timeout waiting for response",!1);break;case de:case le:case pe:Fe("time-out retreiving params",!1);break}};this.startInquiry=function(){te>z?we("ERROR: operation in progress already"):he?(Ae(0,"inquiring",null,!0),te=Q,Ke()):we("ERROR: no input driver selected")};var Xe=function(e){if(e.length<L)return Me.DBG("dataIsValidLegacyApp(): data.length too small"),!1;if(e.length>G)return Me.DBG("dataIsValidLegacyApp(): data.length too big"),!1;var t=Me.read_uint32(e,4*$);if(t>e.length)return Me.DBG("dataIsValidLegacyApp(): data.length mismatches with vector 62 (stored_size="+t+", data.length="+e.length),!1;var n=Me.read_uint32(e,4*K),i=Me.crc32(0,e,0,t);return n==i};this.unDuinifyData=function(e){te>z?we("ERROR: operation in progress already"):he?(Ae(0,"unduinifying",null,!0),Xe(e)?(t=e,te=H,Ae(0,"unduinifying",null,!0),Ke()):(we("ERROR: file is not a valid RK002 binary"),Ae(100,"unduinify failed",null,!1))):we("ERROR: no input driver selected")},this.unDuinifyFile=function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onloadend=function(){if(Me.DBG("req.status="+t.status),200==t.status){var e=new Uint8Array(this.response);Me.DBG("load OK: size="+e.length),p.unDuinifyData(e)}else we("ERROR: failed to fetch binary data"),Ae(100,"unduinify failed",null,!1)},t.send()},this.unDuinifySMF=function(e){Me.DBG("decoding MIDI file ! ("+e.length+" bytes)"),decodeSMF(e.buffer);for(var t=new Uint8Array(G),n=0,i=midiFile.tracks[0],r=0;r<i.events.length;r++){var a=i.events[r];if(console.log("ev.type="+a.type),"sysex"==a.type){var s=a.metaData;Me.DBG("SMF: RX:("+s.length+") "+Me.dat2hexstr(s));var o=new Uint8Array(s.length);o[0]=240;for(var c=0;c<s.length-2;c++)o[1+c]=s[2+c];var u=Me.sysexcodec.tryDecode(o);if(null!=u&&(Me.DBG("SMF: pck="+Me.sysexcodec.pckToString(u)),"legacy_writemem_req"==u.name&&u.adr>=B&&u.adr<B+G)){var d=u.adr-B;for(c=0;c<64;c++)t[d++]=u.data[c];d>n&&(n=d)}}}n>0?(t=t.slice(0,n),p.unDuinifyData(t)):(we("ERROR: midifile doesn't contain RK002 firmware"),Ae(100,"upload failed",null,!1))};var ze=function(e){if(e.length<T)return Me.DBG("dataIsValidDuyApp(): data.length too small"),!1;if(e.length>R)return Me.DBG("dataIsValidDuyApp(): data.length too big"),!1;var t=Me.crc32(0,e,0,e.length);return t==U};this.duinify=function(e){te>z?we("ERROR: operation in progress already"):he?ze(e)?(t=e,te=Z,Ae(0,"duinifying",null,!0),Ke()):(we("ERROR: file is not a valid RK002 binary"),Ae(100,"duinify failed",null,!1)):we("ERROR: no input driver selected")},this.fetchParams=function(){te>z?we("ERROR: operation in progress already"):he?(te=ee,Ae(0,"retreiving prameters",null,!0),Be()):we("ERROR: no input driver selected")},this.getParamDef=function(e){return"undefined"!==typeof l&&e<l.length?l[e]:null},this.setParamVal=function(e,t){te>z?we("ERROR: operation in progress already"):Se(new Me.Pck("setparam_req",{nr:e,val:65535&t}))}};var Ee=Me,Ve=function(){function e(){Object(Pe["a"])(this,e),this._midiAccess=null,this._pendingPromise=null,this._busyErr=new Error("Device is busy"),this._midiInputId=null,this._midiOutputId=null,this._paramsCount=0,this._paramsCountExpected=1,this.onParamDefs=null,this.onParam=null,this.onMidiStateChange=null,this.rk002=new Ee.Loader,this.rk002.setObserver(this)}return Object(Ne["a"])(e,[{key:"rk002_consoleTxt",value:function(e){console.log("rk002_consoleTxt:",e),(e+"").toLowerCase().includes("error")&&null!==this._pendingPromise&&(this._pendingPromise.reject(e),this._pendingPromise=null)}},{key:"rk002_stsUpdate",value:function(e,t,n){console.log("rk002_stsUpdate:",e,t,n)}},{key:"rk002_onEndUpload",value:function(e,t,n){console.log("rk002_onEndUpload:",e,t,n)}},{key:"rk002_onInquiryResult",value:function(e,t){this._pendingPromise&&(e?this._pendingPromise.resolve(t):this._pendingPromise.reject("Error getting inquiry response"),this._pendingPromise=null)}},{key:"rk002_onParamDefsFetched",value:function(e){this.onParamDefs&&this.onParamDefs(e)}},{key:"rk002_onParam",value:function(e){this.onParam&&this.onParam(e),this._paramsCount++,this._paramsCount===this._paramsCountExpected&&this._pendingPromise&&(this._pendingPromise.resolve(),this._pendingPromise=null)}},{key:"_onMidiStateChange",value:function(e){if("input"!==e.port.type||this._allInputs.find((function(t){return t.id===e.port.id}))||(this._allInputs.push(e.port),this._midiInputId===e.port.id&&this.rk002.setInputDriver(e.port)),"output"!==e.port.type||this._allOutputs.find((function(t){return t.id===e.port.id}))||(this._allOutputs.push(e.port),this._midiOutputId===e.port.id&&this.rk002.setOutputDriver(e.port)),this.onMidiStateChange){var t={name:e.port.name,id:e.port.id,state:e.port.state,type:e.port.type};this.onMidiStateChange(t)}}},{key:"initWebMIDI",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.requestMIDIAccess({sysex:!0});case 2:return this._midiAccess=e.sent,this._midiAccess.onstatechange=this._onMidiStateChange.bind(this),this._allInputs=Array.from(this._midiAccess.inputs.values()),t=this._allInputs.map((function(e){return{name:e.name,id:e.id,state:e.state}})),this._allOutputs=Array.from(this._midiAccess.outputs.values()),n=this._allOutputs.map((function(e){return{name:e.name,id:e.id,state:e.state}})),e.abrupt("return",{inputs:t,outputs:n});case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setMidiInputId",value:function(e){this._midiInputId=e;var t=this._allInputs.find((function(t){return t.id===e}));return t?(this.rk002.setInputDriver(t),console.log("Input set:",t),!0):(console.log("======== INPUT ID NOT FOUND ========"),!1)}},{key:"setMidiOutputId",value:function(e){this._midiOutputId=e;var t=this._allOutputs.find((function(t){return t.id===e}));return t?(this.rk002.setOutputDriver(t),console.log("Output set:",t),!0):(console.log("======== OUTPUT ID NOT FOUND ========"),!1)}},{key:"inquiryDevice",value:function(){var e=this;return new Promise((function(t,n){if(e._pendingPromise)return n(e._busyErr);e._pendingPromise={resolve:t,reject:n},e.rk002.startInquiry()}))}},{key:"fetchParameters",value:function(){var e=this;return new Promise((function(t,n){if(e._pendingPromise)return n(e._busyErr);e._pendingPromise={resolve:t,reject:n},e._paramsCount=0,e._paramsCountExpected=32,e.rk002.fetchParams()}))}},{key:"sendParameterValues",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this._pendingPromise){e.next=2;break}throw this._busyErr;case 2:n=Object(Te["a"])(t.entries()),e.prev=3,n.s();case 5:if((i=n.n()).done){e.next=13;break}if(r=Object(Re["a"])(i.value,2),a=r[0],s=r[1],!(s>65535||s<0)){e.next=9;break}throw new Error("Parameter value should be from 0 to 65535");case 9:return e.next=11,this.sendParameter(a,s);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](3),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[3,15,18,21]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sendParameter",value:function(e,t){var n=this;return new Promise((function(i,r){if(n._pendingPromise)return r(n._busyErr);n._pendingPromise={resolve:i,reject:r},n._paramsCount=0,n._paramsCountExpected=1,n.rk002.setParamVal(e,t)}))}}]),e}(),je=Ve,Be=n("53ca"),Fe=n("ade3"),Ue=function(){function e(t){Object(Pe["a"])(this,e);var n,i=-1,r=0;if("object"===Object(Be["a"])(t))i=t.actionTypeId;else{if(isNaN(t))throw new Error("Wrong constructor arguments for SequencerAction class ".concat(t));n=255&t,r=t>>8,i=(224&r)>>5}switch(this.actionTypeId=i,i){case e.Type.SwitchSession:this.valid=!1,this.title="Switch Session",this.hint="Switch session to session number",this.color="primary",this.icon="mdi-skip-next-circle-outline",this.sessionIndex=0,this.nextActionOnBeat=4;break;case e.Type.LoopSessions:this.valid=!1,this.title="Loop Sessions",this.hint="Loop sessions from session number to session number",this.color="indigo",this.icon="mdi-restore",this.startSessionIndex=0,this.endSessionIndex=7,this.repeats=4;break;case e.Type.LoopActions:this.valid=!1,this.title="Loop Actions",this.hint="Loop actions from action number to action number",this.color="cyan",this.icon="mdi-restore",this.startActionIndex=0,this.endActionIndex=3,this.repeats=4;break;case e.Type.JumpToAction:this.valid=!1,this.title="Jump to Action",this.hint="Jump to action number",this.color="orange",this.icon="mdi-debug-step-over",this.toActionIndex=0;break;case e.Type.StopSequence:this.valid=!0,this.title="Stop Sequence",this.hint="Stop sequencer. Circuit will play last loaded session.",this.color="pink",this.icon="mdi-stop-circle-outline";break;default:throw new Error("Empty sequencer slot or undefined action type")}if("object"!==Object(Be["a"])(t))switch(i){case e.Type.SwitchSession:this.sessionIndex=31&r,this.nextActionOnBeat=n;break;case e.Type.LoopSessions:this.startSessionIndex=31&r,this.endSessionIndex=31&n,this.repeats=(224&n)>>5;break;case e.Type.LoopActions:this.startActionIndex=0,this.endActionIndex=3,this.repeats=4;break;case e.Type.JumpToAction:this.toActionIndex=31&r;break}else Object.assign(this,t)}return Object(Ne["a"])(e,[{key:"getUserParamValue",value:function(){var t=0;switch(this.actionTypeId){case e.Type.SwitchSession:t=this.actionTypeId<<5,t=(t|this.sessionIndex)<<8,t|=this.nextActionOnBeat;break;case e.Type.LoopSessions:t=this.actionTypeId<<5,t=(t|this.startSessionIndex)<<8,t|=this.repeats<<5,t|=this.endSessionIndex;break;case e.Type.LoopActions:break;case e.Type.JumpToAction:t=this.actionTypeId<<5,t=(t|this.toActionIndex)<<8;break;case e.Type.StopSequence:t=this.actionTypeId<<13;break}return t}},{key:"clone",value:function(){return new e(Object.assign({},this))}}]),e}();Object(Fe["a"])(Ue,"Type",{SwitchSession:1,LoopSessions:3,LoopActions:4,JumpToAction:5,StopSequence:2}),i["a"].use(d["a"]);var Le=new je,Ge=new d["a"].Store({state:{errorMessage:"",activeActionIndex:null,sequence:new Array(30).fill(null),expectedFirmwareGUID:"c1825f6a-45fd-4ccc-b470-e3064ee4f94f",expectedFirmwareVersion:"1.0",commInProcess:!1,firmwareInfo:null,midiInputsAndOutputs:null,selectedMidiInputId:localStorage.selectedMidiInputId||-1,selectedMidiOutputId:localStorage.selectedMidiOutputId||-1,rawDeviceData:new Array(32).fill(null),actionTypes:[new Ue({actionTypeId:Ue.Type.SwitchSession,sessionIndex:0,nextActionOnBeat:4,valid:!0}),new Ue({actionTypeId:Ue.Type.LoopSessions,startSessionIndex:0,endSessionIndex:7,repeats:3,valid:!0}),new Ue({actionTypeId:Ue.Type.LoopActions,startActionIndex:0,endActionIndex:3,repeats:3,valid:!0}),new Ue({actionTypeId:Ue.Type.JumpToAction,toActionIndex:0}),new Ue({actionTypeId:Ue.Type.StopSequence})]},getters:{connected:function(e){if(!e.midiInputsAndOutputs)return!1;var t=e.midiInputsAndOutputs.inputs.find((function(t){return t.id===e.selectedMidiInputId})),n=e.midiInputsAndOutputs.outputs.find((function(t){return t.id===e.selectedMidiOutputId}));return e.firmwareInfo&&t&&n&&"connected"===t.state&&"connected"===n.state},commDisabled:function(e,t){return!t.connected||e.commInProcess||!e.firmwareInfo||e.firmwareInfo.version!==e.expectedFirmwareVersion||e.firmwareInfo.guid!==e.expectedFirmwareGUID},midiInputs:function(e){return null===e.midiInputsAndOutputs?[]:e.midiInputsAndOutputs.inputs.map((function(e){return{text:e.name,value:e.id,disabled:"disconnected"===e.state}}))},midiOutputs:function(e){return null===e.midiInputsAndOutputs?[]:e.midiInputsAndOutputs.outputs.map((function(e){return{text:e.name,value:e.id,disabled:"disconnected"===e.state}}))},sequenceValid:function(e){return function(){if(e.sequence.filter((function(e){return null===e})).length===e.sequence.length)return e.errorMessage="Sequence is empty",!1;if(null===e.sequence[0])return e.errorMessage="First sequencer slot can't be empty",!1;if(0!==e.sequence.filter((function(e){return e&&!1===e.valid})).length)return e.errorMessage="Some of the sequencer actions are not valid",!1;for(var t=!1,n=0;n<e.sequence.length;n++){var i=e.sequence[n];if(null===i&&(t=!0),null!==i&&t)return e.errorMessage="Sequence have empty slots between actions",!1;if(null!==i)switch(i.actionTypeId){case 3:if(i.startSessionIndex===i.endSessionIndex)return e.errorMessage="Loop Sessions action #".concat(n+1," can't have equal From - To sessions"),!1}}return!0}}},mutations:{setMidiInputsAndOutputs:function(e,t){e.midiInputsAndOutputs=t},addMidiInputPort:function(e,t){e.midiInputsAndOutputs.inputs.push(t)},addMidiOutputPort:function(e,t){e.midiInputsAndOutputs.outputs.push(t)},setSelectedMidiInputId:function(e,t){localStorage.selectedMidiInputId=t,e.selectedMidiInputId=t,Le.setMidiInputId(t)},setSelectedMidiOutputId:function(e,t){localStorage.selectedMidiOutputId=t,e.selectedMidiOutputId=t,Le.setMidiOutputId(t)},setActiveActionIndex:function(e,t){e.activeActionIndex=t},setCommInProcess:function(e,t){e.commInProcess=t},setFirmwareInfo:function(e,t){e.firmwareInfo=t},setRawDeviceDataEntry:function(e,t){var n=Object.assign({},t);e.rawDeviceData[t.nr]=Object.freeze(n)},clearSequenceActionAt:function(e,t){i["a"].set(e.sequence,t,null)},addSequenceActionAt:function(e,t){var n=e.actionTypes.find((function(e){return e.actionTypeId===t.actionTypeId}));i["a"].set(e.sequence,t.actionIndex,n.clone())},setSequencerActionAt:function(e,t){i["a"].set(e.sequence,t.actionIndex,t.newValue)},modifySequenceActionAt:function(e,t){for(var n=e.sequence[t.actionIndex],i=t.newValue,r=0,a=Object.entries(i);r<a.length;r++){var s=Object(Re["a"])(a[r],2),o=s[0],c=s[1];n[o]!=c&&(n[o]=c)}},setErrorMessage:function(e,t){e.errorMessage=t}},actions:{initWebMIDI:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,i=t.dispatch,Le.onMidiStateChange||(Le.onMidiStateChange=function(e){return i("onMidiStateChange",e)}),e.next=4,Le.initWebMIDI();case 4:r=e.sent,n("setMidiInputsAndOutputs",r),localStorage.selectedMidiInputId&&(Le.setMidiInputId(localStorage.selectedMidiInputId),n("setSelectedMidiInputId",localStorage.selectedMidiInputId)),localStorage.selectedMidiOutputId&&(Le.setMidiOutputId(localStorage.selectedMidiOutputId),n("setSelectedMidiOutputId",localStorage.selectedMidiOutputId));case 8:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),onMidiStateChange:function(e,t){var n=e.state,i=e.commit,r=e.dispatch;if("input"===t.type){var a=n.midiInputsAndOutputs.inputs.find((function(e){return e.id===t.id}));a?(a.state=t.state,a.id===n.selectedMidiInputId&&("disconnected"===a.state?n.firmwareInfo=null:r("tryToConnect"))):(i("addMidiInputPort",t),r("tryToConnect"))}else if("output"===t.type){var s=n.midiInputsAndOutputs.outputs.find((function(e){return e.id===t.id}));s?(s.state=t.state,s.id===n.selectedMidiOutputId&&("disconnected"===s.state?n.firmwareInfo=null:r("tryToConnect"))):(i("addMidiOutputPort",t),r("tryToConnect"))}},fetchParameters:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,Le.onParam||(Le.onParam=function(e){return n("setRawDeviceDataEntry",e)}),n("setCommInProcess",!0),i=null,e.prev=4,e.next=7,Le.fetchParameters();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](4),i=e.t0;case 12:if(n("setCommInProcess",!1),!i){e.next=15;break}throw i;case 15:case"end":return e.stop()}}),e,null,[[4,9]])})));function t(t){return e.apply(this,arguments)}return t}(),parseAndLoadSequence:function(e){var t=e.state,n=e.commit;if(!t.rawDeviceData||0!==t.rawDeviceData.filter((function(e){return null===e})).length)throw new Error("Raw data is not loaded from the RK002 yet");var i,r=Object(Te["a"])(t.rawDeviceData);try{for(r.s();!(i=r.n()).done;){var a=i.value,s=null;if(a.nr<=29){try{s=new Ue(a.val),s.valid=!0}catch(o){console.log(a,o)}n("setSequencerActionAt",{actionIndex:a.nr,newValue:s})}}}catch(o){r.e(o)}finally{r.f()}},parseAndUploadSequence:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.state,i=t.getters,r=t.commit,n.commInProcess||!i.sequenceValid()){e.next=15;break}return r("setCommInProcess",!0),a=n.sequence.map((function(e){return e?e.getUserParamValue():0})),a.push(0,0),e.prev=5,e.next=8,Le.sendParameterValues(a);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](5),console.error(e.t0),r("setErrorMessage","Error sending sequence to the RK002");case 14:r("setCommInProcess",!1);case 15:case"end":return e.stop()}}),e,null,[[5,10]])})));function t(t){return e.apply(this,arguments)}return t}(),tryToConnect:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.state,i=t.commit,r=t.getters,-1===n.selectedMidiInputId||-1===n.selectedMidiOutputId||r.commInProcess){e.next=15;break}return i("setCommInProcess",!0),i("setFirmwareInfo",null),e.prev=4,e.next=7,Le.inquiryDevice();case 7:a=e.sent,i("setFirmwareInfo",a),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](4),console.error("tryToConnect error:",e.t0);case 14:i("setCommInProcess",!1);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));function t(t){return e.apply(this,arguments)}return t}()}});i["a"].config.productionTip=!1,new i["a"]({vuetify:De,store:Ge,render:function(e){return e(qe)}}).$mount("#app")},"925c":function(e,t,n){},c5f9:function(e,t,n){},e869:function(e,t,n){"use strict";n("925c")}});
//# sourceMappingURL=app.6706444f.js.map